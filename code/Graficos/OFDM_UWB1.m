clear

%% OFDM UWB
addpath('PGresultados')
load resultados_UWB

FF = [3.16800000000000 3.17212500000000 3.17625000000000 3.18037500000000 3.18450000000000 3.18862500000000 3.19275000000000 3.19687500000000 3.20100000000000 3.20512500000000 3.20925000000000 3.21337500000000 3.21750000000000 3.22162500000000 3.22575000000000 3.22987500000000 3.23400000000000 3.23812500000000 3.24225000000000 3.24637500000000 3.25050000000000 3.25462500000000 3.25875000000000 3.26287500000000 3.26700000000000 3.27112500000000 3.27525000000000 3.27937500000000 3.28350000000000 3.28762500000000 3.29175000000000 3.29587500000000 3.30000000000000 3.30412500000000 3.30825000000000 3.31237500000000 3.31650000000000 3.32062500000000 3.32475000000000 3.32887500000000 3.33300000000000 3.33712500000000 3.34125000000000 3.34537500000000 3.34950000000000 3.35362500000000 3.35775000000000 3.36187500000000 3.36600000000000 3.37012500000000 3.37425000000000 3.37837500000000 3.38250000000000 3.38662500000000 3.39075000000000 3.39487500000000 3.39900000000000 3.40312500000000 3.40725000000000 3.41137500000000 3.41550000000000 3.41962500000000 3.42375000000000 3.42787500000000 3.43200000000000 3.43612500000000 3.44025000000000 3.44437500000000 3.44850000000000 3.45262500000000 3.45675000000000 3.46087500000000 3.46500000000000 3.46912500000000 3.47325000000000 3.47737500000000 3.48150000000000 3.48562500000000 3.48975000000000 3.49387500000000 3.49800000000000 3.50212500000000 3.50625000000000 3.51037500000000 3.51450000000000 3.51862500000000 3.52275000000000 3.52687500000000 3.53100000000000 3.53512500000000 3.53925000000000 3.54337500000000 3.54750000000000 3.55162500000000 3.55575000000000 3.55987500000000 3.56400000000000 3.56812500000000 3.57225000000000 3.57637500000000 3.58050000000000 3.58462500000000 3.58875000000000 3.59287500000000 3.59700000000000 3.60112500000000 3.60525000000000 3.60937500000000 3.61350000000000 3.61762500000000 3.62175000000000 3.62587500000000 3.63000000000000 3.63412500000000 3.63825000000000 3.64237500000000 3.64650000000000 3.65062500000000 3.65475000000000 3.65887500000000 3.66300000000000 3.66712500000000 3.67125000000000 3.67537500000000 3.67950000000000 3.68362500000000 3.68775000000000 3.69187500000000];

% for k= 1:12
%     pteo = polyfit(FF, resultados(k).SIRteo, 4);
%     figure, plot(FF, polyval(pteo, FF), 'k', FF, resultados(k).SIRteo, '*r')
% end

% L = 100.00km, P0 = 5.00mW, mIM = 2.00%, Nit = 1000, kappa = 15.00
% L = 100.00km, P0 = 4.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
% L = 100.00km, P0 = 1.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00

maxkP.pteo = [77.879876971939070 -1.071951414044535e+03 5.551543833514040e+03 -1.282526141172980e+04 1.115913418809009e+04]; %polyfit(FF, resultados(1).SIRteo, 4);
medkP.pteo = [27.182901100589984 -3.696726104583064e+02 1.908105126167358e+03 -4.433936934601084e+03 3.928760831396466e+03]; %polyfit(FF, resultados(2).SIRteo, 4);
minkP.pteo = polyfit(FF, resultados(3).SIRteo, 4);

maxkP.pap1 = [77.134577729930260 -1.061805444573292e+03 5.499641885364538e+03 -1.270710824256327e+04 1.105780526345754e+04]; %polyfit(FF, resultados(1).SIRap1, 4);
medkP.pap1 = [24.589297814324205 -3.342207212447137e+02 1.726339839541869e+03 -4.019576012691827e+03 3.573660767415420e+03]; %polyfit(FF, resultados(2).SIRap1, 4);
minkP.pap1 = polyfit(FF, resultados(3).SIRap1, 4);

maxkP.pap2 = [77.938974213780880 -1.072704009284146e+03 5.555171086676352e+03 -1.283318144096005e+04 1.116587331315160e+04]; %polyfit(FF, resultados(1).SIRap2, 4);
medkP.pap2 = [26.346476178825370 -3.580170195822875e+02 1.847240617238647e+03 -4.292938517855489e+03 3.807045819294520e+03]; %polyfit(FF, resultados(2).SIRap2, 4);
minkP.pap2 = polyfit(FF, resultados(3).SIRap2, 4);

maxkP.SIReva3 = resultados(1).SIReva;
maxkP.SIReva5 = [7.02634258459532 6.93480657754584 6.84547959325623 6.75827960346874 6.67312658688729 6.58994828484268 6.50867450474866 6.42924124468786 6.35158645777383 6.27565344654843 6.20138716459170 6.12873692371940 6.05765400639907 5.98809289194721 5.92001013146579 5.85336493859802 5.78811847300524 5.72423382737669 5.66167647741690 5.60041289768478 5.54041214804795 5.48164392212967 5.42408046331045 5.36769406803253 5.31246007593279 5.25835307840221 5.20535096444767 5.15343060769208 5.10257219353490 5.05275439924195 5.00395973753584 4.95616849144945 4.90936506406910 4.86353141971584 4.81865368757604 4.77471511765898 4.73170366834970 4.68960374456875 4.64840476512596 4.60809242030903 4.56865748108406 4.53008657931049 4.49237198812628 4.45550123369421 4.41946788841741 4.38426049922088 4.34987358214971 4.31629639441881 4.28352474126458 4.25154853087859 4.22036456152235 4.18996358544515 4.16034334879584 4.13149515876092 4.10341791722856 4.07610344719203 4.04955152964039 4.02375471704405 3.99871364386399 3.97442131698662 3.95087945336190 3.92808149039350 3.90602996446157 3.88471897517078 3.86350671014783 3.84238883055136 3.82201504600805 3.80237995820917 3.78348849696835 3.76533591376557 3.74792795707426 3.73126026757454 3.71533967962536 3.70016222231791 3.68573556961134 3.67205640527280 3.65913326059646 3.64696321894237 3.63555595887339 3.62490897511830 3.61503285553600 3.60592579389931 3.59759932180550 3.59005208235175 3.58329686782955 3.57733279722497 3.57217350638870 3.56781890021211 3.56428383892109 3.56156882123526 3.55969014460149 3.55864890083951 3.55846260974324 3.55913330409367 3.56067980887697 3.56310486664145 3.56642900318811 3.57065574395053 3.57580712177112 3.58188783888675 3.58892155770279 3.59691394629241 3.60589075398699 3.61585872870653 3.62684554797057 3.63885949896301 3.65193036962528 3.66606781210880 3.68130427125623 3.69765094270125 3.71514282968724 3.73379322858602 3.75363997755137 3.77469836674817 3.79700975090077 3.82059169912596 3.84548909084697 3.87172248562755 3.89934072039678 3.92836736411170 3.95885610970260 3.99083400591934 4.02435980500064 4.05946500537533 4.09621412488939 4.13464337283518 4.17482430205750 4.21679864348522];
maxkP.SIRevaCTD3 = [8.24297608865900 8.15284021982330 8.06482641373960 7.97885858235818 7.89486222660343 7.81277022440044 7.73251689739512 7.65404274399017 7.57728965921133 7.50220465885622 7.42873618327580 7.35683685465443 7.28646080539663 7.21756550659011 7.15011006992248 7.08405618161255 7.01936733370575 6.95600889422732 6.89394822959185 6.83315393844746 6.77359683199132 6.71524835593319 6.65808239989770 6.60207292911857 6.54719659795418 6.49342961032106 6.44075111574471 6.38913931512996 6.33857562079697 6.28904002194434 6.24051599284357 6.19298513026440 6.14643279646419 6.10084203889452 6.05619995687466 6.01249091206473 5.96970360978531 5.92782360701157 5.88684110122650 5.84674274104763 5.80752011730034 5.76916087982168 5.73165792713847 5.69499983148680 5.65918072509192 5.62419003399004 5.59002306045249 5.55667002478099 5.52412734491279 5.49238598397759 5.46144342957225 5.43129134350513 5.40192824465564 5.37334645598047 5.34554549628058 5.31851831819806 5.29226541561521 5.26678034501571 5.24206455665023 5.21811219026713 5.19492563959826 5.17249961207546 5.15083743763578 5.12993438061575 5.10906124068805 5.08821361459672 5.06812948544031 5.04880448837516 5.03024403264343 5.01244430246206 4.99541165571139 4.97914282881379 4.96364514307474 4.94891589501022 4.93496338982975 4.92178549693473 4.90939153185724 4.89777995481688 4.88696112435899 4.87693411491414 4.86771036743054 4.85928959981422 4.85168438203757 4.84489511113024 4.83893554059128 4.83380678923570 4.82952385725947 4.82608863570219 4.82351744423605 4.82181300526193 4.82099304144297 4.82106117548048 4.82203662861921 4.82392400392533 4.82674413048934 4.83050268451730 4.83522222778756 4.84090961703040 4.84758928940478 4.85526940644083 4.86397644394322 4.87372001215480 4.88452881262924 4.89641407119046 4.90940693002115 4.92352042437204 4.93878838447565 4.95522588073282 4.97286971718228 4.99173726297094 5.01186862711755 5.03328378635950 5.05602653999280 5.08011983556464 5.10561161283427 5.13252821911536 5.16092226310764 5.19082400082588 5.22229133347947 5.25535903267587 5.29009103201741 5.32652734642495 5.36473882511708 5.40477160422099 5.44670450985419 5.49059086539794 5.53651875823659 5.58455000285310];


medkP.SIReva3 = resultados(2).SIReva;
medkP.SIRevaCTD3 = [18.0150573111783 17.9240487336936 17.8351263277205 17.7483096128083 17.6634294438396 17.5805116695599 17.4993985337180 17.4201210970209 17.3425315205950 17.2666651782264 17.1923829202439 17.1197237060509 17.0485560422970 16.9789218822505 16.9106965141110 16.8439244015396 16.7784868685568 16.7144304927701 16.6516419944027 16.5901697389887 16.5299052912076 16.4708985358629 16.4130454035949 16.3563970768340 16.3008534351309 16.2464667756631 16.1931405616897 16.1409280544017 16.0897359795608 16.0396184384517 15.9904851356670 15.9423909111595 15.8952481968681 15.8491124889709 15.8038987230065 15.7596629850531 15.7163225145232 15.6739339348429 15.6324166104734 15.5918276614871 15.5520884168394 15.5132564628224 15.4752549483783 15.4381419045738 15.4018421699923 15.3664142069534 15.3317844258950 15.2980117139304 15.2650239467595 15.2328804361944 15.2015104266374 15.1709736603141 15.1412006628120 15.1122516178568 15.0840582529080 15.0566812093209 15.0300533446045 15.0042357786792 14.9791624341755 14.9548949351667 14.9313682108765 14.9086444196952 14.8866594449050 14.8654760139524 14.8442968797506 14.8231830052615 14.8028047021564 14.7832251708757 14.7643822100938 14.7463396664094 14.7290361646051 14.7125362462971 14.6967793315764 14.6818307111454 14.6676305747081 14.6542450216848 14.6416149908568 14.6298074559929 14.6187640897084 14.6085528122792 14.5991160204216 14.5905226602335 14.5827158486192 14.5757656447163 14.5696158879382 14.5643378464594 14.5598760912888 14.5563032054470 14.5535645080568 14.5517340138170 14.5507578147399 14.5507114864804 14.5515419279841 14.5533264192589 14.5560127107310 14.5596799462474 14.5642767842668 14.5698844103821 14.5764524614637 14.5840643639396 14.5926708195171 14.6023577190189 14.6130769341590 14.6249170721144 14.6378313018154 14.6519112318704 14.6671114817099 14.6835269852601 14.7011139967697 14.7199711450844 14.7400565407455 14.7614729312598 14.7841805496912 14.8082867504311 14.8337542095338 14.8606954537600 14.8890759887641 14.9190141723234 14.9504788074905 14.9835948548037 15.0183349828519 15.0548316649710 15.0930621283356 15.1331674395195 15.1751302340337 15.2191014638488 15.2650702207676 15.3131988997143];

minkP.SIReva3 = resultados(3).SIReva;

fig = figure;
fig1 = plot(FF, polyval(maxkP.pteo, FF), '-k', FF, polyval(maxkP.pap1, FF), '-r',  FF, polyval(maxkP.pap2, FF), '-m', FF, maxkP.SIReva3, '*b', FF, maxkP.SIReva5, 'hc');
hold on
fig2 = plot(FF, polyval(medkP.pteo, FF), '-k', FF, polyval(medkP.pap1, FF), '-r',  FF, polyval(medkP.pap2, FF), '-m', FF, medkP.SIReva3, '*b');
leg = legend('Simulação Sem Aproximações', 'Simulação Log Linear', 'Simulação Log Quadrático', 'Modelo Analítico (3ª ordem)', 'Modelo Analítico (5ª Ordem)');
set(gca, 'FontSize', 12)
set(fig, 'Position', [100 100 640 500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
axis([3.1 3.8 0 25])
set(fig1(1:3), 'LineWidth', 2)
set(fig2(1:3), 'LineWidth', 2)
set(gca, 'xtick', 3.1:0.1:3.8)
grid on
set(leg,'Position',[0.429513888888889 0.693666666666667 0.462326388888889 0.216]);
% Create textbox
annotation(fig,'textbox',...
    [0.607623236677123 0.584071292289081 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 40 GHz'},'FontSize',14, 'FitBoxToText','off','LineStyle','none');
% Create textbox
annotation(fig,'textbox',[0.609214145768029 0.2605490250826 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 75 GHz'},'FontSize',14,'FitBoxToText','off', 'LineStyle','none');
% % 
cd('../../DissertacaoPG/figuras/matlab')
saveas(fig, 'OFDM_UWB1_100km.fig')
cd ..
saveas(fig, 'OFDM_UWB1_100km', 'epsc');
cd('../../codigos/Graficos')
% 
%%
% L = 20.00km, P0 = 5.00mW, mIM = 2.00%, Nit = 1000, kappa = 15.00
% L = 20.00km, P0 = 4.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
% L = 20.00km, P0 = 1.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00

maxkP.pteo = [69.642527599214670 -9.605838493382179e+02 4.989403417200689e+03 -1.156823636339732e+04 1.013094596111349e+04]; %polyfit(FF, resultados(4).SIRteo, 4);
medkP.pteo = [75.634785055411730 -1.041835278501161e+03 5.403256595302011e+03 -1.250737356213964e+04 1.094085544030544e+04]; %polyfit(FF, resultados(5).SIRteo, 4);
% minkP.pteo = polyfit(FF, resultados(6).SIRteo, 4);

maxkP.pap1 = [68.558880044052220 -9.456818869604910e+02 4.912620062670017e+03 -1.139285957134306e+04 9.980054918902900e+03]; %polyfit(FF, resultados(4).SIRap1, 4);
medkP.pap1 = [75.233805325663580 -1.036434183902227e+03 5.375937081737560e+03 -1.244638700752538e+04 1.088720500454535e+04]; %polyfit(FF, resultados(5).SIRap1, 4);
% minkP.pap1 = polyfit(FF, resultados(6).SIRap1, 4);

maxkP.pap2 = [69.360377048760670 -9.567211051026219e+02 4.969554318684837e+03 -1.152302279844140e+04 1.009322455286221e+04]; %polyfit(FF, resultados(4).SIRap2, 4);
medkP.pap2 = [76.282495903284950 -1.050922451185945e+03 5.450945163331508e+03 -1.261895603300137e+04 1.104325877693095e+04]; %polyfit(FF, resultados(5).SIRap2, 4);
% minkP.pap2 = polyfit(FF, resultados(6).SIRap2, 4);

medkP.pap3 = [1.251727056778459e+02 -1.718338092644453e+03 8.864264753452686e+03 -2.036927981273685e+04 1.763098862639090e+04];

maxkP.SIReva3 = resultados(4).SIReva;
maxkP.SIReva5 = [29.5133235672683 29.4294532078224 29.3476897354045 29.2679748289873 29.1902162895035 29.1143645305293 29.0403364064980 28.9680897491554 28.8975491873747 28.8286788955953 28.7614102216447 28.6957127945636 28.6315238041768 28.5688175987928 28.5075364736069 28.4476588840202 28.3891316108548 28.3319367010928 28.2760248970947 28.2213814039369 28.1679604769178 28.1157501133553 28.0647076984231 28.0148237086520 27.9660583307946 27.9184042545640 27.8718241827594 27.8263127917768 27.7818350539721 27.7383874361146 27.6959369668687 27.6544817356274 27.6139906393329 27.5744632467328 27.5358701596020 27.4982123006458 27.4614618343365 27.4256209303227 27.3906631889814 27.3565919359559 27.3233820970831 27.2910380739512 27.2595360218463 27.2288813510073 27.1990513602848 27.1700524121503 27.1418628728395 27.1144900076699 27.0879131864501 27.0621405371785 27.0371523748560 27.0129576584509 26.9895375984365 26.9669019575646 26.9450328000635 26.9239406726207 26.9036084556346 26.8840474668190 26.8652413721991 26.8472022508742 26.8299145306528 26.8133910488052 26.7976169741193 26.7826059051098 26.7676103561929 26.7526438777446 26.7384255768964 26.7249698412044 26.7122632592259 26.7003209977801 26.6891303565969 26.6787072978046 26.6690398339370 26.6601447449643 26.6520107605584 26.6446555077919 26.6380684443071 26.6322680769185 26.6272446088519 26.6230174667532 26.6195776204523 26.6169454644810 26.6151127638964 26.6141009339382 26.6139025717016 26.6145401752733 26.6160072146853 26.6183273432047 26.6214949568820 26.6255349440519 26.6304426884235 26.6362444053377 26.6429365363511 26.6505467300000 26.6590725693177 26.6685432538177 26.6789576068530 26.6903465145869 26.7027101525230 26.7160812495747 26.7304614650511 26.7458855456883 26.7623567891506 26.7799121620951 26.7985567770571 26.8183300541264 26.8392391282437 26.8613261383636 26.8846004858736 26.9091073371160 26.9348586422063 26.9619029544036 26.9902551062281 27.0199674529401 27.0510581048055 27.0835837068611 27.1175661115129 27.1530668291068 27.1901120089985 27.2287687034047 27.2690680242293 27.3110833726445 27.3548516195468 27.4004534833450 27.4479325604451 27.4973780492675 27.5488414518328 27.6024218614053;];
% maxkP.SIRevaCTD3 = 

medkP.SIReva3 = resultados(5).SIReva;
medkP.SIReva5 = [36.0080412957393 35.9198913486750 35.8338484697606 35.7498831171376 35.6678746723656 35.5878015180148 35.5095528800358 35.4331138185956 35.3583820571764 35.2853483193010 35.2139177090359 35.1440857822208 35.0757640903901 35.0089523369404 34.9435677355758 34.8796135699359 34.8170120511339 34.7557695703287 34.6958127700055 34.6371507535547 34.5797141098066 34.5235143226183 34.4684855097662 34.4146412558423 34.3619188466750 34.3103337314478 34.2598260502302 34.2104129170853 34.1620370526777 34.1147170664579 34.0683980201799 34.0230998751070 33.9787698233427 33.9354290564348 33.8930267111705 33.8515851063120 33.8110551593127 33.7714602293367 33.7327528688639 33.6949574047354 33.6580278952169 33.6219895739833 33.5867978902230 33.5524789344393 33.5189894442119 33.4863563264005 33.4545375154637 33.4235607023113 33.3933849370463 33.3640386700505 33.3354819943309 33.3077441022008 33.2807860649744 33.2546378054182 33.2292613159707 33.2046872444244 33.1808784535402 33.1578663164200 33.1356145216593 33.1141551729844 33.0934527462445 33.0735400864108 33.0543824231558 33.0360133585326 33.0176644453789 32.9993686001190 32.9818257844347 32.9650704044407 32.9490690789637 32.9338570149971 32.9194015129274 32.9057386114938 32.8928362795672 32.8807314240826 32.8693926739543 32.8588578466278 32.8490962278506 32.8401465936503 32.8319788888295 32.8246329027638 32.8180792467707 32.8123587855912 32.8074428106272 32.8033733314318 32.8001223396603 32.7977330678562 32.7961782346801 32.7955023835246 32.7956789951001 32.7967540218363 32.7987017501257 32.8015696517114 32.8053328718428 32.8100405256109 32.8156686816301 32.8222682374205 32.8298162624206 32.8383655934793 32.8478943926509 32.8584576134708 32.8700346196647 32.8826826818325 32.8963824945474 32.9111938732403 32.9270989954929 32.9441604812663 32.9623621711435 32.9817697861159 33.0023690427792 33.0242291037729 33.0473378134666 33.0717681690554 33.0975104417511 33.1246419178706 33.1531556516758 33.1831337479574 33.2145724689756 33.2475593576432 33.2820943941475 33.3182712881989 33.3560943525428 33.3956643267927 33.4369906000489 33.4801819708425 33.5252538109771 33.5723242125535 33.6214156414722 33.6726569772915;];
% medkP.SIRevaCTD3 = 

minkP.SIReva3 = resultados(6).SIReva;

fig = figure;
fig2 = plot(FF, polyval(medkP.pteo, FF), '-k', FF, polyval(medkP.pap1, FF), '-r',  FF, polyval(medkP.pap2, FF), '--m', FF, polyval(medkP.pap3, FF), '-m', FF, medkP.SIReva3, '*b');
hold on
fig1 = plot(FF, polyval(maxkP.pteo, FF), '-k', FF, polyval(maxkP.pap1, FF), '-r',  FF, polyval(maxkP.pap2, FF), '--m', FF, maxkP.SIReva3, '*b');
leg = legend('Simulação Sem Aproximações', 'Simulação Log Linear', 'Simulação Log Quadrático', 'Simulação Log Cúbico', 'Modelo Analítico (3ª ordem)');
set(gca, 'FontSize', 12)
set(fig, 'Position', [100 100 640 500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
axis([3.1 3.8 20 55])
set(fig1(1:3), 'LineWidth', 2)
set(fig2(1:4), 'LineWidth', 2)
set(gca, 'xtick', 3.1:0.1:3.8)
grid on
set(leg,'Position',[0.429513888888889 0.693666666666667 0.462326388888889 0.216]);
% Create textbox
annotation(fig,'textbox',[0.235748236677124 0.620071292289081 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 40 GHz'},'FontSize',14,'FitBoxToText','off','LineStyle','none');
annotation(fig,'textbox',[0.588901645768031 0.1505490250826 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 75 GHz'},'FontSize',14,'FitBoxToText','off','LineStyle','none');
% Create ellipse
annotation(fig,'ellipse',[0.2494375 0.434 0.0349374999999996 0.216]);
annotation(fig,'ellipse',[0.607250000000001 0.244 0.020874999999999 0.088]);
% % 
cd('../../DissertacaoPG/figuras/matlab')
saveas(fig, 'OFDM_UWB1_20km.fig')
cd ..
saveas(fig, 'OFDM_UWB1_20km', 'epsc');
cd('../../codigos/Graficos')

