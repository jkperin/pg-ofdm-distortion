clear, clc, close all

%% L = 100 km | P0 = 5 mW
pap1 = [0.003564137092496 -0.077975989890058 0.695457215367470 -3.335761799979468 9.368311462426835 -18.617860111129126 21.929592241044844];
pap2 = [0.003758018494305 -0.081264033560171 0.713287850765800 -3.357509212740057 9.266235003339048 -18.208522537989452 21.810085598500095];
pteo = [0.004228428932204 -0.091212806874885 0.792089411271383 -3.633996066913422 9.591760771866515 -17.804410985493400 20.746907656531047];
FF = [0.300000000000000 0.350000000000000 0.400000000000000 0.450000000000000 0.500000000000000 0.550000000000000 0.600000000000000 0.650000000000000 0.700000000000000 0.750000000000000 0.800000000000000 0.850000000000000 0.900000000000000 0.950000000000000 1 1.05000000000000 1.10000000000000 1.15000000000000 1.20000000000000 1.25000000000000 1.30000000000000 1.35000000000000 1.40000000000000 1.45000000000000 1.50000000000000 1.55000000000000 1.60000000000000 1.65000000000000 1.70000000000000 1.75000000000000 1.80000000000000 1.85000000000000 1.90000000000000 1.95000000000000 2 2.05000000000000 2.10000000000000 2.15000000000000 2.20000000000000 2.25000000000000 2.30000000000000 2.35000000000000 2.40000000000000 2.45000000000000 2.50000000000000 2.55000000000000 2.60000000000000 2.65000000000000 2.70000000000000 2.75000000000000 2.80000000000000 2.85000000000000 2.90000000000000 2.95000000000000 3 3.05000000000000 3.10000000000000 3.15000000000000 3.20000000000000 3.25000000000000 3.30000000000000 3.35000000000000 3.40000000000000 3.45000000000000 3.50000000000000 3.55000000000000 3.60000000000000 3.65000000000000 3.70000000000000 3.75000000000000 3.80000000000000 3.85000000000000 3.90000000000000 3.95000000000000 4 4.05000000000000 4.10000000000000 4.15000000000000 4.20000000000000 4.25000000000000 4.30000000000000 4.35000000000000 4.40000000000000 4.45000000000000 4.50000000000000 4.55000000000000 4.60000000000000 4.65000000000000 4.70000000000000 4.75000000000000 4.80000000000000 4.85000000000000 4.90000000000000 4.95000000000000 5 5.05000000000000 5.10000000000000 5.15000000000000 5.20000000000000 5.25000000000000 5.30000000000000 5.35000000000000 5.40000000000000 5.45000000000000 5.50000000000000 5.55000000000000 5.60000000000000 5.65000000000000 5.70000000000000 5.75000000000000 5.80000000000000 5.85000000000000 5.90000000000000 5.95000000000000 6 6.05000000000000 6.10000000000000 6.15000000000000 6.20000000000000 6.25000000000000 6.30000000000000 6.35000000000000 6.40000000000000 6.45000000000000 6.50000000000000 6.55000000000000 6.60000000000000 6.65000000000000];

SIReva3 = [16.6266456502262 15.6157615407454 14.7766072863913 14.0604004716944 13.4344268830274 12.8762588712287 12.3616976701560 11.8712636938325 11.4308553916543 11.0008611899592 10.6104520124425 10.2229402027046 9.86900236068909 9.51355199481039 9.18796017522606 8.85803106056019 8.55552824998894 8.24678552124951 7.96368001444385 7.67299064108704 7.40662747924796 7.13156320005804 6.87985001840024 6.61857666262285 6.37976526744962 6.13074313076260 5.90349345702795 5.66536265549816 5.44849358170603 5.22022662997945 5.01264383632472 4.79329856105064 4.59420608948546 4.38287042336619 4.19150599605454 3.98755725211497 3.80314543539668 3.60595780071063 3.42801421727236 3.23705356605882 3.06506455027848 2.87968693569244 2.71304982704989 2.53295514235247 2.37139043406613 2.19603993528647 2.03918012440816 1.86837273165673 1.71571977471490 1.54914250384164 1.40056019014247 1.23774409977646 1.09296090931320 0.933825882351700 0.792390443510805 0.636698292232080 0.498578572977585 0.345886407371398 0.210869461528327 0.0616381007936126 -0.0702482719907220 -0.247663655494221 -0.376475167924514 -0.519997746721463 -0.646448868962181 -0.787955961119326 -0.912531020460906 -1.05172607373440 -1.17407950370803 -1.31143862213010 -1.43173780281801 -1.56713162769058 -1.68587246547847 -1.81946911045210 -1.93649629422318 -2.06882026650423 -2.18430206501277 -2.31517837864377 -2.42966721233578 -2.55927029194564 -2.67256797624285 -2.80148650622853 -2.91377283435203 -3.04179090472212 -3.15369023217339 -3.28099792261416 -3.39227338560585 -3.51953832652463 -3.63039048426384 -3.75735899059409 -3.86849969217303 -3.99538631863537 -4.10654325697945 -4.23411044882837 -4.34551482815897 -4.47347422103545 -4.58594271781675 -4.71454382758184 -4.82777312894238 -4.95789197031655 -5.07215617608568 -5.20347517982807 -5.31971754904364 -5.45253535153217 -5.57042921180487 -5.70576009226232 -5.82564022537329 -5.96314773385798 -6.08611285689990 -6.22616641181101 -6.35188140034083 -6.49566764572576 -6.62455497868880 -6.77173890588609 -6.90509443569532 -7.05615042411947 -7.19365822570591 -7.34999630740080 -7.49175614437369 -7.65262825380916 -7.80019026666956 -7.96623300086898 -8.11935154569078 -8.30891565666701 -8.48439448493422 -8.67929941083091 -8.86176664298869 -9.06293925323145;];
SIReva4 = [16.6265092093547 15.6155131959670 14.7761925138278 14.0597521322328 13.4334645428340 12.8748892887687 12.3598174139022 11.8687660604401 11.4276013133824 10.9967253353928 10.6052629982709 10.2165554210340 9.86121428245319 9.50420198161306 9.17679988146283 8.84488740104071 8.54010676149280 8.22890053269652 7.94298567155441 7.64929119460729 7.37951974668595 7.10084547296932 6.84505562207004 6.57950221969965 6.33587556092122 6.08183836686107 5.84896362661033 5.60501962695182 5.38164572068847 5.14670497930848 4.93167213607268 4.70473408040690 4.49718107779503 4.27728205850224 4.07638766332612 3.86285481954186 3.66779317013374 3.45995863779167 3.27019467471664 3.06748787684959 2.88246874749100 2.68422724821075 2.50332755811806 2.30922753336532 2.13213763090462 1.94163813473929 1.76797634941610 1.58086706255896 1.41013991525372 1.22611491736291 1.05817936550765 0.876798181146145 0.711392977854445 0.532585564751502 0.369296265433029 0.192853397797471 0.0316552250483133 -0.142810867149501 -0.302102789785134 -0.474166093706866 -0.631519256265483 -0.828652436225194 -0.983921676519489 -1.15202150625688 -1.30596581072715 -1.47282995215010 -1.62582902653554 -1.79116613244805 -1.94289831330362 -2.10708518015313 -2.25766872712653 -2.42056770443758 -2.57038901734597 -2.73211210265217 -2.88101843985912 -3.04196842153399 -3.19007960823454 -3.35009332775634 -3.49783127107648 -3.65703591787892 -3.80423469123482 -3.96307746569899 -4.10987248750002 -4.26818500755047 -4.41505951644936 -4.57299335386177 -4.71977019367947 -4.87783523355529 -5.02468562603700 -5.18271169303827 -5.33017715500572 -5.48835585317551 -5.63627552846005 -5.79518660349716 -5.94376940509383 -6.10325995527943 -6.25313204344825 -6.41343628860867 -6.56444823774339 -6.72623717734098 -6.87865924012861 -7.04179623241510 -7.19634089512761 -7.36112862559206 -7.51768410219051 -7.68488776571212 -7.84378740375658 -8.01331657045250 -8.17539465688547 -8.34762506359754 -8.51281100285942 -8.68864353694935 -8.85737693323670 -9.03678220790416 -9.21003871995442 -9.39351801257652 -9.57132983658088 -9.75994822098659 -9.94262561697079 -10.1362239324617 -10.3249657777207 -10.5242183383534 -10.7192041026454 -10.9339773676233 -11.1440676191821 -11.3651109074123 -11.5827731728163 -11.8110865927099];
SIReva5 = [16.6265084056524 15.6155112307496 14.7761882851788 14.0597438811108 13.4334496378621 12.8748639879507 12.3597766861380 11.8687034775153 11.4275081815110 10.9965914481002 10.6050748184676 10.2162979222134 9.86086762289646 9.50374521759107 9.17620518457545 8.84412678064656 8.53914246834004 8.22769636357230 7.94149179887383 7.64746203875689 7.37729094000252 7.09816103533373 6.84183390058550 6.57567584318924 6.33134275646123 6.07651952617552 5.84273363037693 5.59778633511177 5.37325718075774 5.13705623872057 4.92058128214214 4.69208336523525 4.48275484985582 4.26095113434615 4.05789863256612 3.84206803045912 3.64441484385765 3.43383993841114 3.24099739209875 3.03505683140380 2.84641795250176 2.64439997975102 2.45928700145595 2.26081663354216 2.07886559349320 1.88335546676910 1.70413343271981 1.51132515723911 1.33429300433683 1.14383758918530 0.968804421178555 0.780226311365882 0.606889891017313 0.420080617646990 0.247995846076649 0.0627165014616739 -0.108177230576067 -0.292331269755611 -0.462243834686061 -0.644889655647254 -0.813818935226162 -1.02125770227432 -1.18901403931641 -1.36944013892901 -1.53683449847466 -1.71690822243520 -1.88430399155071 -2.06375379651536 -2.23085320736315 -2.41003051088293 -2.57694497779008 -2.75571871428948 -2.92280051306516 -3.10126814710711 -3.26837089384551 -3.44688944407897 -3.61411402619525 -3.79252545041536 -3.96023917177770 -4.13864707859942 -4.30669054076418 -4.48547797074117 -4.65396016177474 -4.83296829647487 -5.00229783525567 -5.18165010568230 -5.35166447183667 -5.53178932607549 -5.70262903869035 -5.88337780280886 -6.05549302190804 -6.23702751520915 -6.41028384046525 -6.59308566466512 -6.76766099055307 -6.95161445974999 -7.12802450922540 -7.31333611156752 -7.49147711794201 -7.67870098583464 -7.85881209154953 -8.04787136243160 -8.23053707614884 -8.42170817184436 -8.60688375128385 -8.80079775790135 -8.98879003261402 -9.18544065842892 -9.37693386284501 -9.57667692145328 -9.77169722739716 -9.97527721429300 -10.1742399331974 -10.3817428370840 -10.5854532311379 -10.7973633680653 -11.0059774118267 -11.2231829898414 -11.4370806177936 -11.6596548545165 -11.8798428754953 -12.1084580650594 -12.3352842458056 -12.5769161219143 -12.8166153228039 -13.0650677575712 -13.3126789857766 -13.5689687188678;];

%% L = 100 km | P0 = 3 mW
pap1P3 = [0.007279435897492 -0.165101300904672 1.483174529988071 -6.804314552185913 17.247170323565400 -26.130648746045930 26.617005950431860];
pap2P3 = [0.007402202573267 -0.167300227889410 1.497035304593457 -6.827406405634937 17.096058765357880 -25.327416136790273 26.305414000253800];
pteoP3 = [0.009758724092454 -0.220739850265371 1.971910879286549 -8.906807020510868 21.679309302684380 -29.694310028523027 26.790674246371925];

SIReva3P3 = [20.2224644727901 19.0211019065619 18.0065733060185 17.1342807989579 16.3732711378334 15.7011695382175 15.0929891688341 14.5280630376123 14.0293702619138 13.5565867072316 13.1355760606094 12.7295525349606 12.3657958637869 12.0098888414154 11.6897722628756 11.3726772148126 11.0868382578993 10.8006757788980 10.5424699183200 10.2815627324712 10.0461833318782 9.80631237514903 9.59015310764330 9.36815095913279 9.16842000648292 8.96180539202355 8.77635126710299 8.58311862323451 8.41019308368618 8.22876163628645 8.06689811728121 7.89593495600561 7.74396835475748 7.58231298083849 7.43922877148274 7.28595741656958 7.15084150842653 7.00512388617469 6.87725906878432 6.73840487634025 6.61713066140954 6.48438320311162 6.36905188993579 6.24191955939549 6.13205572732108 6.00996804525282 5.90509797572022 5.78765077604020 5.68727994857456 5.57405439414347 5.47785592096029 5.36839664096590 5.27601286370731 5.17003885174669 5.08106006872905 4.97824684871895 4.89244579177835 4.79240353246144 4.70949606791315 4.61231349372130 4.53223765723249 4.38593556347417 4.30788653976849 4.21489404354775 4.13896155683814 4.04761057919058 3.97343861896840 3.88380791431601 3.81145572958170 3.72321278855674 3.65248256565933 3.56554845984340 3.49611066175255 3.41028887692784 3.34208722089153 3.25703483376744 3.18988166595382 3.10555063739702 3.03909689484528 2.95529424208789 2.88950910475860 2.80586435451835 2.74055692487961 2.65704330447796 2.59182865887199 2.50824443537215 2.44310856195041 2.35904012024132 2.29377711398673 2.20921138717406 2.14338484072475 2.05810030152075 1.99170571681542 1.90523023385272 1.83803530854445 1.75036282366512 1.68186340586992 1.59274129958001 1.52293500538806 1.43181584274178 1.36043134436351 1.26730842064840 1.19375489161208 1.09833091805836 1.02259853961520 0.924230047313611 0.845992014686046 0.744660420787890 0.663214748833869 0.558558963490718 0.473873300774377 0.365125453900603 0.276793390458048 0.163903817888791 0.0710773290319623 -0.0464086112329314 -0.143810447273906 -0.266827422309979 -0.369019019797513 -0.497371386259626 -0.605389113134284 -0.739668478600106 -0.853680748353134 -1.02732754506767 -1.17943460642189 -1.35812832257705 -1.51628779676679 -1.70083670448653;];
SIReva4P3 = [20.2224393076743 19.0210553224030 18.0064941111019 17.1341547467480 16.3730806239026 15.7008935677631 15.0926037712158 14.5275426372980 14.0286818261735 13.5556990538941 13.1344477330571 12.7281472050042 12.3640630352109 12.0077875690111 11.6872422612007 11.3696734985636 11.0832898448879 10.7965342313396 10.5376525393117 10.2760182684328 10.0398161652884 9.79906923726763 9.58192411782661 9.35888166917318 9.15798493024041 8.95014989198914 8.76333269386926 8.56868348313404 8.39417981185880 8.21111931832808 8.04744489772835 7.87462391228543 7.72059540241320 7.55683752067106 7.41142243064009 7.25578790117775 7.11805469474764 6.96969789298201 6.83891149392820 6.69712700014638 6.57261037518313 6.43662948828806 6.31772034111961 6.18703819099065 6.07324537469428 5.94728099158917 5.83811721705584 5.71645587785801 5.61141536456051 5.49363007245939 5.39237418870739 5.27800442888314 5.18016617508556 5.06892498473394 4.97408905020162 4.86564899239210 4.77358012940315 4.66755187292256 4.57796075086633 4.47442208564535 4.38723672956675 4.23603965738798 4.15056635621635 4.05060211332249 3.96684343955984 3.86819556144248 3.78580664788088 3.68855222508055 3.60758596265913 3.51140620470710 3.43166963831189 3.33649079777697 3.25766800947841 3.16330557861349 3.08534148736742 2.99147356429817 2.91418846766467 2.82077248886342 2.74383674432464 2.65069301482375 2.57407473762379 2.48085938720455 2.40437707603781 2.31106520230139 2.23435488138331 2.14075755200937 2.06380273217040 1.96953767329627 1.89214013265506 1.79719125995795 1.71894301923891 1.62310018860361 1.54398389446324 1.44681042216655 1.36660023376327 1.26807741613385 1.18630086409304 1.08618570515713 1.00281916716136 0.900603165973000 0.815377115418153 0.711031378852691 0.623393804916194 0.516625438770016 0.426531718046753 0.316744135737293 0.223867548152877 0.111005005658143 0.0146880237308587 -0.101608091573593 -0.201444369998151 -0.321888650771553 -0.425656287635568 -0.550350805578438 -0.658842830942226 -0.788246437600807 -0.901611769025169 -1.03659460897334 -1.15510573022651 -1.29559941627247 -1.42023576286428 -1.56684392281949 -1.69786598871341 -1.87795536301712 -2.04145781374063 -2.22695977290820 -2.39689079951307 -2.58865608217275];

%% P0 = 1 mW
pap1P1 = [-0.016866488467045 0.377863260628160 -3.228589828019522 12.639942067840307 -19.789934302945430 -0.151835773886965 27.196589678911597];
pap2P1 = [-0.014413413058222 0.328969717737926 -2.868278133685216 11.507331215790531 -18.898130837890292 2.108013923931164 25.748004185385554];
pteoP1 = [-0.002238623561342 0.049029737309655 -0.332068202375010 0.052171375886885 7.880575570528890 -27.576559728875715 35.625788318547490];

SIReva3P1 = [28.8660138226442 27.3744582513825 26.0434668643065 24.8336314463808 23.7188027710127 22.6809342436308 21.7007347992930 20.7634822010071 19.8871119168247 19.0422250679095 18.2474777461132 17.4776448940413 16.7510275079722 16.0454923022654 15.3785853158828 14.7306174448197 14.1182698612905 13.5238604017597 12.9632067809037 12.4203059587959 11.9101535256109 11.4181420361642 10.9584868713138 10.5177202255417 10.1092873933879 9.72061954963517 9.36438165206647 9.02866277987389 8.72532875037150 8.44291321751160 8.19245823760674 7.96277660793115 7.76409753083506 7.58539252473591 7.43614161339801 7.30542587658867 7.20207179260619 7.11528398883196 7.05337193154511 7.00573342416259 6.98024510609315 6.96650362101623 6.97222732316076 6.98722833435956 7.01910893370494 7.05793666684157 7.11129604827720 7.16950185200068 7.24017177457434 7.31385124105691 7.39823449746764 7.48404152944486 7.57908790468208 7.67421496103887 7.77737143033766 7.87947600508422 7.98863494750664 8.09576753493505 8.20918007080404 8.31984015404334 8.43616614942455 8.41608660885595 8.52743521982251 8.63455312491640 8.74618394329301 8.85296034711719 8.96404320145502 9.06981007047823 9.17972091493976 9.28380160757139 9.39194659757447 9.49375810238849 9.59960428005822 9.69861289249711 9.80169619442307 9.89739892768708 9.99728355893981 10.0892240292307 10.1854886371152 10.2732178756431 10.3654785196103 10.4485442634325 10.5364154586439 10.6143913735150 10.6974777743289 10.7699235941675 10.8478552159160 10.9143103030633 10.9867007090610 11.0467256409404 11.1131666891022 11.1662993315775 11.2264087714256 11.2721606755612 11.3255345288403 11.3634459679070 11.4096552840642 11.4392445703030 11.4778968539437 11.4986586679648 11.5293414650092 11.5408169089413 11.5630954082896 11.5648109286177 11.5783046345411 11.5697704271945 11.5740835785429 11.5548794415601 11.5495971286945 11.5192953541512 11.5040760611780 11.4622365159139 11.4367232361659 11.3829949196791 11.3468064032563 11.2808271346914 11.2336667448559 11.1550509908147 11.0966738664235 11.0052115269108 10.9352410952723 10.8306008192778 10.7487388306190 10.5703173099928 10.4187859570810 10.2332884262432 10.0749242640763 9.88171086773708;];
SIReva4P1 = [28.8660114121817 27.3744538436412 26.0434594632662 24.8336198117715 23.7187853957075 22.6809093624160 21.7007004054969 20.7634361431404 19.8870514816135 19.0421476076626 18.2473798648288 17.4775234218316 16.7508782864408 16.0453116015669 15.3783681211281 14.7303594194155 14.1179650276858 13.5235037638782 12.9627912832597 12.4198258904868 11.9096006302585 11.4175098338125 10.9577657758672 10.5169029360853 10.1083628619577 9.71957960731039 9.36321365292253 9.02735764821205 8.72387209918626 8.44129503639460 8.19066226723854 7.96079187474294 7.76190575712828 7.58298177067410 7.43349143735267 7.30252337508829 7.19889421805438 7.11181748215013 7.04959127139654 7.00162380523926 6.97577873349851 6.96166487725194 6.96698562997309 6.98156725038268 7.01299493071244 7.05135258332211 7.10420522257155 7.16188648995242 7.23199189191221 7.30508851123125 7.38884537804043 7.47400730628548 7.56836120547323 7.66277682041364 7.76517038012408 7.86649298012303 7.97481401499760 8.08108972563245 8.19358457862080 8.30330794455401 8.41863111032218 8.39810870102753 8.50843074124379 8.61451166658134 8.72503846762066 8.83070377125998 8.94060398580035 9.04518457105031 9.15383288718267 9.25665198441015 9.36345411644020 9.46392924485819 9.56835251959341 9.66595132814655 9.76753248501492 9.86175423321733 9.96005909964180 10.0504503566325 10.1450600904345 10.2311759312584 10.3217096841406 10.4031030489898 10.4891794902939 10.5654300144835 10.6466566179017 10.7173299463022 10.7933443522214 10.8579895556743 10.9284123435118 10.9865993754899 11.0510306259268 11.1023082265899 11.1603742221284 11.2042661908861 11.2555728036128 11.2916318682112 11.3357610524304 11.3635193519508 11.4000892027168 11.4190562158355 11.4476659071892 11.4573967522355 11.4776237666953 11.4776596957929 11.4891343358338 11.4790006228405 11.4813385261049 11.4606276883163 11.4534253212279 11.4217224721449 11.4046468406630 11.3615240473796 11.3342267437992 11.2793411898204 11.2414490275683 11.1744463496978 11.1256665332329 11.0461679462821 10.9862576045854 10.8940525015364 10.8226384231603 10.7173969135686 10.6341793388166 10.4569042979474 10.3056501520344 10.1212493126257 9.96310677816172 9.77093943337380;];

%%
plot(FF, polyval(pteo,FF), '-k', 'LineWidth', 2), hold on
plot(FF, polyval(pap1,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(pap2,FF), '-m', 'LineWidth', 2)
plot(FF, SIReva3, '*b')
plot(FF, SIReva4, 'pg')
plot(FF, SIReva5, 'hc')
plot(FF, polyval(pteoP3,FF), '-k', 'LineWidth', 2)
plot(FF, polyval(pap1P3,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(pap2P3,FF), '-m', 'LineWidth', 2)
plot(FF, SIReva3P3, '*b')
plot(FF, polyval(pteoP1,FF), '-k', 'LineWidth', 2)
plot(FF, polyval(pap1P1,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(pap2P1,FF), '-m', 'LineWidth', 2)
plot(FF, SIReva3P1, '*b')

legend('Numérico', 'Log Linear (Numérico)', 'Log Quad (Numérico)', 'Analítico (Ordem 3)', 'Analítico (Ordem 4)', 'Analítico (Ordem 5)');
xlabel('Frequência (GHz)', 'FontSize', 14);
ylabel('SIR (dB)', 'FontSize', 14);
set(gca, 'FontSize', 14)
axis([FF(1) FF(end) -20 20])
grid on

%% L = 20 km | P0 = 5 mW
pap1P5z20 = [-0.002873391029272 0.056974225289774 -0.420513404045537 1.333694241671277 -0.836448457116224 -6.139320342308728 26.253966675734760];
pap2P5z20 = [-0.002756590514075 0.053759960862306 -0.383958393498519 1.111885347892823 -0.124571326463795 -6.839102082283906 26.355757643320228];
pteoP5z20 = [0.004042445863322 -0.104741120570945 1.084501054510738 -5.773017095981420 17.059483149104338 -28.435330646176530 36.094354391286640];

SIReva3P5z20 = [29.4828632145873 28.1943321439404 27.0873067489024 26.1194407176456 25.2618024450163 24.4937402964799 23.7906210729025 23.1313044764545 22.5442024468027 21.9845615617945 21.4842696114488 21.0007559803718 20.5679894716300 20.1446013059366 19.7659202985138 19.3912510063632 19.0568840642936 18.7224953012598 18.4250899322102 18.1245403653322 17.8584164882898 17.5866609507924 17.3473223072113 17.1003358293533 16.8841515587635 16.6586577662879 16.4626616315019 16.2559505133822 16.0776754012604 15.8874935597937 15.7248602442848 15.5493004010198 15.4005591429182 15.2379882227842 15.1016376754780 14.9506698123363 14.8254080791456 14.6848393585012 14.5695577392464 14.4383442445321 14.3320707590736 14.2092858066804 14.1111569782454 13.9960136539600 13.9052967806300 13.7970774247506 13.7131168342589 13.6112153122997 13.5334159740360 13.4372833784662 13.3651492551455 13.2742801511263 13.2073572319296 13.1213359344317 13.0592004486390 12.9776405257755 12.9199527266638 12.8424864779578 12.7889257213380 12.7153192533422 12.6656323120095 12.5430951658589 12.4962170199730 12.4288744265353 12.3852799695066 12.3208952623747 12.2803408506235 12.2187670503491 12.1811231400214 12.1221445120298 12.0872423661439 12.0307219269679 11.9983758531152 11.9441618767840 11.9142674393155 11.8621857666169 11.8346190532602 11.7845795362540 11.7591896859574 11.7110780228103 11.6878020435799 11.6414720641240 11.6202186253891 11.5756159515082 11.5562578060319 11.5132954342497 11.4958020946822 11.4543524270184 11.4386568817587 11.3986939676567 11.3846847978233 11.3461420263927 11.3338154187844 11.2965771109725 11.2858847991712 11.2499486240042 11.2407895422863 11.2061045557315 11.1984978924618 11.1649555354791 11.1588680569180 11.1264865759379 11.1218236709902 11.0905645701464 11.0873663098289 11.0571246016927 11.0553703952199 11.0261831360009 11.0257820293199 10.9976210155500 10.9986330129356 10.9713941331107 10.9738098830205 10.9475481939383 10.9512783887117 10.9259746051209 10.9310991822705 10.9066479533765 10.9132668280884 10.8898431357986 10.8978798377229 10.8754839809516 10.8850528593414 10.7918403010224 10.7306837227778 10.6389940664102 10.5787352854414 10.4885204364166;];

%% L = 20 km | P0 = 3 mW
pap1P3z20 = [0.001856713756909 -0.036479645450782 0.245724394115932 -0.607381610848700 0.572343370450717 -3.663962312412560 26.327006597005365];
pap2P3z20 = [0.001620008039146 -0.032619644579833 0.226633624419712 -0.632990702399103 1.160148447706895 -4.728522113967245 26.560163386385664];
pteoP3z20 = [0.008970015827337 -0.206807559988269 1.877290561075209 -8.616468831101937 22.015117057403817 -33.201416527058970 41.927560152239394];

SIReva3P3z20 = [33.8701849006626 32.5639570987983 31.4366583195384 30.4460005443529 29.5631170902755 28.7674265314457 28.0343847383643 27.3429550527683 26.7215778655654 26.1256576507248 25.5870997997800 25.0635185183788 24.5888852563931 24.1220435228218 23.6983057965319 23.2772188234538 22.8950307694114 22.5116905343412 22.1641356414674 21.8125380871330 21.4943713687868 21.1699116116458 20.8770718980904 20.5761563998438 20.3054451777935 20.0252236868391 19.7740917194879 19.5122734684510 19.2786616141255 19.0333919005051 18.8156192945794 18.5853780446759 18.3820686339576 18.1655987044488 17.9756119532709 17.7718752775336 17.5942580098497 17.4023847921775 17.2363459847642 17.0556073132927 16.9004784882324 16.7302484404662 16.5854577088945 16.4252166770102 16.2902861865631 16.1395777481768 16.0140928153918 15.8725327749867 15.7561272274467 15.6233747620601 15.5157395325802 15.3914853417195 15.2923400213451 15.1763197859154 15.0854028964391 14.9773684604369 14.8944553771348 14.7941665760140 14.7190397287294 14.6263146681946 14.5587872169554 14.4149037516533 14.3534270040368 14.2740501073947 14.2196197258851 14.1470133612244 14.0994074253212 14.0333877851647 13.9924271253862 13.9327650739004 13.8982406302260 13.8447301214968 13.8164151734597 13.7688334742565 13.7465266926328 13.7046313153588 13.6881138972049 13.6516900884869 13.6407231051925 13.6095376010718 13.6039139758859 13.5777124244852 13.5772068856635 13.5557704497390 13.5601371060647 13.5432283230438 13.5522619814960 13.5396221263107 13.5530996322133 13.5445149447988 13.5621924919670 13.5574307272851 13.5791151488433 13.5779224542393 13.6034025617402 13.6055801019392 13.6346233928078 13.6399532342012 13.6723880769655 13.6806293205630 13.7162649641463 13.7272418402369 13.7658643437531 13.7793801157095 13.8208466495186 13.8366788863332 13.8808250909678 13.8988265926098 13.9454616766711 13.9654610510418 14.0144757019513 14.0362717487204 14.0875314490192 14.1110085340325 14.1643478301872 14.1893616730021 14.2447074416776 14.2710786079070 14.3283871415485 14.3560945510156 14.4152350627019 14.4441698330083 14.5051164657611 14.4468504376006 14.4202952305671 14.3630548219755 14.3368129898248 14.2804780941522;];

%% L = 20 km | P0 = 1 mW
pap1P1z20 = [-0.004508466242321 0.047313237378442 0.060232850757083 -1.835302613849437 4.907628326724080 -3.802536604621758 26.370372179526438];
pap2P1z20 = [-0.003974300918117 0.055338321279778 -0.205904506961071 0.047982681999386 0.415013613800146 -0.994631633881885 25.712046065069085];
pteoP1z20 = [-0.004271695142853 0.039486703248638 0.202513692145884 -3.294946683380645 13.469493976507122 -27.742405511582840 50.221408062279860];

SIReva3P1z20 = [43.3434415035352 42.0125904604712 40.8570556497117 39.8346012918645 38.9164140038973 38.0819662294325 37.3070090796280 36.5709545538261 35.9012713136004 35.2546207551339 34.6616178335274 34.0814561066192 33.5464710306571 33.0174295273397 32.5276415295285 32.0389386405517 31.5851828055454 31.1289809497187 30.7044928240315 30.2749260319072 29.8745791944202 29.4671480865609 29.0869687055766 28.6981487123956 28.3349952409170 27.9619731108759 27.6133188331280 27.2538111070912 26.9175913248718 26.5697169307030 26.2442202494246 25.9064076974672 25.5901980345664 25.2611180398613 24.9529759449408 24.6314927663359 24.3303724626946 24.0155062248433 23.7205049923507 23.4114072751454 23.1217414147406 22.8176659651198 22.5326532484186 22.2329571262903 21.9520080561352 21.6561326108391 21.3787425633538 21.0862138223003 20.8119612472406 20.5223889061565 20.2509400860768 19.9640225432500 19.6951373473395 19.4106740163124 19.1442185746363 18.8621235249287 18.5980914745369 18.3184153465633 18.0569511606720 17.7799231409286 17.5213661864839 17.1648271333384 16.9061399666060 16.6324590794456 16.3776275016527 16.1082328642221 15.8583807847063 15.5945879524376 15.3512467709644 15.0947915039897 14.8599496051994 14.6130629036526 14.3892248171141 14.1546721191725 13.9448903955961 13.7259766233894 13.5338245351070 13.3343413853390 13.1638128898195 12.9878861255191 12.8432012362415 12.6950346305468 12.5803239026611 12.4638462953448 12.3827515451859 12.3011871116840 12.2564400760233 12.2118974047397 12.2049457209824 12.1981263034400 12.2289226258995 12.2590075101259 12.3260257235571 12.3907943691014 12.4912438236731 12.5873933782883 12.7175924247491 12.8411422953534 12.9969588299869 13.1436714003684 13.3209071452714 13.4866539710034 13.6813473234836 13.8623460393533 14.0709801480665 14.2639350368845 14.4835190993795 14.6856902011131 14.9137779592271 15.1229579800116 15.3576367816796 15.5721053667852 15.8119249882783 16.0304074730395 16.2743148960530 16.4958983105630 16.7431974010023 16.9672676720644 17.2175592692746 17.4437931456964 17.6968939111973 17.9251564575447 18.1811050998451 18.2646701373688 18.3732614965986 18.4544192368070 18.5595992076237 18.6381746989020;];

%%
figure
plot(FF, polyval(pteoP5z20,FF), '-k', 'LineWidth', 2), hold on
plot(FF, polyval(pap1P5z20,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(pap2P5z20,FF), '-m', 'LineWidth', 2)
plot(FF, SIReva3P5z20, '*b')
% plot(FF, polyval(pteoP3z20,FF), '-k', 'LineWidth', 2)
% plot(FF, polyval(pap1P3z20,FF), '-r', 'LineWidth', 2)
% plot(FF, polyval(pap2P3z20,FF), '-m', 'LineWidth', 2)
% plot(FF, SIReva3P3z20, '*b')
plot(FF, polyval(pteoP1z20,FF), '-k', 'LineWidth', 2)
plot(FF, polyval(pap1P1z20,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(pap2P1z20,FF), '-m', 'LineWidth', 2)
plot(FF, SIReva3P1z20, '*b')

legend('Numérico', 'Log Linear (Numérico)', 'Log Quad (Numérico)', 'Analítico (Ordem 3)');
xlabel('Frequência (GHz)', 'FontSize', 14);
ylabel('SIR (dB)', 'FontSize', 14);
set(gca, 'FontSize', 14)
axis([FF(1) FF(end) 5 35])
grid on

%% gigabit ethernet
FF = [1 1.01000000000000 1.02000000000000 1.03000000000000 1.04000000000000 1.05000000000000 1.06000000000000 1.07000000000000 1.08000000000000 1.09000000000000 1.10000000000000 1.11000000000000 1.12000000000000 1.13000000000000 1.14000000000000 1.15000000000000 1.16000000000000 1.17000000000000 1.18000000000000 1.19000000000000 1.20000000000000 1.21000000000000 1.22000000000000 1.23000000000000 1.24000000000000 1.25000000000000 1.26000000000000 1.27000000000000 1.28000000000000 1.29000000000000 1.30000000000000 1.31000000000000 1.32000000000000 1.33000000000000 1.34000000000000 1.35000000000000 1.36000000000000 1.37000000000000 1.38000000000000 1.39000000000000 1.40000000000000 1.41000000000000 1.42000000000000 1.43000000000000 1.44000000000000 1.45000000000000 1.46000000000000 1.47000000000000 1.48000000000000 1.49000000000000 1.50000000000000 1.51000000000000 1.52000000000000 1.53000000000000 1.54000000000000 1.55000000000000 1.56000000000000 1.57000000000000 1.58000000000000 1.59000000000000 1.60000000000000 1.61000000000000 1.62000000000000 1.63000000000000 1.64000000000000 1.65000000000000 1.66000000000000 1.67000000000000 1.68000000000000 1.69000000000000 1.70000000000000 1.71000000000000 1.72000000000000 1.73000000000000 1.74000000000000 1.75000000000000 1.76000000000000 1.77000000000000 1.78000000000000 1.79000000000000 1.80000000000000 1.81000000000000 1.82000000000000 1.83000000000000 1.84000000000000 1.85000000000000 1.86000000000000 1.87000000000000 1.88000000000000 1.89000000000000 1.90000000000000 1.91000000000000 1.92000000000000 1.93000000000000 1.94000000000000 1.95000000000000 1.96000000000000 1.97000000000000 1.98000000000000 1.99000000000000;];
%% z= 100 km | P0 = 5mW
gepteoz100p5 = [-87.305542273527040 7.739264479727694e+02 -2.819373565984534e+03 5.399235668467022e+03 -5.720753098090230e+03 3.157186753815967e+03 -6.761239113143805e+02];
gepap1z100p5 = [-86.288299901327380 7.647721066792623e+02 -2.785542349695203e+03 5.333589368147101e+03 -5.649995982320497e+03 3.115903214906832e+03 -6.650655740573262e+02];
gepap2z100p5 = [-85.986353149233240 7.623677732964748e+02 -2.777708149168529e+03 5.320283909474092e+03 -5.637706997508950e+03 3.110270249435084e+03 -6.636961724194807e+02];

geSIRevaz100p53 = [26.6042006697631 26.3866738908291 26.1736517508546 25.9649810527770 25.7604594120648 25.5599583676871 25.3632995312696 25.1703747911130 24.9810256990450 24.7951610612128 24.6126391628121 24.4333830124773 24.2572650646897 24.0842203596054 23.9141334499830 23.7469496556989 23.5825639397083 23.4209304763850 23.2619532515885 23.1055941262308 22.9517649605748 22.8004343388856 22.6515210388043 22.5049995693749 22.3607948235932 22.2188865702957 22.0792051424347 21.9417350130789 21.8064113841078 21.6732229677273 21.5421093505032 21.4130630941772 21.2860277585768 21.1609994289936 21.0379252887485 20.9168046748558 20.7975880970781 20.6802779189445 20.5648277251540 20.4512427211598 20.3394793548940 20.2295455250111 20.1214003661984 20.0150543537368 19.9104691642129 19.8076577622565 19.7065842503362 19.6072640223480 19.5096635173976 19.4138005243145 19.3184275588385 19.2235627229337 19.1303907662333 19.0389321636167 18.9491580328807 18.8610912226391 18.7747050565662 18.6900247981492 18.6070259872403 18.5257363689179 18.4461337346893 18.3682484049860 18.2920604850896 18.2176029937202 18.1448584408402 18.0738626984469 18.0046008038066 17.9371116729918 17.8713830287568 17.8074570626574 17.7453243816281 17.6850307307910 17.6265698467556 17.5699913605932 17.5152924388511 17.4625269948013 17.4116959900274 17.3628580921510 17.3160185004655 17.2712412001549 17.2285361646496 17.1879733701913 17.1495682151759 17.1133974751829 17.0794827653221 17.0479086350434 17.0187038831516 16.9919620145016 16.9677201985896 16.9460823374697 16.9270954373442 16.9108755698497 16.8974814014980 16.8870433704056 16.8796340904408 16.8754011146157 16.8744338991123 16.8769005858667 16.8829111762096 16.8926588428948;];
geSIRevaz100p53simpl =[26.2333920290327 26.0124181789705 25.7959730585067 25.5839177999452 25.3760364063400 25.1722140263249 24.9722593124227 24.7760771061547 24.5834965880453 24.3944389167081 24.2087505379897 24.0263662614871 23.8471471862722 23.6710396457114 23.4979172794936 23.3277362319887 23.1603809591281 22.9958160260342 22.8339352857223 22.6747105875648 22.5180440050156 22.3639137369122 22.2122290951309 22.0629738551308 21.9160637428817 21.7714874688691 21.6291664777551 21.4890938808212 21.3511962523733 21.2154706589018 21.0818483038135 20.9503298370998 20.8208506650330 20.6934147115749 20.5679612225874 20.4444971393469 20.3229652378874 20.2033752656136 20.0856732658620 19.9698716205660 19.8559194181811 19.7438315385087 19.6335599289461 19.5251218618138 19.4184719895858 19.3136299002952 19.2105528270803 19.1092626233911 19.0097190059344 18.9119460684138 18.8146899913620 18.7179748057292 18.6229784987649 18.5297275681543 18.4381868263891 18.3483850071541 18.2602892545912 18.1739305870365 18.0892784845481 18.0063663239204 17.9251659508648 17.8457132011015 17.7679823426350 17.6920117994055 17.6177783473671 17.5453231597162 17.4746256379282 17.4057299010220 17.3386181292990 17.2733376245269 17.2098735397893 17.1482766429845 17.0885353008540 17.0307040849144 16.9747748712984 16.9208064363316 16.8687945261673 16.8188025988876 16.7708307089036 16.7249475639492 16.6811580586837 16.6395368285816 16.6000942549061 16.5629117136815 16.5280058599739 16.4954657893804 16.4653153930798 16.4376526722535 16.4125099363386 16.3899955383860 16.3701516670073 16.3530988040370 16.3388908354340 16.3276625733073 16.3194818821408 16.3145006574118 16.3128036306359 16.3145632594648 16.3198848380640 16.3289658330307;];

%% z = 100 km | P0 = 3mW
gepteoz100p3 = [-13.660175277844465 1.500497450909142e+02 -6.465084706319471e+02 1.415734874033702e+03 -1.663373838823665e+03 9.783257942297216e+02 -1.869594981905313e+02];
gepap1z100p3 = [-14.126046499915061 1.543520886115292e+02 -6.631976956610895e+02 1.451061129141419e+03 -1.707122109964414e+03 1.007825171625348e+03 -1.946915474287711e+02];
gepap2z100p3 = [-14.367345877626459 1.568740710969734e+02 -6.739512848595380e+02 1.475092652065992e+03 -1.737036402976625e+03 1.028017188990533e+03 -1.994665863419725e+02];

geSIRevaz100p33 = [32.8557056614510 32.6398940567146 32.4289223669098 32.2226656022399 32.0208720087153 31.8234408883044 31.6301459587175 31.4409065364897 31.2555175973814 31.0739151366006 30.8959120419925 30.7214583558845 30.5503821899253 30.3826455364609 30.2180895479067 30.0566864803346 29.8982887368507 29.7428774705384 29.5903148542574 29.4405898228115 29.2935730836736 29.1492604380026 29.0075300901323 28.8683839528267 28.7317068495392 28.5975061802182 28.4656726405768 28.3362186001293 28.2090399879742 28.0841537139736 27.9614603915878 27.8409811157294 27.7226207105924 27.6064041633212 27.4922400990229 27.3801571576701 27.2700674099417 27.1620029554709 27.0558790021201 26.9517309565822 26.8494768963942 26.7491554188369 26.6506872396014 26.5541140627954 26.4593590428281 26.3664669370255 26.2753631680862 26.1860955212870 26.0985915438366 26.0129020508876 25.9277369316916 25.8431463866665 25.7602785869766 25.6791883057384 25.5998067858089 25.5221918759704 25.4462766210414 25.3721220288786 25.2996628977706 25.2289635062363 25.1599603808176 25.0927212123078 25.0271842546282 24.9634207850288 24.9013708099919 24.8411094033221 24.7825783777487 24.7258568539239 24.6708885363285 24.6177568883416 24.5664076278699 24.5169289092294 24.4692686272193 24.4235200360352 24.3796334198312 24.3377076128342 24.2976955592040 24.2597022376453 24.2236835929000 24.1897514133041 24.1578650696999 24.1281439466105 24.1005513707345 24.0752152570093 24.0521035469183 24.0313538013055 24.0129393969937 23.9970088808242 23.9835420897179 23.9727001776320 23.9644707269341 23.9590294750976 23.9563733713197 23.9566951671139 23.9600032380304 23.9665103675076 23.9762389950663 23.9894257234172 24.0061104662935 24.0265584551857;];
geSIRevaz100p34 = [32.8279740016706 32.6130205234416 32.4028564413682 32.1973927416153 31.9963460262966 31.7996511066620 31.6070503046417 31.4184967327164 31.2337549595227 31.0527938991491 30.8753956225060 30.7015430269809 30.5310337190784 30.3638611347540 30.1998369561321 30.0389642538728 29.8810655530278 29.7261529713042 29.5740591220617 29.4248026321740 29.2782257050874 29.1343533327186 28.9930347805728 28.8543014287937 28.7180094768243 28.5841945722529 28.4527198672947 28.3236255412490 28.1967795107284 28.0722268525954 27.9498404827836 27.8296684424979 27.7115889777387 27.5956536076033 27.4817421194443 27.3699127004288 27.2600488959053 27.1522102706028 27.0462846422365 26.9423345036711 26.8402499633367 26.7400971924415 26.6417692347318 26.5453340778257 26.4506884063844 26.3579028591827 26.2668757706514 26.1776813214152 26.0902202882741 26.0045684901658 25.9194126698894 25.8348254912074 25.7519276143386 25.6707988558545 25.5913436781811 25.5136444103324 25.4376097537243 25.3633225867175 25.2906937230060 25.2198108593636 25.1505848082120 25.0831060181236 25.0172896740094 24.9532269172773 24.8908350846510 24.8302107208855 24.7712710929119 24.7141159886773 24.6586674573677 24.6050263670218 24.5531172233659 24.5030472276461 24.4547410039139 24.4083098377683 24.3636839167845 24.3209763532071 24.2801204749551 24.2412371684604 24.2042604611159 24.1693167102271 24.1363468587775 24.1054804288110 24.0766628048142 24.0500335560167 24.0255400286006 24.0033295797981 23.9833587980333 23.9657806034828 23.9505584388844 23.9378590172373 23.9276503002579 23.9201108296867 23.9152219626915 23.9131722591193 23.9139545337142 23.9177777277344 23.9246444162922 23.9347828956702 23.9482170588496 23.9651940378230;];
geSIRevaz100p33simpl = [32.4371814616684 32.2175218684939 32.0026768063819 31.7925741783826 31.5869106078720 31.3856363034630 31.1884753812081 30.9953962655733 30.8061461410634 30.6207084765601 30.4388499984636 30.2605667334688 30.0856421053004 29.9140827297520 29.7456864084687 29.5804687743207 29.4182400969217 29.2590237617045 29.1026409192100 28.9491216839838 28.7982967578368 28.6502021519835 28.5046769970512 28.3617625213895 28.2213053303629 28.0833513135754 27.9477537350924 27.8145626908977 27.6836374018653 27.5550317988395 27.4286104527766 27.3044308273874 27.1823623169781 27.0624656747774 26.9446146595019 26.8288731206226 26.7151187802649 26.6034184341894 26.4936534168818 26.3858933584755 26.2800228982433 26.1761144227123 26.0740556066014 25.9739215456755 25.8756027147669 25.7791769002656 25.6845371724328 25.5917640166552 25.5007529219667 25.4115871071946 25.3229454785254 25.2349091723800 25.1485936123673 25.0640854484538 24.9812846200033 24.9002806097990 24.8209753627625 24.7434613079354 24.6676423181496 24.5936139099503 24.5212818299716 24.4507448533497 24.3819105708253 24.3148812197972 24.2495662313445 24.1860715449284 24.1243084563709 24.0643868876120 24.0062200548908 23.9499221892706 23.8954085184750 23.8427979625420 23.7920078925131 23.7431623591211 23.6961810562523 23.6511936796849 23.6081224822571 23.5671034051790 23.5280615643194 23.4911398495180 23.4562666263429 23.4235925603868 23.3930497550122 23.3647976293666 23.3387726385263 23.3151441178373 23.2938536456499 23.2750818650014 23.2587764485375 23.2451310245629 23.2341005859699 23.2258937852187 23.2204744906563 23.2180688791262 23.2186516796256 23.2224696896480 23.2295110522610 23.2400470618351 23.2540825895196 23.2719183377356;];

%%
figure
plot(FF, polyval(gepteoz100p5,FF), '-k', 'LineWidth', 2), hold on
plot(FF, polyval(gepap1z100p5,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(gepap2z100p5,FF), '-m', 'LineWidth', 2)
plot(FF, geSIRevaz100p53, '*b')
plot(FF, geSIRevaz100p53simpl, 'pg')
% plot(FF, polyval(pteoP3z20,FF), '-k', 'LineWidth', 2)
% plot(FF, polyval(pap1P3z20,FF), '-r', 'LineWidth', 2)
% plot(FF, polyval(pap2P3z20,FF), '-m', 'LineWidth', 2)
% plot(FF, SIReva3P3z20, '*b')
plot(FF, polyval(gepteoz100p3,FF), '-k', 'LineWidth', 2)
plot(FF, polyval(gepap1z100p3,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(gepap2z100p3,FF), '-m', 'LineWidth', 2)
plot(FF, geSIRevaz100p33, '*b')
plot(FF, geSIRevaz100p33simpl, 'pg')
legend('Numérico', 'Log Linear (Numérico)', 'Log Quad (Numérico)', 'Analítico (Ordem 3)', 'Analítico Simplificado (Ordem 3)');
xlabel('Frequência (GHz)', 'FontSize', 14);
ylabel('SIR (dB)', 'FontSize', 14);
set(gca, 'FontSize', 14)
axis([FF(1) FF(end) 5 35])
grid on


%% z = 20 km | P0 = 5 mW
gepteoz20p5 = [86.566990734849600 -7.726951043896739e+02 2.854395960508633e+03 -5.585063466915405e+03 6.114067163480650e+03 -3.572984287582983e+03 9.247882831679023e+02];
gepap1z20p5 = [87.037141670675080 -7.764428185763588e+02 2.865793533594157e+03 -5.599851448433355e+03 6.115653272129185e+03 -3.556275996500632e+03 9.111045785707079e+02];
gepap2z20p5 = [86.739323484200030 -7.736912046056543e+02 2.855315949637198e+03 -5.578821284450575e+03 6.092161955366911e+03 -3.541811467078343e+03 9.075385096868548e+02];

geSIRevaz20p53 = [48.8501906730652 48.6023641785079 48.3597188951663 48.1220831791111 47.8892541445129 47.6610851579062 47.4373973509954 47.2180647160261 47.0029283765756 46.7918795196934 46.5847760788513 46.3815237199557 46.1819946426203 45.9861068190603 45.7937446605633 45.6048366914203 45.4192778598608 45.2370058138764 45.0579246619984 44.8819800041993 44.7090839691771 44.5391891414311 44.3722147192265 44.2081194683249 44.0468288593092 43.8883071691863 43.7324854688288 43.5793329856230 43.4287858218785 43.2808176847484 43.1353692249004 42.9924182339770 42.8519094998796 42.7138245669657 42.5781120101746 42.4447568488921 42.3137111470005 42.1849631678111 42.0584682110834 41.9342175935655 41.8121696371967 41.6923185575628 41.5746255199519 41.4590875163824 41.3456684079838 41.2343678701651 41.1251523409867 41.0180241134823 40.9129521103084 40.8099412022054 40.7077472501130 40.6063759320273 40.5070141522839 40.4096698277795 40.3143169730845 40.2209660542454 40.1295934174474 40.0402121139471 39.9528008282056 39.8673752585030 39.7839164593555 39.7024428651028 39.6229379586924 39.5454230289155 39.4698840742817 39.3963453886666 39.3247956049622 39.2552622087630 39.1877366217046 39.1222497485408 39.0587959945033 38.9974099578215 38.9380892689622 38.8808725484523 38.8257609483824 38.7727975044813 38.7219872516650 38.6733781098858 38.6269794356328 38.5828445933972 38.5409877937042 38.5014685164217 38.4643064729243 38.4295680643338 38.3972792905398 38.3675144463184 38.3403067828859 38.3157396683665 38.2938547880169 38.2747460235808 38.2584649559444 38.2451177516808 38.2347677063014 38.2275354673225 38.2234983270915 38.2227941621416 38.2255171514878 38.2318258748726 38.2418350953253 38.2557285384459;];
geSIRevaz20p53simpl = [48.7342031548157 48.4853097818814 48.2415798888053 48.0028637755263 47.7689366472697 47.5396731303120 47.3148731657555 47.0944313937122 46.8781683823148 46.6659954184526 46.4577504437373 46.2533587325903 46.0526729941468 45.8556303684306 45.6620962230724 45.4720178548969 45.2852715670317 45.1018134257272 44.9215292499262 44.7443827407912 44.5702680542706 44.3991555929387 44.2309468641445 44.0656181997730 43.9030776294168 43.7433067730202 43.5862194811063 43.4318021275228 43.2799737878102 43.1307251440542 42.9839799885612 42.8397329398199 42.6979120722052 42.5585156309993 42.4214756002263 42.2867935953635 42.1544051908994 42.0243151615953 41.8964623991892 41.7708546666973 41.6474339400297 41.5262108347368 41.4071302133035 41.2902054398461 41.1753840976217 41.0626822243982 40.9520499873381 40.8435060500408 40.7370030534957 40.6325622651024 40.5289226166973 40.4261055601384 40.3252820414590 40.2264764482055 40.1296463873273 40.0348188542912 39.9419537213092 39.8510806461046 39.7621617545501 39.6752294471019 39.5902481163801 39.5072530137951 39.4262108378360 39.3471598291090 39.2700690591477 39.1949799290518 39.1218639814131 39.0507659861088 38.9816600893259 38.9145946799785 38.8495466796773 38.7865683948860 38.7256397398494 38.6668172932123 38.6100842321799 38.5555018281733 38.5030568546003 38.4528157745642 38.4047693662671 38.3589898772476 38.3154725902653 38.2742962435499 38.2354612355841 38.1990536400658 38.1650797197987 38.1336338993356 38.1047292255658 38.0784697013887 38.0548762928058 38.0340640748304 38.0160633410461 38.0010020700735 37.9889216425715 37.9799652053087 37.9741874411951 37.9717494914979 37.9727221552420 37.9772881326902 37.9855379497180 37.9976804133799;];

%% z = 20 km | P0 = 3 mW
gepteoz20p3 = [52.577961058656484 -5.102491165969483e+02 2.051355660157703e+03 -4.369212486183375e+03 5.205005905952417e+03 -3.307585760045602e+03 9.360274184632397e+02];
gepap1z20p3 = [53.165883982050900 -5.149787091927561e+02 2.066303279801424e+03 -4.391295710509104e+03 5.215316147633352e+03 -3.294537961361713e+03 9.186379782008133e+02];
gepap2z20p3 = [50.894784241903070 -4.951369281550554e+02 1.994977629669847e+03 -4.256384371463222e+03 5.073971847992305e+03 -3.215962862136574e+03 9.007327045775481e+02];

geSIRevaz20p33 = [57.0337693161712 56.7752129828891 56.5217545832444 56.2732604762145 56.0294915366136 55.7903379705022 55.5555859111554 55.3251451488976 55.0988229053024 54.8765452319773 54.6581371325704 54.4435382999890 54.2325888682712 54.0252400848253 53.8213450649677 53.6208649333946 53.4236640282541 53.2297119927028 53.0388829364294 52.8511539124762 52.6664075948545 52.4846275366901 52.3057039649887 52.1296261826309 51.9562911170008 51.7856931996012 51.6177353353371 51.4524165688781 51.2896451668159 51.1294243588088 50.9716672463380 50.8163808886713 50.6634827701009 50.5129834854763 50.3648045130847 50.2189597416089 50.0753743085741 49.9340651998323 49.7949609240448 49.6580814069632 49.5233582809809 49.3908142894087 49.2603839768956 49.1320928134446 49.0058780766222 48.8817679011276 48.7597021472894 48.6397115795095 48.5217385176691 48.4058163466674 48.2906723704255 48.1763396918922 48.0639799802969 47.9536297871506 47.8452362817511 47.7388386640457 47.6343863120022 47.5319211415531 47.4313947141981 47.3328517558724 47.2362460108400 47.1416251372273 47.0489450869183 46.9582566029697 46.8695178972818 46.7827829842852 46.6980124185059 46.6152637099523 46.5344998721656 46.4557821778256 46.3790762542949 46.3044474533456 46.2318642153260 46.1613963448949 46.0930153464787 46.0267959188430 45.9627129431257 45.9008465334321 45.8411753340061 45.7837854913583 45.7286598885699 45.6758914374430 45.6254678449123 45.5774896621955 45.5319501400815 45.4889585171305 45.4485144763218 45.4107372073653 45.3756339257458 45.3433353068941 45.3138574687423 45.2873444501158 45.2638229879153 45.2434528015696 45.2262734139628 45.2124631120527 45.2020769643383 45.1953154601157 45.1922527628904 45.1931161945455;];
geSIRevaz20p33simpl = [56.8168897444360 56.5573497842041 56.3028763893825 56.0533952522587 55.8086078560568 55.5684619463022 55.3326861480249 55.1012461908229 54.8738934484409 54.6506084828198 54.4311619182742 54.2155466813172 54.0035498282257 53.7951746993070 53.5902224871360 53.3887053908292 53.1904368510180 52.9954366772613 52.8035289910525 52.6147402042208 52.4289038075936 52.2460519972640 52.0660265274810 51.8888647126973 51.7144156315751 51.5427211739074 51.3736369404365 51.2072089535558 51.0432986466266 50.8819558145756 50.7230471279005 50.5666258628825 50.4125634105583 50.2609162954384 50.1115601792561 49.9645546511537 49.8197792506824 49.6772964908434 49.5369894451637 49.3989234473144 49.2629848035681 49.1292415986080 48.9975831076366 48.8680801271553 48.7406246707150 48.6152902356689 48.4919713732449 48.3707442973983 48.2515059236845 48.1343352242614 48.0179125118024 47.9023148092129 47.7886588621257 47.6770271434325 47.5673208600597 47.4596253653076 47.3538438200440 47.2500645779601 47.1481926762580 47.0483196168062 46.9503522584481 46.8543854289112 46.7603277777715 46.6682776689864 46.5781455372478 46.4900335294040 46.4038538871680 46.3197128277807 46.2375244524790 46.1573993829177 46.0792536670528 46.0032027185475 45.9291646592985 45.8572601448919 45.7874095452934 45.7197392811027 45.6541722002179 45.5908410980340 45.5296715972986 45.4708035815770 45.4141658269687 45.3599061434403 45.3079569392618 45.2584749408159 45.2113967919506 45.1668893116361 45.1248941389594 45.0855895920670 45.0489232628386 45.0150866631475 44.9840345483642 44.9559736822125 44.9308675214626 44.9089406038941 44.8901670532164 44.8747923028605 44.8628036745099 44.8544714029419 44.8497992962666 44.8490873364191;];

%%
figure
plot(FF, polyval(gepteoz20p5,FF), '-k', 'LineWidth', 2), hold on
plot(FF, polyval(gepap1z20p5,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(gepap2z20p5,FF), '-m', 'LineWidth', 2)
plot(FF, geSIRevaz20p53, '*b')
plot(FF, geSIRevaz20p53simpl, 'pg')
% plot(FF, polyval(pteoP3z20,FF), '-k', 'LineWidth', 2)
% plot(FF, polyval(pap1P3z20,FF), '-r', 'LineWidth', 2)
% plot(FF, polyval(pap2P3z20,FF), '-m', 'LineWidth', 2)
% plot(FF, SIReva3P3z20, '*b')
plot(FF, polyval(gepteoz20p3,FF), '-k', 'LineWidth', 2)
plot(FF, polyval(gepap1z20p3,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(gepap2z20p3,FF), '-m', 'LineWidth', 2)
plot(FF, geSIRevaz20p33, '*b')
plot(FF, geSIRevaz20p33simpl, 'pg')
legend('Numérico', 'Log Linear (Numérico)', 'Log Quad (Numérico)', 'Analítico (Ordem 3)', 'Analítico Simplificado (Ordem 3)');
xlabel('Frequência (GHz)', 'FontSize', 14);
ylabel('SIR (dB)', 'FontSize', 14);
set(gca, 'FontSize', 14)
axis([FF(1) FF(end) 35 60])
grid on


%% Comparação pequenos sinais
gepteoz100p3 = [-13.660175277844465 1.500497450909142e+02 -6.465084706319471e+02 1.415734874033702e+03 -1.663373838823665e+03 9.783257942297216e+02 -1.869594981905313e+02];
gepap1z100p3 = [-14.126046499915061 1.543520886115292e+02 -6.631976956610895e+02 1.451061129141419e+03 -1.707122109964414e+03 1.007825171625348e+03 -1.946915474287711e+02];
gepap2z100p3 = [-14.367345877626459 1.568740710969734e+02 -6.739512848595380e+02 1.475092652065992e+03 -1.737036402976625e+03 1.028017188990533e+03 -1.994665863419725e+02];
gepsiz100p3 = [-42.159356460459960 3.057423740497513e+02 -8.355141140334847e+02 9.963820489776264e+02 -3.343735508839442e+02 -2.670078558460509e+02 1.704270631227635e+02];

geSIRevaz100p33 = [32.8557056614510 32.6398940567146 32.4289223669098 32.2226656022399 32.0208720087153 31.8234408883044 31.6301459587175 31.4409065364897 31.2555175973814 31.0739151366006 30.8959120419925 30.7214583558845 30.5503821899253 30.3826455364609 30.2180895479067 30.0566864803346 29.8982887368507 29.7428774705384 29.5903148542574 29.4405898228115 29.2935730836736 29.1492604380026 29.0075300901323 28.8683839528267 28.7317068495392 28.5975061802182 28.4656726405768 28.3362186001293 28.2090399879742 28.0841537139736 27.9614603915878 27.8409811157294 27.7226207105924 27.6064041633212 27.4922400990229 27.3801571576701 27.2700674099417 27.1620029554709 27.0558790021201 26.9517309565822 26.8494768963942 26.7491554188369 26.6506872396014 26.5541140627954 26.4593590428281 26.3664669370255 26.2753631680862 26.1860955212870 26.0985915438366 26.0129020508876 25.9277369316916 25.8431463866665 25.7602785869766 25.6791883057384 25.5998067858089 25.5221918759704 25.4462766210414 25.3721220288786 25.2996628977706 25.2289635062363 25.1599603808176 25.0927212123078 25.0271842546282 24.9634207850288 24.9013708099919 24.8411094033221 24.7825783777487 24.7258568539239 24.6708885363285 24.6177568883416 24.5664076278699 24.5169289092294 24.4692686272193 24.4235200360352 24.3796334198312 24.3377076128342 24.2976955592040 24.2597022376453 24.2236835929000 24.1897514133041 24.1578650696999 24.1281439466105 24.1005513707345 24.0752152570093 24.0521035469183 24.0313538013055 24.0129393969937 23.9970088808242 23.9835420897179 23.9727001776320 23.9644707269341 23.9590294750976 23.9563733713197 23.9566951671139 23.9600032380304 23.9665103675076 23.9762389950663 23.9894257234172 24.0061104662935 24.0265584551857;];
geSIRevaz100p34 = [32.8279740016706 32.6130205234416 32.4028564413682 32.1973927416153 31.9963460262966 31.7996511066620 31.6070503046417 31.4184967327164 31.2337549595227 31.0527938991491 30.8753956225060 30.7015430269809 30.5310337190784 30.3638611347540 30.1998369561321 30.0389642538728 29.8810655530278 29.7261529713042 29.5740591220617 29.4248026321740 29.2782257050874 29.1343533327186 28.9930347805728 28.8543014287937 28.7180094768243 28.5841945722529 28.4527198672947 28.3236255412490 28.1967795107284 28.0722268525954 27.9498404827836 27.8296684424979 27.7115889777387 27.5956536076033 27.4817421194443 27.3699127004288 27.2600488959053 27.1522102706028 27.0462846422365 26.9423345036711 26.8402499633367 26.7400971924415 26.6417692347318 26.5453340778257 26.4506884063844 26.3579028591827 26.2668757706514 26.1776813214152 26.0902202882741 26.0045684901658 25.9194126698894 25.8348254912074 25.7519276143386 25.6707988558545 25.5913436781811 25.5136444103324 25.4376097537243 25.3633225867175 25.2906937230060 25.2198108593636 25.1505848082120 25.0831060181236 25.0172896740094 24.9532269172773 24.8908350846510 24.8302107208855 24.7712710929119 24.7141159886773 24.6586674573677 24.6050263670218 24.5531172233659 24.5030472276461 24.4547410039139 24.4083098377683 24.3636839167845 24.3209763532071 24.2801204749551 24.2412371684604 24.2042604611159 24.1693167102271 24.1363468587775 24.1054804288110 24.0766628048142 24.0500335560167 24.0255400286006 24.0033295797981 23.9833587980333 23.9657806034828 23.9505584388844 23.9378590172373 23.9276503002579 23.9201108296867 23.9152219626915 23.9131722591193 23.9139545337142 23.9177777277344 23.9246444162922 23.9347828956702 23.9482170588496 23.9651940378230;];
geSIRevaz100p33simpl = [32.4371814616684 32.2175218684939 32.0026768063819 31.7925741783826 31.5869106078720 31.3856363034630 31.1884753812081 30.9953962655733 30.8061461410634 30.6207084765601 30.4388499984636 30.2605667334688 30.0856421053004 29.9140827297520 29.7456864084687 29.5804687743207 29.4182400969217 29.2590237617045 29.1026409192100 28.9491216839838 28.7982967578368 28.6502021519835 28.5046769970512 28.3617625213895 28.2213053303629 28.0833513135754 27.9477537350924 27.8145626908977 27.6836374018653 27.5550317988395 27.4286104527766 27.3044308273874 27.1823623169781 27.0624656747774 26.9446146595019 26.8288731206226 26.7151187802649 26.6034184341894 26.4936534168818 26.3858933584755 26.2800228982433 26.1761144227123 26.0740556066014 25.9739215456755 25.8756027147669 25.7791769002656 25.6845371724328 25.5917640166552 25.5007529219667 25.4115871071946 25.3229454785254 25.2349091723800 25.1485936123673 25.0640854484538 24.9812846200033 24.9002806097990 24.8209753627625 24.7434613079354 24.6676423181496 24.5936139099503 24.5212818299716 24.4507448533497 24.3819105708253 24.3148812197972 24.2495662313445 24.1860715449284 24.1243084563709 24.0643868876120 24.0062200548908 23.9499221892706 23.8954085184750 23.8427979625420 23.7920078925131 23.7431623591211 23.6961810562523 23.6511936796849 23.6081224822571 23.5671034051790 23.5280615643194 23.4911398495180 23.4562666263429 23.4235925603868 23.3930497550122 23.3647976293666 23.3387726385263 23.3151441178373 23.2938536456499 23.2750818650014 23.2587764485375 23.2451310245629 23.2341005859699 23.2258937852187 23.2204744906563 23.2180688791262 23.2186516796256 23.2224696896480 23.2295110522610 23.2400470618351 23.2540825895196 23.2719183377356;];

figure
plot(FF, polyval(gepteoz100p5,FF), '-k', 'LineWidth', 2), hold on
plot(FF, polyval(gepap1z100p5,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(gepap2z100p5,FF), '-m', 'LineWidth', 2)
plot(FF, polyval(gepsiz100p3,FF), '-g', 'LineWidth', 2)
plot(FF, geSIRevaz100p53, '*b')
% plot(FF, polyval(pteoP3z20,FF), '-k', 'LineWidth', 2)
% plot(FF, polyval(pap1P3z20,FF), '-r', 'LineWidth', 2)
% plot(FF, polyval(pap2P3z20,FF), '-m', 'LineWidth', 2)
% plot(FF, SIReva3P3z20, '*b')
legend('Numérico', 'Log Linear (Numérico)', 'Log Quad (Numérico)', 'Pequenos Sinais', 'Analítico (Ordem 3)');
xlabel('Frequência (GHz)', 'FontSize', 14);
ylabel('SIR (dB)', 'FontSize', 14);
set(gca, 'FontSize', 14)
axis([FF(1) FF(end) 5 35])
grid on

%% UWB
FF = [3.11000000000000 3.11500000000000 3.12000000000000 3.12500000000000 3.13000000000000 3.13500000000000 3.14000000000000 3.14500000000000 3.15000000000000 3.15500000000000 3.16000000000000 3.16500000000000 3.17000000000000 3.17500000000000 3.18000000000000 3.18500000000000 3.19000000000000 3.19500000000000 3.20000000000000 3.20500000000000 3.21000000000000 3.21500000000000 3.22000000000000 3.22500000000000 3.23000000000000 3.23500000000000 3.24000000000000 3.24500000000000 3.25000000000000 3.25500000000000 3.26000000000000 3.26500000000000 3.27000000000000 3.27500000000000 3.28000000000000 3.28500000000000 3.29000000000000 3.29500000000000 3.30000000000000 3.30500000000000 3.31000000000000 3.31500000000000 3.32000000000000 3.32500000000000 3.33000000000000 3.33500000000000 3.34000000000000 3.34500000000000 3.35000000000000 3.35500000000000 3.36000000000000 3.36500000000000 3.37000000000000 3.37500000000000 3.38000000000000 3.38500000000000 3.39000000000000 3.39500000000000 3.40000000000000 3.40500000000000 3.41000000000000 3.41500000000000 3.42000000000000 3.42500000000000 3.43000000000000 3.43500000000000 3.44000000000000 3.44500000000000 3.45000000000000 3.45500000000000 3.46000000000000 3.46500000000000 3.47000000000000 3.47500000000000 3.48000000000000 3.48500000000000 3.49000000000000 3.49500000000000 3.50000000000000 3.50500000000000 3.51000000000000 3.51500000000000 3.52000000000000 3.52500000000000 3.53000000000000 3.53500000000000 3.54000000000000 3.54500000000000 3.55000000000000 3.55500000000000 3.56000000000000 3.56500000000000 3.57000000000000 3.57500000000000 3.58000000000000 3.58500000000000 3.59000000000000 3.59500000000000 3.60000000000000 3.60500000000000 3.61000000000000 3.61500000000000 3.62000000000000 3.62500000000000 3.63000000000000 3.63500000000000 3.64000000000000 3.64500000000000 3.65000000000000 3.65500000000000 3.66000000000000 3.66500000000000 3.67000000000000 3.67500000000000 3.68000000000000 3.68500000000000 3.69000000000000 3.69500000000000 3.70000000000000 3.70500000000000 3.71000000000000 3.71500000000000 3.72000000000000 3.72500000000000 3.73000000000000 3.73500000000000 3.74000000000000 3.74500000000000;];
%% z = 100 km | P0 = 5 mW
uwbpteoz100p5 = [1.218199508899793e+03 -2.542290431731279e+04 2.208805386780018e+05 -1.022635799494794e+06 2.660958964506907e+06 -3.689666501796159e+06 2.129925227815140e+06];
uwbpap1z100p5 = [1.208329837189090e+03 -2.522565625702047e+04 2.192393077226404e+05 -1.015358150973886e+06 2.642820177540542e+06 -3.665572900055791e+06 2.116600076064222e+06];
uwbpap2z100p5 = [1.201457575796499e+03 -2.507583027808745e+04 2.178855545557768e+05 -1.008865771649719e+06 2.625382086627486e+06 -3.640692171743440e+06 2.101863069938663e+06];
                
uwbSIRevaz100p53 = [7.72860594853458 7.63655069546038 7.54662162647230 7.45874082050184 7.37283558729359 7.28883696451536 7.20668109223046 7.12630661906775 7.04765727000258 6.97067819943464 6.89531969102848 6.82153249197902 6.74927259311373 6.67849557508380 6.60916242478315 6.54123292078369 6.47467244873563 6.40944445011676 6.34551820491259 6.28286036469124 6.22144367571858 6.16123761450425 6.10221802874218 6.04435689079269 5.98763283756772 5.93202005490696 5.87749970084544 5.82404793149236 5.77164819509986 5.72027840784342 5.66992410881707 5.62056479202991 5.57218791492823 5.52477439094784 5.47831344645281 5.43278727630031 5.38818674621917 5.34449521204279 5.30170506655863 5.25980072132433 5.21877599892875 5.17861627462029 5.13931671674512 5.10086358377269 5.06325331744247 5.02647298915261 4.99052025206725 4.95538292923632 4.92105983260357 4.88753948363425 4.85482180883791 4.82289598208553 4.79176300793067 4.76141267319055 4.73184703102623 4.70305644773307 4.67504400223980 4.64780061238971 4.62133036624863 4.59562471045282 4.57068873149092 4.54651438693497 4.52310775669034 4.50046129610355 4.47784862198927 4.45526255562829 4.43344397833808 4.41238559695787 4.39209575884081 4.37256765533668 4.35381064819715 4.33581841365070 4.31860134546563 4.30215360971192 4.28648665563795 4.27159514886117 4.25749162367960 4.24417125992933 4.23164771298038 4.21991669682852 4.20899303083508 4.19887298875902 4.18957260431827 4.18108874279554 4.17343871074713 4.16662000350478 4.16065126786814 4.15553067524904 4.15127828998577 4.14789301400025 4.14539641750698 4.14378819684305 4.14309152885047 4.14330697895132 4.14445944541114 4.14655044971993 4.14960674234968 4.15363090201130 4.15865168046950 4.16467283121351 4.17172527745892 4.17981408412832 4.18897254044051 4.19920718175927 4.21055388625335 4.22302084504179 4.23664678142016 4.25144175870160 4.26744764059195 4.28467661606422 4.30317403080117 4.32295449719645 4.34406723957391 4.36652964480369 4.39039527850517 4.41568471759129 4.44245641117049 4.47073462034284 4.50058331641234 4.53203103516146 4.56514802673429 4.59996781107012 4.63656781900133 4.67498741212694 4.71531228402490 4.75758868111269 4.80191186734725 4.84833625199306;];

%% z = 100 km | P0 = 3 mW
uwbpteoz100p3 = [4.741471355580851e+02 -9.656317383821377e+03 8.190622618922123e+04 -3.703825243266390e+05 9.417921864829990e+05 -1.276837253893318e+06 7.211564619285564e+05];
uwbpap1z100p3 = [4.314242078150367e+02 -8.768616835030414e+03 7.422740477708263e+04 -3.349862598790540e+05 8.500896946099133e+05 -1.150234400472272e+06 6.483890185478855e+05];
uwbpap2z100p3 = [4.721345166270249e+02 -9.615930828899003e+03 8.156892976121533e+04 -3.688818331147245e+05 9.380408751851767e+05 -1.271842623505204e+06 7.183907357700015e+05];

uwbSIRevaz100p33 = [14.9528484022244 14.8635526822311 14.7763498339461 14.6912263902411 14.6080457700355 14.5268018279245 14.4473684225997 14.3697455274743 14.2938160502387 14.2195851078280 14.1469435009479 14.0759006940911 14.0063544129815 13.9383178162126 13.8716947383430 13.8065014927604 13.7426473302632 13.6801512718462 13.6189273933222 13.5589970509675 13.5002786381167 13.4427955352435 13.3864700153368 13.3313272223991 13.2772929294662 13.2243938251556 13.1725588519836 13.1218160590544 13.0720972693159 13.0234317373758 12.9757539129057 12.9290941255925 12.8833892283673 12.8386705163831 12.7948770483814 12.7520409931082 12.7101034401568 12.6690973552052 12.6289657032832 12.5897421834666 12.5513714978728 12.5138880268458 12.4772380862228 12.4414566954666 12.4064916739863 12.3723786470169 12.3390668391219 12.3065924557942 12.2749060388026 12.2440443554209 12.2139591860751 12.1846878477305 12.1561832894222 12.1284833715851 12.1015421495550 12.0753980264722 12.0500061087705 12.0254053466756 12.0015518490985 11.9784851226492 11.9561622362491 11.9346232669669 11.9138262070843 11.8938117229063 11.8738041076949 11.8538429715613 11.8346215007424 11.8161808438204 11.7984808910805 11.7815634268464 11.7653891867570 11.7500006238880 11.7353593041996 11.7215083876240 11.7084102606773 11.6961088336364 11.6845673091942 11.6738303972106 11.6638621177666 11.6547080357504 11.6463329957198 11.6387834798000 11.6320251703773 11.6261055364522 11.6209911183487 11.6167304498048 11.6132909565653 11.6107223241343 11.6089928992944 11.6081536166244 11.6081737886215 11.6091057078445 11.6109197073652 11.6136695597811 11.6173266851366 11.6219464731236 11.6275015103329 11.6340489577904 11.6415626633562 11.6501017334188 11.6596413893659 11.6702428798745 11.6818829325439 11.6946251618908 11.7084479583463 11.7234175569331 11.7395141957490 11.7568070215368 11.7752783383504 11.7950005390216 11.8159582517495 11.8382275010611 11.8617955453602 11.8867424876573 11.9130585804047 11.9408285253853 11.9700460031370 12.0008009233658 12.0330909145636 12.0670118116736 12.1025658166929 12.1398555397211 12.1788885128986 12.2197751352253 12.2625291894937 12.3072700814153 12.3540189715196 12.4029057464935;];

%% z = 20 km | P0 = 5 mW
uwbpteoz20p5 = [-1.158771570711295e+03 2.371405888148328e+04 -2.019715078497862e+05 9.163415647124500e+05 -2.335746727345760e+06 3.171482356569864e+06 -1.791996326633029e+06];
uwbpap1z20p5 = [-1.158750323449719e+03 2.371442383207758e+04 -2.019816042896994e+05 9.164199685542268e+05 -2.336032318986973e+06 3.171990544517485e+06 -1.792353730713606e+06];
uwbpap2z20p5 = [-1.166432283661422e+03 2.387263042877723e+04 -2.033378401224597e+05 9.226145469437966e+05 -2.351931637287938e+06 3.193733614824629e+06 -1.804729614350384e+06];
                
uwbSIRevaz20p53 = [29.7527559972668 29.6649380146958 29.5792392729418 29.4956052176397 29.4139397937008 29.3341970860768 29.2562901842637 29.1801805050149 29.1057889963319 29.0330833380550 28.9619912737955 28.8924858667386 28.8245007712905 28.7580137050934 28.6929634918415 28.6293318961529 28.5670622857472 28.5061399631909 28.4465123099602 28.3881677379571 28.3310571903178 28.2751718257912 28.2204657618328 28.1669325962751 28.1145292875287 28.0632516103164 28.0130590759016 27.9639494118774 27.9158844324276 27.8688636261562 27.8228508926037 27.7778473167753 27.7338186936006 27.6907675630946 27.6486614492596 27.6075042256256 27.5672649993277 27.5279488730633 27.4895264088081 27.4520038489459 27.4153530973667 27.3795814596293 27.3446620820637 27.3106032682816 27.2773793194238 27.2449994821053 27.2134391351410 27.1827084220760 27.1527837316176 27.1236760662339 27.0953627651424 27.0678556590419 27.0411329858772 27.0152073805840 26.9900579349844 26.9656980704599 26.9421076942434 26.9193010021798 26.8972586843842 26.8759957046923 26.8554935091557 26.8357678284239 26.8168008428535 26.7986090538908 26.7804414200126 26.7623143039116 26.7449443265463 26.7283488003575 26.7125112915344 26.6974499051811 26.6831489056296 26.6696272100020 26.6568697791429 26.6448963668839 26.6336926340179 26.6232792013494 26.6136424382923 26.6048038687742 26.5967505849944 26.5895050564445 26.5830551181044 26.5774242342652 26.5726010089523 26.5686099578982 26.5654404872556 26.5631182289868 26.5616334319438 26.5610129181385 26.5612478280013 26.5623662574994 26.5643602968160 26.5672594111183 26.5710567090004 26.5757831329027 26.5814328903975 26.5880385238712 26.5955954340647 26.6041379026900 26.6136626335282 26.6242058062218 26.6357655556235 26.6483801401486 26.6620492749051 26.6768135037841 26.6926742961094 26.7096747181811 26.7278181966859 26.7471505927944 26.7676775282761 26.7894479736162 26.8124700245730 26.8367961252813 26.8624371737440 26.8894495117167 26.9178472271897 26.9476910552322 26.9789987337218 27.0118359735488 27.0462247104770 27.0822363195257 27.1198975906557 27.1592863811937 27.2004351257516 27.2434291427928 27.2883074694740 27.3351640645920 27.3840457365061 27.4350565156656;];

%% z = 100 km | P0 = 3 mW
uwbpteoz20p3 = [8.596965438254934e+02 -1.776174324600213e+04 1.528178439462943e+05 -7.008400496100642e+05 1.806951415175270e+06 -2.483363827077768e+06 1.421392457895402e+06];
uwbpap1z20p3 = [8.521274887986519e+02 -1.761199095226617e+04 1.515865914303609e+05 -6.954559483089745e+05 1.793746354914285e+06 -2.466142886370929e+06 1.412062506098594e+06];
uwbpap2z20p3 = [8.980258932882409e+02 -1.854367095434691e+04 1.594578275539581e+05 -7.308828892746144e+05 1.883336250896611e+06 -2.586836425652860e+06 1.479734614914380e+06];

uwbSIRevaz20p33 = [35.1042388189488 35.0125203102234 34.9229265126607 34.8354286775041 34.7499052046139 34.6663352662531 34.5846071165974 34.5047066028533 34.4265304850112 34.3500702715861 34.2752301098572 34.2020063395051 34.1303095604341 34.0601402594567 33.9914147026973 33.9241369573508 33.8582282898618 33.7936958759188 33.7304654150675 33.6685467968707 33.6078696681326 33.5484463010367 33.4902098713539 33.4331747549333 33.3772772946432 33.3225337344744 33.2688832699331 33.2163438139093 33.1648571401491 33.1144426616871 33.0650444901466 33.0166833957203 32.9693056166149 32.9229331590994 32.8775142016232 32.8330718841812 32.7895561606540 32.7469912185261 32.7053286409647 32.6645935906603 32.6247391501881 32.5857913973226 32.5477047984145 32.5105062968788 32.4741516397526 32.4386685960958 32.4040141016469 32.3702167195478 32.3372344921406 32.3050967526823 32.2737625768801 32.2432620510517 32.2135552190217 32.1846729094756 32.1565760763702 32.1292962859901 32.1027953510932 32.0771055763828 32.0521895882383 32.0280804359463 32.0047415200719 31.9822066458331 31.9604399539670 31.9394760220707 31.9185450563544 31.8976809280559 31.8775827098437 31.8582858137850 31.8397557229018 31.8220286670014 31.8050707944306 31.7889191846161 31.7735406371297 31.7589731183637 31.7451840699239 31.7322123882686 31.7200261528747 31.7086652394919 31.6980983665325 31.6883664448490 31.6794388383639 31.6713575559933 31.6640926196330 31.6576872070502 31.6521120169482 31.6474114753673 31.6435569836281 31.6405943050599 31.6384955771281 31.6373080001956 31.6370044900254 31.6376337958283 31.6391696635411 31.6416625166938 31.6450869943253 31.6494953352905 31.6548631473154 31.6612446433482 31.6686164899809 31.6770350534378 31.6864781662926 31.6970045508072 31.7085933324299 31.7213058195937 31.7351225807449 31.7501077725574 31.7662435840433 31.7835973196447 31.8021529991149 31.8219814183597 31.8430686770160 31.8654894585204 31.8892322383717 31.9143760460666 31.9409120855788 31.9689242659440 31.9984069411337 32.0294495237169 32.0620500235787 32.0963040908769 32.1322140013903 32.1698825117213 32.2093169027816 32.2506280728535 32.2938292090222 32.3390405935516 32.3862824249639 32.4356858718096;];

%%
figure
plot(FF, polyval(uwbpteoz20p3,FF), '-k', 'LineWidth', 2), hold on
plot(FF, polyval(uwbpap1z20p3,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(uwbpap2z20p3,FF), '-m', 'LineWidth', 2)
plot(FF, uwbSIRevaz20p53, '*b')
% plot(FF, polyval(pteoP3z20,FF), '-k', 'LineWidth', 2)
% plot(FF, polyval(pap1P3z20,FF), '-r', 'LineWidth', 2)
% plot(FF, polyval(pap2P3z20,FF), '-m', 'LineWidth', 2)
% plot(FF, SIReva3P3z20, '*b')
plot(FF, polyval(uwbpteoz20p5,FF), '-k', 'LineWidth', 2)
plot(FF, polyval(uwbpap1z20p5,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(uwbpap2z20p5,FF), '-m', 'LineWidth', 2)
plot(FF, uwbSIRevaz20p33, '*b')
legend('Numérico', 'Log Linear (Numérico)', 'Log Quad (Numérico)', 'Analítico (Ordem 3)');
xlabel('Frequência (GHz)', 'FontSize', 14);
ylabel('SIR (dB)', 'FontSize', 14);
set(gca, 'FontSize', 14)
% axis([FF(1) FF(end) 35 60])
grid on

figure
plot(FF, polyval(uwbpteoz100p3,FF), '-k', 'LineWidth', 2), hold on
plot(FF, polyval(uwbpap1z100p3,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(uwbpap2z100p3,FF), '-m', 'LineWidth', 2)
plot(FF, uwbSIRevaz100p53, '*b')
% plot(FF, polyval(pteoP3z20,FF), '-k', 'LineWidth', 2)
% plot(FF, polyval(pap1P3z20,FF), '-r', 'LineWidth', 2)
% plot(FF, polyval(pap2P3z20,FF), '-m', 'LineWidth', 2)
% plot(FF, SIReva3P3z20, '*b')
plot(FF, polyval(uwbpteoz100p5,FF), '-k', 'LineWidth', 2)
plot(FF, polyval(uwbpap1z100p5,FF), '-r', 'LineWidth', 2)
plot(FF, polyval(uwbpap2z100p5,FF), '-m', 'LineWidth', 2)
plot(FF, uwbSIRevaz100p33, '*b')
legend('Numérico', 'Log Linear (Numérico)', 'Log Quad (Numérico)', 'Analítico (Ordem 3)');
xlabel('Frequência (GHz)', 'FontSize', 14);
ylabel('SIR (dB)', 'FontSize', 14);
set(gca, 'FontSize', 14)
% axis([FF(1) FF(end) 35 60])
grid on

