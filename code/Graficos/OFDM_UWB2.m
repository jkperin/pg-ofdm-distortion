clear, close all

%% OFDM UWB
addpath('PGresultados')
load resultados_UWB

%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
FF = [4.75200000000000 4.75612500000000 4.76025000000000 4.76437500000000 4.76850000000000 4.77262500000000 4.77675000000000 4.78087500000000 4.78500000000000 4.78912500000000 4.79325000000000 4.79737500000000 4.80150000000000 4.80562500000000 4.80975000000000 4.81387500000000 4.81800000000000 4.82212500000000 4.82625000000000 4.83037500000000 4.83450000000000 4.83862500000000 4.84275000000000 4.84687500000000 4.85100000000000 4.85512500000000 4.85925000000000 4.86337500000000 4.86750000000000 4.87162500000000 4.87575000000000 4.87987500000000 4.88400000000000 4.88812500000000 4.89225000000000 4.89637500000000 4.90050000000000 4.90462500000000 4.90875000000000 4.91287500000000 4.91700000000000 4.92112500000000 4.92525000000000 4.92937500000000 4.93350000000000 4.93762500000000 4.94175000000000 4.94587500000000 4.95000000000000 4.95412500000000 4.95825000000000 4.96237500000000 4.96650000000000 4.97062500000000 4.97475000000000 4.97887500000000 4.98300000000000 4.98712500000000 4.99125000000000 4.99537500000000 4.99950000000000 5.00362500000000 5.00775000000000 5.01187500000000 5.01600000000000 5.02012500000000 5.02425000000000 5.02837500000000 5.03250000000000 5.03662500000000 5.04075000000000 5.04487500000000 5.04900000000000 5.05312500000000 5.05725000000000 5.06137500000000 5.06550000000000 5.06962500000000 5.07375000000000 5.07787500000000 5.08200000000000 5.08612500000000 5.09025000000000 5.09437500000000 5.09850000000000 5.10262500000000 5.10675000000000 5.11087500000000 5.11500000000000 5.11912500000000 5.12325000000000 5.12737500000000 5.13150000000000 5.13562500000000 5.13975000000000 5.14387500000000 5.14800000000000 5.15212500000000 5.15625000000000 5.16037500000000 5.16450000000000 5.16862500000000 5.17275000000000 5.17687500000000 5.18100000000000 5.18512500000000 5.18925000000000 5.19337500000000 5.19750000000000 5.20162500000000 5.20575000000000 5.20987500000000 5.21400000000000 5.21812500000000 5.22225000000000 5.22637500000000 5.23050000000000 5.23462500000000 5.23875000000000 5.24287500000000 5.24700000000000 5.25112500000000 5.25525000000000 5.25937500000000 5.26350000000000 5.26762500000000 5.27175000000000 5.27587500000000];

% for k= 1:12
%     pteo = polyfit(FF, resultados(k).SIRteo, 4);
%     figure, plot(FF, polyval(pteo, FF), 'k', FF, resultados(k).SIRteo, '*r')
% end

% L = 100.00km, P0 = 5.00mW, mIM = 2.00%, Nit = 1000, kappa = 15.00
% L = 100.00km, P0 = 4.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
% L = 100.00km, P0 = 1.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00

maxkP.pteo = [39.346974606499760 -7.970168611378933e+02 6.071696036343857e+03 -2.061743136716101e+04 2.632870601442186e+04]; %polyfit(FF, resultados(7).SIRteo, 4);
medkP.pteo = [93.076705746561900 -1.879610863094798e+03 1.425123684877305e+04 -4.808181045352555e+04 6.091416567426742e+04]; %polyfit(FF, resultados(8).SIRteo, 4);
% minkP.pteo = polyfit(FF, resultados(9).SIRteo, 4);

maxkP.pap1 = [38.560058320136070 -7.811596995927262e+02 5.951797257608650e+03 -2.021425747933119e+04 2.581979046936099e+04]; %polyfit(FF, resultados(7).SIRap1, 4);
medkP.pap1 = [91.850489856017800 -1.855030233854141e+03 1.406644168163449e+04 -4.746442159233228e+04 6.014100481685370e+04]; %polyfit(FF, resultados(8).SIRap1, 4);
% minkP.pap1 = polyfit(FF, resultados(9).SIRap1, 4);

maxkP.pap2 = [39.492124425014580 -7.999702739550092e+02 6.094292736418513e+03 -2.069448070759085e+04 2.642758402725629e+04]; %polyfit(FF, resultados(7).SIRap2, 4);
medkP.pap2 = [92.513154246833170 -1.868448480274094e+03 1.416838070472970e+04 -4.780877859432934e+04 6.057769464657830e+04]; %polyfit(FF, resultados(8).SIRap2, 4);
% minkP.pap2 = polyfit(FF, resultados(9).SIRap2, 4);

maxkP.SIReva3 = resultados(7).SIReva;
% maxkP.SIReva4 = [2.12979860768858 2.05193908677742 1.97623018442536 1.90249055328205 1.83074996027192 1.76083864645206 1.69279266321143 1.62645225700112 1.56185874684650 1.49886106886243 1.43750498792612 1.37764702746855 1.31933673050755 1.26243727731005 1.20700144403912 1.15289827688994 1.10018333867229 1.04873086481719 0.998598837917784 0.949666100083196 0.901992751657384 0.855461736972508 0.810135025221263 0.765899223709828 0.722817965398816 0.680781136078460 0.639853863767426 0.599928974489635 0.561072952987421 0.523181266516544 0.486321643737654 0.450391927613687 0.415460999511639 0.381428841264944 0.348365414121479 0.316172626640735 0.284921462892259 0.254515567359259 0.225026903495186 0.196360679426116 0.168589806415042 0.141620900086243 0.115527798362263 0.0902183823327194 0.0657674046772252 0.0420838823055494 0.0192434790433069 -0.00284377110982695 -0.0241012892745650 -0.0446181334370557 -0.0643167988528226 -0.0832855359959484 -0.101445897022417 -0.118885417750203 -0.135524683941502 -0.151450602763543 -0.166582764490261 -0.181007527474253 -0.194643451772583 -0.207576421171028 -0.219723925227870 -0.231171442313542 -0.241835345653164 -0.251800772669207 -0.261714894901088 -0.271660194726605 -0.280818521319068 -0.289275155620182 -0.296943582486731 -0.303908851780785 -0.310083151191040 -0.315551351969678 -0.320224274122340 -0.324186658974987 -0.327347881531765 -0.329792598168888 -0.331428654280160 -0.332340662573354 -0.332434846347500 -0.331795812171757 -0.330328060195417 -0.328116224495232 -0.325062971627838 -0.321252992725661 -0.316586999964209 -0.311149766673412 -0.304839918395266 -0.297742330977806 -0.289753398308574 -0.280958113713020 -0.271250480112272 -0.260715617220374 -0.249244961610320 -0.236923761386121 -0.223640693238505 -0.209481127680118 -0.194330767389375 -0.178275089995142 -0.161196586559847 -0.143180815584460 -0.124106792038208 -0.104060116072892 -0.0829160311798810 -0.0607601244620787 -0.0374635368333398 -0.0131117690745499 0.0124285130496160 0.0390719907662447 0.0669568944333536 0.0959982101644674 0.126339542204969 0.157896337598770 0.190818119251431 0.225020991847886 0.260661021256541 0.297655216650622 0.336166906146561 0.376114312414507 0.417668859297223 0.460750369500001 0.505539334331231 0.551957660381055 0.600196046831878 0.650179090978099 0.702109047719580 0.755913968405777 0.811809268832325 0.869727418589193];
maxkP.SIReva5 = [1.13233611710413 1.04562407905996 0.961370127729612 0.879404135381009 0.799706198231872 0.722119995114698 0.646635851740071 0.573109118704813 0.501537982789516 0.431788516111549 0.363865482005351 0.297643494517064 0.233133614313083 0.170217803882568 0.108911851846556 0.0491048077420305 -0.00918351334010466 -0.0660585120321959 -0.121496210984818 -0.175597178095546 -0.228334429642099 -0.279803617446593 -0.329975154798918 -0.378940960950656 -0.426668504710464 -0.473246430340975 -0.518640186644917 -0.562934876498141 -0.606094169259157 -0.648200601462642 -0.689215614564153 -0.729219486329200 -0.768172216660754 -0.806151456119644 -0.843115909486663 -0.879141445605478 -0.914184967500000 -0.948320778843064 -0.981504680339803 -1.01380898257740 -1.04518847300624 -1.07571423087439 -1.10533949021127 -1.13413415719518 -1.16205025490590 -1.18915615822960 -1.21540343612031 -1.24085963287676 -1.26547489544303 -1.28931605902703 -1.31233245233801 -1.33458971325607 -1.35603637923212 -1.37673756001192 -1.39664042476280 -1.41580965129850 -1.43419161730124 -1.45185006318280 -1.46873058338938 -1.48489662570390 -1.50029241027148 -1.51498117096171 -1.52890631126863 -1.54213033160399 -1.55512753506774 -1.56795702163393 -1.58002691741463 -1.59139928426559 -1.60201415564772 -1.61193297650441 -1.62109488546381 -1.62956132927533 -1.63726992753091 -1.64428218355693 -1.65053472846371 -1.65608857440363 -1.66087932689351 -1.66496812123030 -1.66828889176580 -1.67090294348644 -1.67274306006645 -1.67387015254833 -1.67421580000902 -1.67384113350875 -1.67267585432396 -1.67078135220129 -1.66808634941383 -1.66465191385326 -1.66040503795889 -1.65540698526627 -1.64958259804117 -1.64299346183039 -1.63556276720110 -1.62735181314543 -1.61828203646302 -1.60841507015700 -1.59766983980830 -1.58610833019349 -1.57364743710073 -1.56034885495232 -1.54612730976535 -1.53104482971398 -1.51501314843230 -1.49809462767587 -1.48019846339817 -1.46138666263224 -1.44156568908567 -1.42079781853717 -1.39898586947360 -1.37619235710401 -1.35231686505248 -1.32742139356579 -1.30140201506427 -1.27432082670888 -1.24606934735911 -1.21670969189760 -1.18612915978403 -1.15438903006702 -1.12137197877517 -1.08713902510075 -1.05156698626575 -1.01471645339542 -0.976458584215280 -0.936852530843738 -0.895763178566592 -0.853248728710422 -0.809166255582143 -0.763572675702971;];
maxkP.SIRevaCTD3 = [2.42160333243329 2.34277055256550 2.26608923353832 2.19137808060839 2.11866681156852 2.04778570307199 1.97877077264670 1.91146228648780 1.84590154417250 1.78193748671590 1.71961587319363 1.65879321797494 1.59951907123718 1.54165659099794 1.48525857292727 1.43019402846540 1.37651855172704 1.32410633148541 1.27301539294397 1.22312452018442 1.17449386702528 1.12700630887455 1.08072387886835 1.03553310491130 0.991497694022774 0.948507442486057 0.906627562177606 0.865750779838876 0.825943673587253 0.787101601912135 0.749292396116011 0.712413781168979 0.676534750124736 0.641555157823772 0.607545086050198 0.574406307568021 0.542209935661864 0.510859470388422 0.480427012947095 0.450817618553471 0.422104344621013 0.394193645504024 0.367159513573729 0.340909660393436 0.315519001302571 0.290896375511259 0.267117617647228 0.244092575901166 0.221898008045376 0.200444662221055 0.179810230121977 0.159906259365890 0.140811392784132 0.122437884625946 0.104865352152367 0.0880066702328795 0.0719424596663078 0.0565861360838196 0.0420193585797023 0.0281560092604443 0.0150788258422472 0.00270208770027840 -0.00889034293273183 -0.0197838539518815 -0.0306253621566447 -0.0414976002802756 -0.0515821732062181 -0.0609646282304098 -0.0695581892799264 -0.0774481809030170 -0.0845465214442298 -0.0909383652997275 -0.0965342545799981 -0.101419222356921 -0.105502357034356 -0.108868615498814 -0.111425547666128 -0.113258075700953 -0.114272118354598 -0.114552600802374 -0.114003709363593 -0.112710406094796 -0.110575034206073 -0.107682622430705 -0.103933549823902 -0.0994129372092807 -0.0940190669528618 -0.0878371725872436 -0.0807632944600795 -0.0728827940985017 -0.0640893101829836 -0.0544683415031976 -0.0439109493230568 -0.0325027720860805 -0.0201320997044006 -0.00688470471983265 0.00735410887467955 0.0224984492661886 0.0386662364619085 0.0557714851134653 0.0739356042263179 0.0930725535818448 0.113307527137471 0.134554483895376 0.156942734486545 0.180386309740103 0.205019010213027 0.230755033515123 0.257733091849179 0.285867671678979 0.315302875437185 0.345953633598385 0.377969984499208 0.411267498356098 0.446002774705473 0.482092269268453 0.519699863163784 0.558743205421763 0.599394293436824 0.641572354745626 0.685458476107098 0.730973945914945 0.778310082203851 0.827390839362293 0.878419116223189 0.931322294625744 0.986316461262058 1.04333338746219];
maxkP.SIRevaCTD5 = [1.43108736679657 1.34340599527148 1.25818058929518 1.17524105504462 1.09456789501660 1.01600478127038 0.939542411609352 0.865036097335240 0.792484374849593 0.721753244719776 0.652847802769555 0.585642568963958 0.520148917863570 0.456248699474535 0.393958005477674 0.333165752508517 0.273892050744234 0.216031353002001 0.159607921067759 0.104521029150812 0.0507979405066013 -0.00165716875036380 -0.0528144355719765 -0.102765960291361 -0.151478941602881 -0.199042212466307 -0.245420953207055 -0.290700466068132 -0.334844152439058 -0.377934754725940 -0.419933449963251 -0.460920727376062 -0.500856322146304 -0.539818104920872 -0.577764514639831 -0.614771645357569 -0.650796136050728 -0.685912520090304 -0.720076332590286 -0.753360121248794 -0.785718405736189 -0.817222506800339 -0.847825391236444 -0.877597211148238 -0.906489721410134 -0.934571549387432 -0.961793990805646 -0.988224846477957 -1.01381398973198 -1.03862851597718 -1.06261747724607 -1.08584677792440 -1.10826467524049 -1.12993654938983 -1.15080928811343 -1.17094784335540 -1.19029830772916 -1.20892470192155 -1.22677233121363 -1.24390492769841 -1.26026642041583 -1.27592033138024 -1.29080976879094 -1.30499752736332 -1.31895827726248 -1.33275139300046 -1.34578402573018 -1.35811854257862 -1.36969467257742 -1.38057417176963 -1.39069586906948 -1.40012152647470 -1.40878845040473 -1.41675846350250 -1.42396787830252 -1.43047803244259 -1.43622420703023 -1.44126786750342 -1.44554261962571 -1.44911010314143 -1.45190276710950 -1.45398186394692 -1.45527863162681 -1.45585454784823 -1.45563896778195 -1.45469363308076 -1.45294691241448 -1.45046023282702 -1.44716022649134 -1.44310852225979 -1.43822959617334 -1.43258540512677 -1.42609876577943 -1.41883135635322 -1.41070423149462 -1.40177941027636 -1.39197542901498 -1.38135466551237 -1.36983361747519 -1.35747438111432 -1.34419127490043 -1.33004673667627 -1.31495208399987 -1.29897009636242 -1.28200954338937 -1.26413285969909 -1.24524607165112 -1.22541189174406 -1.20453269080067 -1.18267143015819 -1.15972723366573 -1.13576255889137 -1.11067300542925 -1.08452113841557 -1.05719799125045 -1.02876615782450 -0.999112437560887 -0.968298601361164 -0.936206809436339 -0.902898585332160 -0.868250214705985 -0.832322806040923 -0.794986967529350 -0.756302383509241 -0.716133370155817 -0.674538675737969 -0.631374785345229 -0.586699177798710;];

medkP.SIReva3 = resultados(8).SIReva;
% [10.1281102241184 10.0502875429474 9.97461880139401 9.90102259043821 9.82942385738905 9.75975029758002 9.69193648848262 9.62591780922908 9.56163698706014 9.49903606417665 9.43806481766557 9.37867085766596 9.32081023599539 9.26443533700583 9.20950759314887 9.15598363251806 9.10382963060737 9.05300577205938 9.00348256652782 8.95522328477317 8.90820218756946 8.86238535826417 8.81775042052890 8.77426580504374 8.73191228992623 8.69066036085244 8.65049354385495 8.61138424913598 8.57331850562639 8.53627031086557 8.50022810462149 8.46516728305673 8.43107839630486 8.39793819256723 8.36573917422983 8.33445918196990 8.30409264976313 8.27461838527105 8.24603252066020 8.21831483559087 8.19146305787451 8.16545772869966 8.14029819719438 8.11596569976536 8.09246107439169 8.06976627176013 8.04788342175872 8.02679501170373 8.00650459689238 7.98699514301332 7.96827147306436 7.95031709233961 7.93313805350121 7.91671824533268 7.90106503190090 7.88616264620025 7.87201962916600 7.85862063615149 7.84597536793029 7.83406876194704 7.82291178037916 7.81248961787754 7.80281438209968 7.79387161689133 7.78498080639254 7.77612821022796 7.76802184737302 7.76064718465672 7.75401937968347 7.74812422204654 7.74297804233201 7.73856683257417 7.73490823068396 7.73198842702470 7.72982627976804 7.72840829268841 7.72775457643474 7.72785183823385 7.72872159629049 7.73035076952150 7.73276221455241 7.73594319234072 7.73991795122207 7.74467399588565 7.75023714672950 7.75659517544912 7.76377534752112 7.77176585039825 7.78059561296720 7.79025317621048 7.80076928693774 7.81213286356583 7.82437645296829 7.83748952776465 7.85150655164266 7.86641749063953 7.88225898420641 7.89902156542836 7.91674407396103 7.93541782613333 7.95508403164341 7.97573476443735 7.99741392942454 8.02011447847908 8.04388310061119 8.06871390264480 8.09465660837855 8.12170651238902 8.14991679925188 8.17928414802776 8.20986539614463 8.24165898274476 8.27472577809780 8.30906611565027 8.34474548585606 8.38176644438211 8.42019946745386 8.46004987679728 8.50139373221133 8.54423943971219 8.58866950301728 8.63469597741575 8.68240848401074 8.73182357550904 8.78303897740795 8.83607640956540 8.89104305494751 8.94796682048051;]
medkP.SIReva5 = [10.1281102241184 10.0502875429474 9.97461880139401 9.90102259043821 9.82942385738905 9.75975029758002 9.69193648848262 9.62591780922908 9.56163698706014 9.49903606417665 9.43806481766557 9.37867085766596 9.32081023599539 9.26443533700583 9.20950759314887 9.15598363251806 9.10382963060737 9.05300577205938 9.00348256652782 8.95522328477317 8.90820218756946 8.86238535826417 8.81775042052890 8.77426580504374 8.73191228992623 8.69066036085244 8.65049354385495 8.61138424913598 8.57331850562639 8.53627031086557 8.50022810462149 8.46516728305673 8.43107839630486 8.39793819256723 8.36573917422983 8.33445918196990 8.30409264976313 8.27461838527105 8.24603252066020 8.21831483559087 8.19146305787451 8.16545772869966 8.14029819719438 8.11596569976536 8.09246107439169 8.06976627176013 8.04788342175872 8.02679501170373 8.00650459689238 7.98699514301332 7.96827147306436 7.95031709233961 7.93313805350121 7.91671824533268 7.90106503190090 7.88616264620025 7.87201962916600 7.85862063615149 7.84597536793029 7.83406876194704 7.82291178037916 7.81248961787754 7.80281438209968 7.79387161689133 7.78498080639254 7.77612821022796 7.76802184737302 7.76064718465672 7.75401937968347 7.74812422204654 7.74297804233201 7.73856683257417 7.73490823068396 7.73198842702470 7.72982627976804 7.72840829268841 7.72775457643474 7.72785183823385 7.72872159629049 7.73035076952150 7.73276221455241 7.73594319234072 7.73991795122207 7.74467399588565 7.75023714672950 7.75659517544912 7.76377534752112 7.77176585039825 7.78059561296720 7.79025317621048 7.80076928693774 7.81213286356583 7.82437645296829 7.83748952776465 7.85150655164266 7.86641749063953 7.88225898420641 7.89902156542836 7.91674407396103 7.93541782613333 7.95508403164341 7.97573476443735 7.99741392942454 8.02011447847908 8.04388310061119 8.06871390264480 8.09465660837855 8.12170651238902 8.14991679925188 8.17928414802776 8.20986539614463 8.24165898274476 8.27472577809780 8.30906611565027 8.34474548585606 8.38176644438211 8.42019946745386 8.46004987679728 8.50139373221133 8.54423943971219 8.58866950301728 8.63469597741575 8.68240848401074 8.73182357550904 8.78303897740795 8.83607640956540 8.89104305494751 8.94796682048051;];
medkP.SIRevaCTD3 = [10.6656237894057 10.5878428178935 10.5121602907756 10.4385040168619 10.3667962462061 10.2969732064296 10.2289664573480 10.1627193343655 10.0981714344981 10.0352721277454 9.97396799781827 9.91421356434386 9.85596152446601 9.79917081271210 9.74379950909124 9.68981034919637 9.63716618113682 9.58583302574431 9.53577797915388 9.48696991162212 9.43937972521556 9.39297876955461 9.34774137519719 9.30364105543625 9.26065524583392 9.21875935288670 9.17793363897598 9.13815517115763 9.09940679871653 9.06166704843061 9.02492114909006 8.98914891324358 8.95433776957995 8.92046866530739 8.88753107329699 8.85550694380545 8.82438765882577 8.79415605678316 8.76480531169871 8.73631904971229 8.70869213550284 8.68190889497404 8.65596579594066 8.63084778701315 8.60655286390016 8.58306653040632 8.56038824586010 8.53850401016153 8.51741469185591 8.49710673530531 8.47758237282785 8.45882844828667 8.44084852053212 8.42362979397920 8.40717712435523 8.39147804314368 8.37653868038004 8.36234686615234 8.34890998892984 8.33621615360361 8.32427399760096 8.31307188119840 8.30261968749703 8.29290601692102 8.28320939050320 8.27351866293391 8.26457824948708 8.25637650332345 8.24892636450352 8.24221640762681 8.23626084845399 8.23104847967450 8.22659481440523 8.22288886411074 8.21994746731073 8.21775985909129 8.21634423809537 8.21569007223494 8.21581696204518 8.21671462210015 8.21840410411945 8.22087538816542 8.22415103454341 8.22822131307313 8.23311035886731 8.23880876177654 8.24534230761734 8.25270194323541 8.26091519174248 8.26997340146656 8.27990593131408 8.29070458411069 8.30240066640508 8.31498649827375 8.32849546081309 8.34292046529729 8.35829711136389 8.37461898837844 8.39192407801764 8.41020674969251 8.42950755300529 8.44982175698129 8.47119269087506 8.49361666360756 8.51714002580037 8.54176029103358 8.56752710800405 8.59443938880299 8.62255039797473 8.65186067471741 8.68242746565758 8.71425320742011 8.74739955248175 8.78187115560012 8.81773456759125 8.85499704325422 8.89373060684606 8.93394556991334 8.97572010523920 9.01906812982981 9.06407476195087 9.11075818673519 9.15921141456586 9.20945770355147 9.26159908814387 9.31566488308272 9.37176751026745 9.42994355150572];

minkP.SIReva3 = resultados(9).SIReva;

fig = figure;
fig1 = plot(FF, polyval(maxkP.pteo, FF), '-k', FF, polyval(maxkP.pap1, FF), '-r',  FF, polyval(maxkP.pap2, FF), '-m', FF, maxkP.SIReva3, '*b', FF, maxkP.SIReva5, 'hc', FF, maxkP.SIRevaCTD5, '.g');
hold on
fig2 = plot(FF, polyval(medkP.pteo, FF), '-k', FF, polyval(medkP.pap1, FF), '-r',  FF, polyval(medkP.pap2, FF), '-m', FF, medkP.SIReva3, '*b', FF, medkP.SIReva5, 'hc', FF, medkP.SIRevaCTD3, '.g');
leg = legend('Simulação Sem Aproximações', 'Simulação Log Linear', 'Simulação Log Quadrático', 'Modelo Analítico (3ª ordem)', 'Modelo Analítico (5ª ordem)', 'Modelo Analítico CTD (5ª ordem)');
set(gca, 'FontSize', 12)
set(fig, 'Position', [100 100 640 500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
axis([4.7 5.4 -2 15])
set(fig1(1:3), 'LineWidth', 2)
set(fig2(1:3), 'LineWidth', 2)
set(fig1(end), 'MarkerSize', 12);
set(fig2(end), 'MarkerSize', 12);
set(gca, 'xtick', 4.7:0.1:5.4)
grid on
set(leg,'Position',[0.429513888888889 0.693666666666667 0.462326388888889 0.216]);
% Create textbox
% Create textbox
annotation(fig,'textbox', [0.618560736677124 0.486071292289081 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 40 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
% Create textbox
annotation(fig,'textbox', [0.615464145768032 0.2225490250826 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 75 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
% % 
cd('../../DissertacaoPG/figuras/matlab')
saveas(fig, 'OFDM_UWB2_100km.fig')
cd ..
saveas(fig, 'OFDM_UWB2_100km', 'epsc');
cd('../../codigos/Graficos')
% 
%%
% L = 100.00km, P0 = 5.00mW, mIM = 2.00%, Nit = 1000, kappa = 15.00
% L = 100.00km, P0 = 4.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
% L = 100.00km, P0 = 1.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00

maxkP.pteo = [97.181821101574970 -1.947904909912969e+03 1.466074548376298e+04 -4.910858432387770e+04 6.179722288949809e+04];
medkP.pteo = [53.577132007991840 -1.071997306609766e+03 8.064786307444373e+03 -2.703977392898031e+04 3.412480510354779e+04];
% minkP.pteo = polyfit(FF, resultados(12).SIRteo, 4);

maxkP.pap1 = [97.021241749238140 -1.944533990487698e+03 1.463424252472613e+04 -4.901613892987499e+04 6.167485902705457e+04];
medkP.pap1 = [55.292990485482240 -1.106767335321009e+03 8.328740479584538e+03 -2.792898189271057e+04 3.524150776416239e+04];
% minkP.pap1 = polyfit(FF, resultados(12).SIRap1, 4);

maxkP.pap2 = [98.098749015731630 -1.966256870725506e+03 1.479840083572845e+04 -4.956732582744413e+04 6.237098017887503e+04];
medkP.pap2 = [55.375350569662780 -1.108296249341701e+03 8.339450767499282e+03 -2.796376745311001e+04 3.529274957006205e+04];
% minkP.pap2 = polyfit(FF, resultados(12).SIRap2, 4);

maxkP.SIReva3 = resultados(10).SIReva;
maxkP.SIReva5 = [24.1097090097860 24.0318551289955 23.9560872771573 23.8823587208679 23.8105657424549 23.7406700327839 23.6725772569267 23.6062562388750 23.5416207129467 23.4786455883257 23.4172515868970 23.3574188310500 23.2990741344675 23.2422021163428 23.1867349200847 23.1326610712058 23.0799174042795 23.0284958470358 22.9783373883841 22.9294369393560 22.8817391747544 22.8352416407087 22.7898923006864 22.7456910310618 22.7025887467998 22.6605874000338 22.6196405555115 22.5797520294509 22.5408777787874 22.5030232934327 22.4661467029558 22.4302550126315 22.3953083229157 22.3613150240119 22.3282370147829 22.2960839492913 22.2648193781100 22.2344541200635 22.2049532386110 22.1763286378250 22.1485467759899 22.1216205655757 22.0955177603201 22.0702522213055 22.0457929028868 22.0221545681623 21.9993072847583 21.9772666708170 21.9560038434659 21.9355352418709 21.9158329641397 21.8969142485824 21.8787521185421 21.8613645861604 21.8447255562929 21.8288538007505 21.8137240586141 21.7993558579184 21.7857247357644 21.7728509683143 21.7607108651504 21.7493254527921 21.7386717829746 21.7287716449763 21.7188707341090 21.7089905509830 21.6998407003549 21.6914437720201 21.6837782254754 21.6768674414924 21.6706905747463 21.6652718144096 21.6605910104180 21.6566731883666 21.6534988880331 21.6510940103091 21.6494397898980 21.6485630371122 21.6484456974274 21.6491155364135 21.6505552210971 21.6527935304086 21.6558138753286 21.6596461027387 21.6642744021804 21.6697297568463 21.6759971617499 21.6831088194057 21.6910505815101 21.6998559528392 21.7095116983250 21.7200527231595 21.7314667635151 21.7437902429208 21.7570119443062 21.7711699303251 21.7862541254883 21.8023043752335 21.8193118436378 21.8373183281296 21.8563163542385 21.8763498505363 21.8974128528913 21.9195516325484 21.9427618960010 21.9670925056525 21.9925410339571 22.0191592054978 22.0469466945832 22.0759584079098 22.1061963842160 22.1377190893264 22.1705312442447 22.2046952966874 22.2402190332718 22.2771693854745 22.3155576449743 22.3554558233825 22.3968792507408 22.4399057058714 22.4845552045908 22.5309121176768 22.5790019099184 22.6289165375554 22.6806878500554 22.7344165660779 22.7901420711004 22.8479752831687;];
maxkP.SIRevaCTD5 = [30.5332717929997 30.4451698861690 30.3591591600896 30.2752216115065 30.1932251582106 30.1131593777603 30.0349023704304 29.9584500762940 29.8836894001842 29.8106216585963 29.7391414187589 29.6692545627792 29.6008623671498 29.5339746154973 29.4684984853426 29.4044471157428 29.3417329021169 29.2803718806870 29.2202810845124 29.1614790672245 29.1038869967808 29.0475256290988 28.9923198357190 28.9382923057220 28.8853712429310 28.8335810455099 28.7828529215291 28.7332127920382 28.6845945847980 28.6370255822151 28.5904421844258 28.5448729012795 28.5002563827217 28.4566222558521 28.4139112259278 28.3721539403325 28.3312929896212 28.2913599626157 28.2522991793753 28.2141431072356 28.1768376591470 28.1404161248948 28.1048258907428 28.0701010260644 28.0361902800584 28.0031284695624 27.9708656062003 27.9394372257967 27.9087945188733 27.8789737215822 27.8499271224149 27.8216916482900 27.7942206154286 27.7675516331988 27.7416389851903 27.7165209631351 27.6921527595171 27.6685733562151 27.6457388049314 27.6236887857129 27.6023801681327 27.5818533460049 27.5620659659512 27.5430591586274 27.5240582330457 27.5051033944041 27.4868856685506 27.4694469601429 27.4527463605859 27.4368265641104 27.4216473519267 27.4072522410176 27.3936016869174 27.3807400705792 27.3686285060791 27.3573122878826 27.3467531805039 27.3369974422709 27.3280074878830 27.3198305991534 27.3124298408055 27.3058535876072 27.3000655627113 27.2951153056859 27.2909672155519 27.2876720799786 27.2851949906474 27.2835880790223 27.2828171619651 27.2829358161054 27.2839106225770 27.2857967185889 27.2885614937843 27.2922617785221 27.2968658290024 27.3024323109946 27.3089304207199 27.3164208225470 27.3248737343847 27.3343520060347 27.3448269784883 27.3563638912780 27.3689353324479 27.3826091663180 27.3973593682836 27.4132566979238 27.4302766885233 27.4484932963975 27.4678838186661 27.4885257576752 27.5103984117053 27.5335832345661 27.5580618125882 27.5839200120574 27.6111420535828 27.6398187558288 27.6699373802760 27.7015943324670 27.7347804082218 27.7695983370514 27.8060430490315 27.8442244737480 27.8841423947008 27.9259149883902 27.9695477745294 28.0151684220528 28.0627892754076 28.1125490057821;];
maxkP.SIRevaCTD3 =  [30.5366669114275 30.4486022075437 30.3626276874704 30.2787254269509 30.1967633787980 30.1167311926608 30.0385069930221 29.9620867866639 29.8873574962022 29.8143204978717 29.7428703714210 29.6730130555128 29.6046498321099 29.5377905389674 29.4723423555356 29.4083184705329 29.3456312783652 29.2842968636506 29.2242322533810 29.1654560487226 29.1078894095629 29.0515531362733 28.9963720906457 28.9423690060234 28.8894720725519 28.8377057326986 28.7870011797232 28.7373843767297 28.6887892357163 28.6412430816085 28.5946822955174 28.5491354304194 28.5045411166196 28.4609290226363 28.4182398335740 28.3765042391418 28.3356648068879 28.2957531689650 28.2567136221341 28.2185786757388 28.1812942191982 28.1448935855480 28.1093241349253 28.0746199808707 28.0407298451722 28.0076885878100 27.9754461945552 27.9440382459022 27.9134159040898 27.8836154515358 27.8545891485258 27.8263739674908 27.7989231965434 27.7722744923726 27.7463821081463 27.7212843847982 27.6969364845969 27.6733774381368 27.6505632671268 27.6285337024433 27.6072455814422 27.5867393509663 27.5669726257523 27.5479865892933 27.5290056314149 27.5100699981449 27.4918715607589 27.4744522771297 27.4577712008555 27.4418710792687 27.4267116561188 27.4123365040869 27.3987060390230 27.3858647002750 27.3737735626672 27.3624779792642 27.3519396757688 27.3422049721290 27.3332362420424 27.3250808321026 27.3177017665973 27.3111474857025 27.3053816727304 27.3004539362447 27.2963286333214 27.2930566244103 27.2906029619802 27.2890198515361 27.2882730701802 27.2884162724665 27.2894159978679 27.2913274661673 27.2941180265167 27.2978445939025 27.3024753853380 27.3080691566825 27.3145950634430 27.3221138659701 27.3305957432504 27.3401036443731 27.3506088734517 27.3621767763841 27.3747799035187 27.3884862332825 27.4032697062348 27.4192012013035 27.4362562202627 27.4545088483284 27.4739363516241 27.4946163720130 27.5165281815210 27.5397533818456 27.5642735386735 27.5901746797010 27.6174410079392 27.6461635187801 27.6763294642877 27.7080354404197 27.7412722434311 27.7761428135192 27.8126420891818 27.8508802341700 27.8908570551811 27.9326909861622 27.9763875881636 28.0220748201078 28.0697650858615 28.1195973853103;];

medkP.SIReva3 = resultados(11).SIReva;
medkP.SIReva5 = [29.5416583671085 29.4649425758076 29.3903065415847 29.3177364869109 29.2470961830897 29.1783793825539 29.1114600857504 29.0463383638886 28.9828970634953 28.9211415931687 28.8609624970674 28.8023697179954 28.7452605371889 28.6896487729526 28.6354376318193 28.5826442648213 28.5311771158074 28.4810562165587 28.4321946618565 28.3846149887814 28.3382344377405 28.2930777384391 28.2490658416439 28.2062254059943 28.1644807160116 28.1238601388137 28.0842909626877 28.0458030789398 28.0083264916793 27.9718924597653 27.9364334510260 27.9019819611626 27.8684726975762 27.8359392841990 27.8043184704617 27.7736449161373 27.7438572381873 27.7149910563455 27.6869866979409 27.6598806811535 27.6336149042028 27.6082267320725 27.5836595099563 27.5599514093979 27.5370471101500 27.5149855597984 27.4937126710925 27.4732681435843 27.4535990341713 27.4347457786000 27.4166564956936 27.3993723492401 27.3828424468920 27.3671086766615 27.3521210702589 27.3379222428486 27.3244630903280 27.3117869643515 27.2998455723248 27.2886830151283 27.2782517657173 27.2685966930472 27.2596709932132 27.2515203281229 27.2433643850480 27.2352478025721 27.2278580929992 27.2212418065515 27.2153533969728 27.2102402670434 27.2058574954033 27.2022533759107 27.1993835913233 27.1972973716763 27.1959509858549 27.1953946520447 27.1955852131372 27.1965739317364 27.1983182186294 27.2008704449322 27.2041885864439 27.2083261952934 27.2132418160562 27.2189902604150 27.2255306525586 27.2329191522928 27.2411154780013 27.2501772371808 27.2600647673929 27.2708372326102 27.2824556219552 27.2949807779322 27.3083743811271 27.3226990901062 27.3379173283991 27.3540937220442 27.3711915020956 27.3892774330722 27.4083156296449 27.4283751881489 27.4494212002298 27.4715253094208 27.4946536976991 27.5188808007226 27.5441740238428 27.5706108739997 27.5981601404331 27.6269027166457 27.6568089687626 27.6879635389440 27.7203385979633 27.7540229539371 27.7889908564308 27.8253357582764 27.8630343179186 27.9021851899465 27.9427678355022 27.9848867621107 28.0285247105565 28.0737928021022 28.1206776365265 28.1692978487984 28.2196445995710 28.2718451086930 28.3258959586709 28.3819342330033 28.4399629978429 28.5001307450917;];
medkP.SIRevaCTD5 = [41.3984063249222 41.2984724734720 41.2006391068298 41.1049899160263 41.0112917489927 40.9196330514965 40.8297935899482 40.7418655933040 40.6556401329913 40.5712124531595 40.4883835753593 40.4072511485066 40.3276249977165 40.2496046911880 40.1730078791906 40.0979356627152 40.0242126775979 39.9519412489679 39.8809522732347 39.8113490545504 39.7429681190355 39.6759135561137 39.6100269705529 39.5454130839620 39.4819180958756 39.4196472412761 39.3584508863716 39.2984346889249 39.2394528022441 39.1816112385629 39.1247676002367 39.0690282052301 39.0142538015146 38.9605509804712 38.9077833631814 38.8560577949404 38.8052405242652 38.7554386427807 38.7065208030692 38.6585943457520 38.6115301246341 38.5654357398332 38.5201840615616 38.4758829678933 38.4324071756289 38.3898648661719 38.3481324466323 38.3073184324370 38.2673007779285 38.2281883691330 38.1898605744216 38.1524266924659 38.1157673825460 38.0799924021149 38.0449835873033 38.0108512055340 37.9774781628135 37.9449752926645 37.9132264714810 37.8823431588264 37.8522101088188 37.8229394720368 37.7944167928061 37.7667549828463 37.7391070726829 37.7115828214599 37.6848004217788 37.6588736927572 37.6336894209365 37.6093623313190 37.5857797614018 37.5630574266554 37.5410831488077 37.5199737247503 37.4996173971773 37.4801321422122 37.4614065648356 37.4435599244595 37.4264811342036 37.4102908490196 37.3948782393567 37.3803654769479 37.3666419434915 37.3538314574186 37.3418235705154 37.3307438888925 37.3204820968957 37.3111657415985 37.3026846089106 37.2951683527121 37.2885068349566 37.2828319975357 37.2780337587554 37.2742465472906 37.2713603260065 37.2695122275631 37.2685922566116 37.2687404895690 37.2698469791176 37.2720550109571 37.2752547042870 37.2795928476873 37.2849596597697 37.2915057596580 37.2991215138814 37.3079617391757 37.3179170190238 37.3291467791063 37.3415419136097 37.3552669221045 37.3702131315714 37.3865506434067 37.4041713760665 37.4232516334815 37.4436841291470 37.4656520588246 37.4890491882768 37.5140664004051 37.5405988393627 37.5688459964296 37.5987048064116 37.6303844453524 37.6637841575104 37.6991240698967 37.7363063926200 37.7755637020653 37.8168020064509 37.8602681216244;];

% minkP.SIReva3 = resultados(12).SIReva;

fig = figure;
fig1 = plot(FF, polyval(maxkP.pteo, FF), '-k', FF, polyval(maxkP.pap1, FF), '-r',  FF, polyval(maxkP.pap2, FF), '-m', FF, maxkP.SIReva3, '*b', FF, maxkP.SIReva5, 'hc', FF, maxkP.SIRevaCTD3, '.g');
hold on
fig2 = plot(FF, polyval(medkP.pteo, FF), '-k', FF, polyval(medkP.pap1, FF), '-r',  FF, polyval(medkP.pap2, FF), '-m', FF, medkP.SIReva3, '*b', FF, medkP.SIReva5, 'hc', FF, medkP.SIRevaCTD3, '.g');
leg = legend('Simulação Sem Aproximações', 'Simulação Log Linear', 'Simulação Log Quadrático', 'Modelo Analítico (3ª ordem)', 'Modelo Analítico (5ª ordem)', 'Modelo Analítico CTD (5ª ordem)');
set(gca, 'FontSize', 12)
set(fig, 'Position', [100 100 640 500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
set(fig1(1:3), 'LineWidth', 2)
set(fig2(1:3), 'LineWidth', 2)
set(fig1(end), 'MarkerSize', 12);
set(fig2(end), 'MarkerSize', 12);
grid on
set(leg,'Position',[0.429513888888889 0.693666666666667 0.462326388888889 0.216]);
% Create textbox
% Create textbox
annotation(fig,'textbox', [0.618560736677124 0.486071292289081 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 40 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
% Create textbox
annotation(fig,'textbox', [0.615464145768032 0.2225490250826 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 75 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
% % 
cd('../../DissertacaoPG/figuras/matlab')
saveas(fig, 'OFDM_UWB2_20km.fig')
cd ..
saveas(fig, 'OFDM_UWB2_20km', 'epsc');
cd('../../codigos/Graficos')
