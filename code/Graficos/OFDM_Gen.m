clear, clc, close all

%% Pequenos Sinais OFDM genérico
FF = [0.300000000000000 0.350000000000000 0.400000000000000 0.450000000000000 0.500000000000000 0.550000000000000 0.600000000000000 0.650000000000000 0.700000000000000 0.750000000000000 0.800000000000000 0.850000000000000 0.900000000000000 0.950000000000000 1 1.05000000000000 1.10000000000000 1.15000000000000 1.20000000000000 1.25000000000000 1.30000000000000 1.35000000000000 1.40000000000000 1.45000000000000 1.50000000000000 1.55000000000000 1.60000000000000 1.65000000000000 1.70000000000000 1.75000000000000 1.80000000000000 1.85000000000000 1.90000000000000 1.95000000000000 2 2.05000000000000 2.10000000000000 2.15000000000000 2.20000000000000 2.25000000000000 2.30000000000000 2.35000000000000 2.40000000000000 2.45000000000000 2.50000000000000 2.55000000000000 2.60000000000000 2.65000000000000 2.70000000000000 2.75000000000000 2.80000000000000 2.85000000000000 2.90000000000000 2.95000000000000 3 3.05000000000000 3.10000000000000 3.15000000000000 3.20000000000000 3.25000000000000 3.30000000000000 3.35000000000000 3.40000000000000 3.45000000000000 3.50000000000000 3.55000000000000 3.60000000000000 3.65000000000000 3.70000000000000 3.75000000000000 3.80000000000000 3.85000000000000 3.90000000000000 3.95000000000000 4 4.05000000000000 4.10000000000000 4.15000000000000 4.20000000000000 4.25000000000000 4.30000000000000 4.35000000000000 4.40000000000000 4.45000000000000 4.50000000000000 4.55000000000000 4.60000000000000 4.65000000000000 4.70000000000000 4.75000000000000 4.80000000000000 4.85000000000000 4.90000000000000 4.95000000000000 5 5.05000000000000 5.10000000000000 5.15000000000000 5.20000000000000 5.25000000000000 5.30000000000000 5.35000000000000 5.40000000000000 5.45000000000000 5.50000000000000 5.55000000000000 5.60000000000000 5.65000000000000 5.70000000000000 5.75000000000000 5.80000000000000 5.85000000000000 5.90000000000000 5.95000000000000 6 6.05000000000000 6.10000000000000 6.15000000000000 6.20000000000000 6.25000000000000 6.30000000000000 6.35000000000000 6.40000000000000 6.45000000000000 6.50000000000000 6.55000000000000 6.60000000000000 6.65000000000000;];
% L = 100km, P0 = 1mW, mIM = 0.1% Nit = 1000
pap101 = [-0.018270592794115 0.402297397920085 -3.393904425838367 13.205599812791580 -20.768463246083513 0.555389376267578 53.375001914048780];
pap201 = [-0.015961105423800 0.361850594658466 -3.137315383993557 12.491050981078276 -20.218533960999140 2.264821282895402 52.265275974587170];
pteo01 = [-0.002963515816853 0.064368401571297 -0.458953532693058 0.503934389402815 7.366194397257322 -27.414639206543566 62.039735803377276];
ppsi01 = [-0.019393200569231 0.430303698795201 -3.676602805162871 14.666509832417430 -24.771189479652246 5.913538255776622 50.720303674111776];
SIReva301 = [54.8896476844849 53.3994599210544 52.0701782170768 50.8624207936241 49.7500707109431 48.7150988669613 47.7382336878697 46.8047479955898 45.9326328920223 45.0924497059091 44.3029225132263 43.5387621252649 42.8183504546907 42.1194624283159 41.4597365349262 40.8193614036532 40.2151168367625 39.6291632706325 39.0774232755136 38.5436928904707 38.0430760471318 37.5607220683888 37.1109533731338 36.6800170007820 36.2814729743599 35.9024255061954 35.5556719251699 35.2289486956426 34.9342810301350 34.6598387946096 34.4168743381391 34.1938332504851 34.0012216321331 33.8276565096112 33.6829633133875 33.5558821421268 33.4556616488067 33.3711627413441 33.3111873071074 33.2647421964283 33.2403202748780 33.2271059225055 33.2334121945064 33.2486230056536 33.2809804899791 33.3200717091152 33.3741537831117 33.4329999788815 33.5049473070493 33.5799202983259 33.6663850879007 33.7543687158365 33.8525059774302 33.9508681952422 34.0582938885027 34.1648342397132 34.2795663682902 34.3924526330087 34.5128464659911 34.6305498401128 34.7552347379760 34.7361624180182 34.8566726557908 34.9730213782670 35.0953250506085 35.2128538981358 35.3361660980112 35.4541113615662 35.5777555394396 35.6954424744914 35.8188210142612 35.9356373342166 36.0582076434134 36.1735811440613 36.2948358147556 36.4082158393343 36.5276660811087 36.6385082243489 36.7556702062746 36.8634235102484 36.9778072097527 37.0819037539128 37.1930037181412 37.2928504410802 37.4001385581792 37.4951109015593 37.5980311632238 37.6874688732651 37.7854337835134 37.8686390360932 37.9610281115709 38.0372657090776 38.1234262714642 38.1919264922531 38.2711764230667 38.3311407553023 38.4027737651637 38.4533830685738 38.5166765794743 38.5571021168164 38.6113270293789 38.6407441962640 38.6851768000351 38.7027803586124 38.7367159486902 38.7417366240571 38.7645032799156 38.7562247820056 38.7671970476851 38.7449713903867 38.7435828362214 38.7068433942864 38.6925958907445 38.6408669696622 38.6133364569158 38.5462370999895 38.5050750487703 38.4223172193017 38.3672462045201 38.2686272847517 38.1994303857121 38.0848174894243 38.0013234201327 37.7903146072157 37.6162815105803 37.3996524675793 37.2199192606261 36.9970610763508;];

% L = 100km, P0 = 1mW, mIM = 0.5% Nit = 1000
pap12 = [-0.017654762039220 0.389500480032494 -3.295122184183585 12.858123461988399 -20.218193396090484 0.190496637361555 39.509135608828080];
pap22 = [-0.015382075843409 0.349082236846624 -3.033184262409382 12.109931722933650 -19.615049536431407 1.892266063313385 38.393636651079330];
pteo2 = [-0.002564359906985 0.055529570535148 -0.387929881506446 0.256166515244267 7.715703446238521 -27.598870460682157 48.116764692649100];
ppsi2 = [0.007349418661721 -0.165996853517404 1.453795413077070 -6.316216744943549 14.390401614132744 -14.833902364703210 22.952845183431773];
SIReva32 = [40.9100652198792 39.4197952767971 38.0904108762829 36.8825286618771 35.7700297650440 34.7348840467270 33.7578187757147 32.8241070890542 31.9517367623827 31.1112715389501 30.3214314269067 29.5569311206114 28.8361476839744 28.1368615930003 27.4767057822434 26.8358762597734 26.2311468761975 25.6446875453875 25.0924144643785 24.5581357379120 24.0569486423994 23.5740170635479 23.1236567488755 22.6921317645018 22.2929948906371 21.9133698350186 21.5660455248511 21.2387794524188 20.9435867502431 20.6686590420985 20.4252355409078 20.2017839453294 20.0087932791057 19.8349021192762 19.6899148008946 19.5625923945458 19.4621579126619 19.3774936262598 19.3173715635199 19.2708229917497 19.2463033180068 19.2330227302392 19.2392580367422 19.2544199814925 19.2867114983704 19.3257497015052 19.3797502787054 19.4385203236823 19.5103522782842 19.5852094572176 19.6715099013883 19.7593239765129 19.8572351714281 19.9553630496988 20.0624901128021 20.1687220640906 20.2830745863841 20.3955703896170 20.5154963105434 20.6327282118751 20.7568579519355 20.7377091134420 20.8576146765847 20.9733542522658 21.0949557040016 21.2117767298924 21.3342847878069 21.4514283486232 21.5741683365311 21.6909580099247 21.8133308463094 21.9291545913569 22.0506164148426 22.1649027424467 22.2849470048389 22.3971464541246 22.5152857466009 22.6248578067777 22.7406102178255 22.8470087599533 22.9598892048019 23.0625521060469 23.1720610798130 23.2704048371870 23.3760211800952 23.4694322720686 23.5706110155314 23.6584416357539 23.7546077565468 23.8361773221498 23.9267240630592 24.0013162769613 24.0856096335059 24.1524749316166 24.2298527246831 24.2882179322196 24.3579944753979 24.4070665125317 24.4685447708638 24.5075206604406 24.5599968527469 24.5880819138700 24.6308561917011 24.6472731053441 24.6796681719833 24.6836718965328 24.7050399066580 24.6959401225152 24.7056746843711 24.6828433346114 24.6803984480565 24.6432810355976 24.6281720665321 24.5763046431192 24.5481126811712 24.4811168792066 24.4394989931643 24.3570792642560 24.3017614110007 24.2037144170260 24.1344669824610 24.0206431246617 23.9372845090523 23.7288165601380 23.5565284738433 23.3422974089512 23.1642012701559 22.9436002988280;];

% L = 100km, P0 = 1mW, mIM = 1% Nit = 1000
pap13 = [-0.018468518633587 0.405265437918182 -3.408175804913676 13.229206520253204 -20.792014255426906 0.562159603463245 33.400124142816615];
pap23 = [-0.016201649323182 0.363687466223037 -3.128088137427764 12.400149742307047 -20.106570481622970 2.334973861655320 32.227290630167744];
pteo3 = [-0.003346620532406 0.069132464622226 -0.472333510426120 0.489869849199778 7.399811457096694 -27.457326429722254 42.060200348400980];
ppsi3 = [9.884302143424977e-04 -0.048308366002494 0.754556883466146 -5.398095015262118 18.430795515372623 -23.034797754532757 8.885182590478390];
SIReva33 = [34.8888952807014 33.3983684483609 32.0686630046245 30.8603906529096 29.7474264863678 28.7117371129515 27.7340461723487 26.7996277717829 25.9264592759772 25.0851119564917 24.2942930922396 23.5287294914815 22.8067830511650 22.1062515657812 21.4447506081354 20.8024992256751 20.1962526865109 19.6082105137214 19.0542690430595 18.5182741001864 18.0153022778894 17.5305630243683 17.0783514296900 16.6449848676194 16.2439937632836 15.8625628822718 15.5134552545801 15.1844942263770 14.8876638322033 14.6112237831257 14.3663726424786 14.1416471761490 13.9474833959632 13.7725870355839 13.6266967834221 13.4986388700043 13.3975564053130 13.3123978578775 13.2518421700215 13.2049961717872 13.1801985666341 13.1667393567219 13.1727825015869 13.1878216921717 13.2199379824767 13.2588414321613 13.3126190938449 13.3711827059784 13.4426865508325 13.5172139176185 13.6030339815722 13.6903510923317 13.7875901511894 13.8850198212084 13.9912497008295 14.0965538552003 14.2097586063952 14.3210728496815 14.4395784458042 14.5553788909446 14.6778197647535 14.6584460864958 14.7765093391366 14.8903930452549 15.0098534717177 15.1245168427568 15.2445729977643 15.3592730107073 15.4792572849052 15.5933137366844 15.7126240677713 15.8254271345366 15.9435174670767 16.0544994519541 16.1708676449421 16.2794844811416 16.3936492576357 16.4993740563258 16.6108613914033 16.7131645173699 16.8215063316739 16.9198450849821 17.0245619158702 17.1183833663930 17.2189770532488 17.3077024977631 17.4036630486964 17.4866834537665 17.5774748088934 17.6541621462231 17.7392198702025 17.8089147975885 17.8876612463314 17.9496742806360 18.0215067443906 18.0751392226735 18.1394327678995 18.1839674688065 18.2400994051068 18.2748075919262 18.3221470535527 18.3463195511220 18.3842346888360 18.3971732219519 18.4250642633576 18.4260917345843 18.4433782528659 18.4318768955912 18.4380052383686 18.4134021178141 18.4078827501411 18.3696563150519 18.3520413199651 18.2997597292540 18.2696433565796 18.2029346695687 18.1599887473371 18.0785355681621 18.0224950756313 17.9260921887296 17.8566909923456 17.7451416322901 17.6621687319936 17.4610558441780 17.2938281866442 17.0865660620324 16.9132360039064 16.6992193295648;];

% L = 100km, P0 = 1mW, mIM = 2% Nit = 1000
pap14 = [-0.018205744991101 0.401363315441173 -3.382168748469024 13.107781074213825 -20.456255191360020 0.116605297511434 27.495195927800253];
pap24 = [-0.014885030575799 0.333491516508642 -2.863298128115702 11.338525444473712 -18.286682885872345 1.171961600126963 26.380149924449277];
pteo4 = [-0.002672185628269 0.052709837069233 -0.320304109296182 -0.140492969662987 8.524072323489749 -28.511905866690608 36.230348191764600];
ppsi4 = [0.005998673473640 -0.142447929473803 1.457905124623953 -8.468891571946642 28.576293437702976 -43.717392877216580 8.173792999147930];
SIReva34 = [28.8660138226442 27.3744582513825 26.0434668643065 24.8336314463808 23.7188027710127 22.6809342436308 21.7007347992930 20.7634822010071 19.8871119168247 19.0422250679095 18.2474777461132 17.4776448940413 16.7510275079722 16.0454923022654 15.3785853158828 14.7306174448197 14.1182698612905 13.5238604017597 12.9632067809037 12.4203059587959 11.9101535256109 11.4181420361642 10.9584868713138 10.5177202255417 10.1092873933879 9.72061954963517 9.36438165206647 9.02866277987389 8.72532875037150 8.44291321751160 8.19245823760674 7.96277660793115 7.76409753083506 7.58539252473591 7.43614161339801 7.30542587658867 7.20207179260619 7.11528398883197 7.05337193154511 7.00573342416259 6.98024510609315 6.96650362101622 6.97222732316076 6.98722833435955 7.01910893370494 7.05793666684158 7.11129604827720 7.16950185200068 7.24017177457434 7.31385124105691 7.39823449746764 7.48404152944486 7.57908790468208 7.67421496103887 7.77737143033766 7.87947600508422 7.98863494750664 8.09576753493505 8.20918007080404 8.31984015404334 8.43616614942455 8.41608660885596 8.52743521982251 8.63455312491640 8.74618394329301 8.85296034711719 8.96404320145502 9.06981007047823 9.17972091493976 9.28380160757139 9.39194659757447 9.49375810238849 9.59960428005822 9.69861289249711 9.80169619442307 9.89739892768707 9.99728355893981 10.0892240292307 10.1854886371152 10.2732178756431 10.3654785196103 10.4485442634325 10.5364154586439 10.6143913735150 10.6974777743289 10.7699235941675 10.8478552159160 10.9143103030633 10.9867007090610 11.0467256409404 11.1131666891022 11.1662993315775 11.2264087714256 11.2721606755612 11.3255345288403 11.3634459679070 11.4096552840642 11.4392445703030 11.4778968539437 11.4986586679648 11.5293414650092 11.5408169089413 11.5630954082896 11.5648109286177 11.5783046345411 11.5697704271945 11.5740835785429 11.5548794415601 11.5495971286945 11.5192953541512 11.5040760611780 11.4622365159139 11.4367232361659 11.3829949196791 11.3468064032563 11.2808271346914 11.2336667448559 11.1550509908147 11.0966738664235 11.0052115269108 10.9352410952723 10.8306008192778 10.7487388306190 10.5703173099928 10.4187859570810 10.2332884262432 10.0749242640763 9.88171086773708;];

fig = figure;
fig1 = plot(FF, polyval(pteo01, FF), '-k', FF, polyval(pap101, FF), '-r', FF, polyval(pap201,FF), '-m', FF, SIReva301, '*b', FF, polyval(ppsi01,FF), 'py');
hold on
fig2 = plot(FF, polyval(pteo3, FF), '-k', FF, polyval(pap13, FF), '-r', FF, polyval(pap23,FF), '-m', FF, SIReva33, '*b', FF, polyval(ppsi3,FF), 'py');
leg = legend('Simulação Sem Aproximações', 'Simulação Log Linear', 'Simulação Log Quadrático', 'Grandes Sinais (3ª ordem)', 'Pequenos Sinais');
set(gca, 'FontSize', 12)
set(fig, 'Position', [ 100     100   640   500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
axis([0 7 -5 60])
set(fig1(1:3), 'LineWidth', 2)
set(fig2(1:3), 'LineWidth', 2)
set(gca, 'xtick', 0:7)
% set(fig3(1:3), 'LineWidth', 2)
grid on
set(leg, 'Position',[0.463811879571577 0.694354925775978 0.428125 0.218623481781377]);
% Create textbox
annotation(fig,'textbox',[0.619270180250782 0.409981263534507 0.172413793103448 0.0850202429149798],...
    'String',{'m_{IM} = 1%'},'FontSize',14,'FitBoxToText','off','LineStyle','none');
annotation(fig,'textbox',[0.265487852664576 0.65251464080595 0.197492163009404 0.0850202429149798],...
    'String',{'m_{IM} = 0.1%'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');

cd('../../DissertacaoPG/figuras/matlab')
saveas(fig, 'compPSGS.fig')
cd ..
saveas(fig, 'compPSGS', 'epsc');
cd('../../codigos/Graficos')

%% OFDM Genérico
%% L = 100.00km, P0 = 1.00mW, mIM = 2.00%, Nit = 1000, kappa = 10 GHz/mW
minkP.pap1 = [-0.036537652323545 0.812645669970087 -6.958390078994944 28.044787369027187 -50.055014125783416 23.033974431668184 23.947191798164507];
minkP.pap2 = [-0.029907128860880 0.680041133975536 -5.973389326079198 24.812632270673667 -46.233079850794150 24.290098886772718 22.281602522752500];
minkP.pteo = [-0.011406395959662 0.253085469261328 -2.090623742265074 7.214543137390601 -5.013705224121301 -21.409096846232945 38.087027724256100];

minkP.SIReva3 = [31.8832101939962 30.2460301854162 28.7636012090272 27.3995312006395 26.1298744421855 24.9380624346541 23.8071560912456 22.7244581974667 21.7017800340361 20.7154889040190 19.7774805811992 18.8680803859508 17.9986414772960 17.1524068519261 16.3400707149446 15.5471836261116 14.7838576774120 14.0375738608887 13.3180158618294 12.6143664951368 11.9360715327447 11.2738854101143 10.6372192585780 10.0183297378769 9.42677208626072 8.85623870619709 8.31652566194498 7.80260297782735 7.32442645232635 6.87788559409152 6.47273312101638 6.10514503963170 5.78402276035498 5.50499109189812 5.27535732221189 5.08945124212086 4.95250984521022 4.85728820578280 4.80704621103710 4.79331644278055 4.81794340597185 4.87190921529883 4.95656247379406 5.06302428212052 5.19273682868182 5.33744780777582 5.49905108382643 5.67009847128676 5.85303398139093 6.04119554986851 6.23753199415816 6.43604484430435 6.64008949576989 6.84418622815460 7.05198601377982 7.25839678933300 7.46727753128833 7.67380391768912 7.88198592067931 8.08724678622577 8.29363524866445 8.33993092663858 8.53444776090985 8.72500529893619 8.91571739537637 9.10223599226154 9.28882971386812 9.47110769241228 9.65341550038056 9.83125441986858 10.0091234498096 10.1823582929166 10.3556486693801 10.5241099302925 10.6926797802502 10.8561712196851 11.0198497559121 11.1781430489655 11.3367166220771 11.4895288307119 11.6427428673702 11.7897259566388 11.9372657478678 12.0780123838772 12.2194962098841 12.3535211253070 12.4885109802699 12.6152459387871 12.7432306857459 12.8620393770948 12.9824331316219 13.0925958246283 13.2047587346762 13.3054747940787 13.4087000959700 13.4991165183080 13.5926375249726 13.6718407185952 13.7548665098021 13.8218970736153 13.8936062214940 13.9475061369284 14.0070646947131 14.0468772473441 14.0934907905137 14.1182863871783 14.1511962982390 14.1601342974911 14.1786396597790 14.1709648571878 14.1744810162549 14.1495450903053 14.1375857056754 14.0949059673061 14.0670905224446 14.0063195379126 13.9624213279674 13.8833422693970 13.8232816129410 13.7258908398679 13.6496208805775 13.5339643563952 13.4415518113167 13.2494787592578 13.0868706371594 12.8862185058504 12.7158106603726 12.5059967533381;];

%% L = 100.00km, P0 = 3.00mW, mIM = 2.00%, Nit = 1000, kappa = 15.00
medkP.pap1 = [0.003140161077235 -0.076956001882264 0.763671128951785 -4.013482931020756 12.167443571077598 -22.487908158419680 26.722332535928434]; %[0.003381819935585 -0.084633281439068 0.846292937381884 -4.400209191809792 12.901698351308651 -22.936787694763527 26.156175026013987];
medkP.pap2 = [0.003231685694185 -0.078999760445117 0.780324372196569 -4.059781171745507 12.057079363023451 -21.632905674440820 26.364392820538225]; %[0.003462772834452 -0.086173701482771 0.856317952931622 -4.412099491310072 12.736598686947445 -22.148694990965797 25.853569510891035];
medkP.pteo = [0.006061611574665 -0.143434809226359 1.356526700885470 -6.610266045528941 17.793856379053235 -27.360674972811108 27.307646608287797]; %[0.005747827592655 -0.138014691507687 1.317413319979096 -6.434041502294497 17.197124579040720 -26.372545760886480 26.245676539114523];

medkP.SIReva3 = [21.1160920621234 19.8765244482273 18.8223544186755 17.9100852891503 17.1096906662096 16.3995338173374 15.7552713450787 15.1567742973368 14.6268997766710 14.1258980593387 13.6791843079229 13.2505080715117 12.8664552591537 12.4931865997316 12.1577634377579 11.8280924735415 11.5313761738886 11.2368357392537 10.9715997257459 10.7059367839195 10.4668206706995 10.2252949043550 10.0082025927722 9.78718194584350 9.58890387570140 9.38551217776898 9.20353302757320 9.01543586953876 8.84770480373128 8.67303320751931 8.51783596994347 8.35501833351223 8.21096874195608 8.05865005286750 7.92455186293315 7.78162819613250 7.65642132596288 7.52191399004580 7.40473944592405 7.27783172088448 7.16791347134107 7.04774228203237 6.94434321142495 6.83030980692053 6.73285435177445 6.62431274738824 6.53224787860512 6.42870230636789 6.34147666028473 6.24243666256380 6.15964527697482 6.06460623913482 5.98583305349992 5.89443907370927 5.81923855689091 5.73111043112128 5.65918934462130 5.57390611995849 5.50493524572026 5.42249368163699 5.35636358574525 5.21837628491525 5.15393330975581 5.07529891010422 5.01293911867780 4.93588098918349 4.87524731544628 4.79978753673140 4.74087661532362 4.66668480242942 4.60927760290640 4.53622565843323 4.48000343886859 4.40787458361955 4.35273558965790 4.28120089043136 4.22694288627332 4.15590694919836 4.10220271218825 4.03145816614934 3.97823196313757 3.90743289977717 3.85448419971397 3.78355608382231 3.73053176889573 3.65926273433406 3.60610239477607 3.53411300047581 3.48060461989773 3.40783167985877 3.35357990132921 3.27979473521895 3.22474541323544 3.14951917040014 3.09343637655736 3.01670895443287 2.95913858404551 2.88065241194725 2.82153783316070 2.74079793819130 2.67986612936215 2.59680677180105 2.53352630432158 2.44784723073793 2.38214854751286 2.29326867983201 2.22482522878926 2.13266140254902 2.06084091650718 1.96503145852140 1.88973597399445 1.78958673191149 1.71041259841766 1.60580375962707 1.52198463855068 1.41246433536247 1.32384793475811 1.20856867973896 1.11491441364611 0.993964205613574 0.894331232470233 0.767126119242512 0.661269495829966 0.490359120771684 0.342158663216105 0.166162393468504 0.0120100807342343 -0.169855247689123]; %[20.2224644727901 19.0211019065619 18.0065733060185 17.1342807989579 16.3732711378334 15.7011695382175 15.0929891688341 14.5280630376123 14.0293702619138 13.5565867072316 13.1355760606094 12.7295525349606 12.3657958637869 12.0098888414154 11.6897722628756 11.3726772148126 11.0868382578993 10.8006757788980 10.5424699183200 10.2815627324712 10.0461833318782 9.80631237514903 9.59015310764330 9.36815095913279 9.16842000648292 8.96180539202355 8.77635126710299 8.58311862323451 8.41019308368618 8.22876163628645 8.06689811728121 7.89593495600561 7.74396835475748 7.58231298083850 7.43922877148274 7.28595741656958 7.15084150842652 7.00512388617469 6.87725906878432 6.73840487634025 6.61713066140954 6.48438320311162 6.36905188993580 6.24191955939549 6.13205572732108 6.00996804525281 5.90509797572022 5.78765077604020 5.68727994857456 5.57405439414347 5.47785592096029 5.36839664096589 5.27601286370731 5.17003885174669 5.08106006872905 4.97824684871895 4.89244579177835 4.79240353246144 4.70949606791315 4.61231349372130 4.53223765723249 4.38593556347417 4.30788653976849 4.21489404354775 4.13896155683814 4.04761057919058 3.97343861896840 3.88380791431601 3.81145572958171 3.72321278855674 3.65248256565933 3.56554845984340 3.49611066175255 3.41028887692785 3.34208722089153 3.25703483376744 3.18988166595382 3.10555063739702 3.03909689484528 2.95529424208789 2.88950910475860 2.80586435451835 2.74055692487961 2.65704330447796 2.59182865887199 2.50824443537215 2.44310856195040 2.35904012024132 2.29377711398673 2.20921138717406 2.14338484072475 2.05810030152075 1.99170571681542 1.90523023385272 1.83803530854445 1.75036282366512 1.68186340586992 1.59274129958001 1.52293500538806 1.43181584274178 1.36043134436352 1.26730842064841 1.19375489161208 1.09833091805836 1.02259853961520 0.924230047313610 0.845992014686047 0.744660420787891 0.663214748833869 0.558558963490718 0.473873300774375 0.365125453900602 0.276793390458048 0.163903817888791 0.0710773290319623 -0.0464086112329329 -0.143810447273906 -0.266827422309978 -0.369019019797513 -0.497371386259626 -0.605389113134284 -0.739668478600106 -0.853680748353134 -1.02732754506767 -1.17943460642189 -1.35812832257705 -1.51628779676679 -1.70083670448653;];

%% L = 100.00km, P0 = 5.00mW, mIM = 2.00%, Nit = 1000, kappa = 15 GHz/mW
maxkP.pap1 = [0.003052249825104 -0.074352931472402 0.728837489382649 -3.726802408605886 10.686307639083228 -20.289562255581316 22.332021513547270];
maxkP.pap2 = [0.003006022567868 -0.073015943904778 0.713311453810235 -3.638075282276911 10.417046934906840 -19.783156615365030 22.200175622630283];
maxkP.pteo = [0.003550871833274 -0.084592131811788 0.805836690830837 -3.970165553926077 10.851456805104773 -19.469357467131665 21.167358646867285];

maxkP.SIReva3 = [16.6266456502262 15.6157615407454 14.7766072863913 14.0604004716944 13.4344268830274 12.8762588712287 12.3616976701560 11.8712636938325 11.4308553916543 11.0008611899592 10.6104520124425 10.2229402027046 9.86900236068909 9.51355199481039 9.18796017522606 8.85803106056019 8.55552824998894 8.24678552124951 7.96368001444385 7.67299064108704 7.40662747924796 7.13156320005804 6.87985001840024 6.61857666262285 6.37976526744962 6.13074313076260 5.90349345702795 5.66536265549816 5.44849358170603 5.22022662997945 5.01264383632472 4.79329856105064 4.59420608948546 4.38287042336619 4.19150599605454 3.98755725211497 3.80314543539668 3.60595780071063 3.42801421727236 3.23705356605882 3.06506455027848 2.87968693569244 2.71304982704989 2.53295514235247 2.37139043406613 2.19603993528647 2.03918012440816 1.86837273165673 1.71571977471490 1.54914250384164 1.40056019014247 1.23774409977646 1.09296090931320 0.933825882351700 0.792390443510805 0.636698292232080 0.498578572977585 0.345886407371398 0.210869461528327 0.0616381007936126 -0.0702482719907220 -0.247663655494221 -0.376475167924514 -0.519997746721463 -0.646448868962181 -0.787955961119326 -0.912531020460906 -1.05172607373440 -1.17407950370803 -1.31143862213010 -1.43173780281801 -1.56713162769058 -1.68587246547847 -1.81946911045210 -1.93649629422318 -2.06882026650423 -2.18430206501277 -2.31517837864377 -2.42966721233578 -2.55927029194564 -2.67256797624285 -2.80148650622853 -2.91377283435203 -3.04179090472212 -3.15369023217339 -3.28099792261416 -3.39227338560585 -3.51953832652463 -3.63039048426384 -3.75735899059409 -3.86849969217303 -3.99538631863537 -4.10654325697945 -4.23411044882837 -4.34551482815897 -4.47347422103545 -4.58594271781675 -4.71454382758184 -4.82777312894238 -4.95789197031655 -5.07215617608568 -5.20347517982807 -5.31971754904364 -5.45253535153217 -5.57042921180487 -5.70576009226232 -5.82564022537329 -5.96314773385798 -6.08611285689990 -6.22616641181101 -6.35188140034083 -6.49566764572576 -6.62455497868880 -6.77173890588609 -6.90509443569532 -7.05615042411947 -7.19365822570591 -7.34999630740080 -7.49175614437369 -7.65262825380916 -7.80019026666956 -7.96623300086898 -8.11935154569078 -8.30891565666701 -8.48439448493422 -8.67929941083091 -8.86176664298869 -9.06293925323145;];
maxkP.SIReva4 = [16.6265092093547 15.6155131959670 14.7761925138278 14.0597521322328 13.4334645428340 12.8748892887687 12.3598174139022 11.8687660604401 11.4276013133824 10.9967253353928 10.6052629982709 10.2165554210340 9.86121428245319 9.50420198161306 9.17679988146283 8.84488740104071 8.54010676149280 8.22890053269652 7.94298567155441 7.64929119460729 7.37951974668595 7.10084547296932 6.84505562207004 6.57950221969965 6.33587556092122 6.08183836686107 5.84896362661033 5.60501962695182 5.38164572068847 5.14670497930848 4.93167213607268 4.70473408040690 4.49718107779503 4.27728205850224 4.07638766332612 3.86285481954186 3.66779317013374 3.45995863779167 3.27019467471664 3.06748787684959 2.88246874749100 2.68422724821075 2.50332755811806 2.30922753336532 2.13213763090462 1.94163813473929 1.76797634941610 1.58086706255896 1.41013991525372 1.22611491736291 1.05817936550765 0.876798181146145 0.711392977854445 0.532585564751502 0.369296265433029 0.192853397797471 0.0316552250483133 -0.142810867149501 -0.302102789785134 -0.474166093706866 -0.631519256265483 -0.828652436225194 -0.983921676519489 -1.15202150625688 -1.30596581072715 -1.47282995215010 -1.62582902653554 -1.79116613244805 -1.94289831330362 -2.10708518015313 -2.25766872712653 -2.42056770443758 -2.57038901734597 -2.73211210265217 -2.88101843985912 -3.04196842153399 -3.19007960823454 -3.35009332775634 -3.49783127107648 -3.65703591787892 -3.80423469123482 -3.96307746569899 -4.10987248750002 -4.26818500755047 -4.41505951644936 -4.57299335386177 -4.71977019367947 -4.87783523355529 -5.02468562603700 -5.18271169303827 -5.33017715500572 -5.48835585317551 -5.63627552846005 -5.79518660349716 -5.94376940509383 -6.10325995527943 -6.25313204344825 -6.41343628860867 -6.56444823774339 -6.72623717734098 -6.87865924012861 -7.04179623241510 -7.19634089512761 -7.36112862559206 -7.51768410219051 -7.68488776571212 -7.84378740375658 -8.01331657045250 -8.17539465688547 -8.34762506359754 -8.51281100285942 -8.68864353694935 -8.85737693323670 -9.03678220790416 -9.21003871995442 -9.39351801257652 -9.57132983658088 -9.75994822098659 -9.94262561697079 -10.1362239324617 -10.3249657777207 -10.5242183383534 -10.7192041026454 -10.9339773676233 -11.1440676191821 -11.3651109074123 -11.5827731728163 -11.8110865927099];
maxkP.SIReva5 = [16.6265084056524 15.6155112307496 14.7761882851788 14.0597438811108 13.4334496378621 12.8748639879507 12.3597766861380 11.8687034775153 11.4275081815110 10.9965914481002 10.6050748184676 10.2162979222134 9.86086762289646 9.50374521759107 9.17620518457545 8.84412678064656 8.53914246834004 8.22769636357230 7.94149179887383 7.64746203875689 7.37729094000252 7.09816103533373 6.84183390058550 6.57567584318924 6.33134275646123 6.07651952617552 5.84273363037693 5.59778633511177 5.37325718075774 5.13705623872057 4.92058128214214 4.69208336523525 4.48275484985582 4.26095113434615 4.05789863256612 3.84206803045912 3.64441484385765 3.43383993841114 3.24099739209875 3.03505683140380 2.84641795250176 2.64439997975102 2.45928700145595 2.26081663354216 2.07886559349320 1.88335546676910 1.70413343271981 1.51132515723911 1.33429300433683 1.14383758918530 0.968804421178555 0.780226311365882 0.606889891017313 0.420080617646990 0.247995846076649 0.0627165014616739 -0.108177230576067 -0.292331269755611 -0.462243834686061 -0.644889655647254 -0.813818935226162 -1.02125770227432 -1.18901403931641 -1.36944013892901 -1.53683449847466 -1.71690822243520 -1.88430399155071 -2.06375379651536 -2.23085320736315 -2.41003051088293 -2.57694497779008 -2.75571871428948 -2.92280051306516 -3.10126814710711 -3.26837089384551 -3.44688944407897 -3.61411402619525 -3.79252545041536 -3.96023917177770 -4.13864707859942 -4.30669054076418 -4.48547797074117 -4.65396016177474 -4.83296829647487 -5.00229783525567 -5.18165010568230 -5.35166447183667 -5.53178932607549 -5.70262903869035 -5.88337780280886 -6.05549302190804 -6.23702751520915 -6.41028384046525 -6.59308566466512 -6.76766099055307 -6.95161445974999 -7.12802450922540 -7.31333611156752 -7.49147711794201 -7.67870098583464 -7.85881209154953 -8.04787136243160 -8.23053707614884 -8.42170817184436 -8.60688375128385 -8.80079775790135 -8.98879003261402 -9.18544065842892 -9.37693386284501 -9.57667692145328 -9.77169722739716 -9.97527721429300 -10.1742399331974 -10.3817428370840 -10.5854532311379 -10.7973633680653 -11.0059774118267 -11.2231829898414 -11.4370806177936 -11.6596548545165 -11.8798428754953 -12.1084580650594 -12.3352842458056 -12.5769161219143 -12.8166153228039 -13.0650677575712 -13.3126789857766 -13.5689687188678;];

% Gráficos
fig = figure;
fig1 = plot(FF, polyval(maxkP.pteo, FF), '-k', FF, polyval(maxkP.pap1, FF), '-r', FF, polyval(maxkP.pap2,FF), '-m', FF, maxkP.SIReva3, '*b', FF, maxkP.SIReva4, 'pg', FF, maxkP.SIReva5, 'hc');
hold on
fig2 = plot(FF, polyval(medkP.pteo, FF), '-k', FF, polyval(medkP.pap1, FF), '-r', FF, polyval(medkP.pap2,FF), '-m', FF, medkP.SIReva3, '*b');
fig3 = plot(FF, polyval(minkP.pteo, FF), '-k', FF, polyval(minkP.pap1, FF), '-r', FF, polyval(minkP.pap2,FF), '-m', FF, minkP.SIReva3, '*b');
leg = legend('Simulação Sem Aproximações', 'Simulação Log Linear', 'Simulação Log Quadrático', 'Modelo Analítico (3ª ordem)', 'Modelo Analítico (4ª ordem)', 'Modelo Analítico (5ª ordem)');
set(gca, 'FontSize', 12)
set(fig, 'Position', [100 100 640 500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
axis([0 7 -15 30])
set(fig1(1:3), 'LineWidth', 2)
set(fig2(1:3), 'LineWidth', 2)
set(fig3(1:3), 'LineWidth', 2)
set(gca, 'xtick', 0:7)
% set(fig3(1:3), 'LineWidth', 2)
grid on
set(leg,'Position',[0.466936879571577 0.657 0.428125 0.257333333333333]);
% Create textbox
annotation(fig,'textbox', [0.701401645768025 0.2645490250826 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 75 GHz'}, 'FontSize',14,  'FitBoxToText','off',  'LineStyle','none');
annotation(fig,'textbox', [0.657105015673973 0.526063195123087 0.236677115987461 0.0850202429149798], 'String',{'\kappa P_0 = 10 GHz'},...
    'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
annotation(fig,'textbox', [0.699810736677117 0.40407129228908 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 40 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');

cd('../../DissertacaoPG/figuras/matlab')
saveas(fig, 'OFDM_Gen_100km.fig')
cd ..
saveas(fig, 'OFDM_Gen_100km', 'epsc');
cd('../../codigos/Graficos')

%% L = 20.00km, P0 = 1.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
minkP.pap1 = [-0.017892455514170 0.292416863249991 -1.539278468262029 2.596218339861743 -0.157027751962245 -0.804260152528711 25.645782246583238];
minkP.pap2 = [-0.016348814487464 0.300451833355659 -2.012859927578402 6.197870821686931 -9.699709919587514 7.026838506943556 23.572421300066658];
minkP.pteo = [-0.015579084911346 0.250777396634006 -1.287780336259562 1.674097064920333 5.240329218095554 -21.736882694354204 52.136926865901310];

minkP.SIReva3 = [46.7999347283252 45.4464180500754 44.2652429070897 43.2143475979657 42.2651000310372 41.3971592682401 40.5867785550849 39.8140502911908 39.1053031678588 38.4188977162071 37.7839438609046 37.1616729772622 36.5825428260665 36.0096914447057 35.4741825963103 34.9405396510060 34.4400234727204 33.9382350260665 33.4663990776727 32.9909968383213 32.5430838860719 32.0898841352790 31.6622111772287 31.2279285255097 30.8175723115635 30.3995631867637 30.0041488382198 29.6002368865545 29.2177917959074 28.8261465429598 28.4549976055954 28.0740477633494 27.7127479554034 27.3411188037773 26.9883930141788 26.6248606782923 26.2795656760098 25.9230222729844 25.5841169994503 25.2335471414311 24.9000696136648 24.5545202169181 24.2255688893847 23.8841486375815 23.5588702044658 23.2207275871121 22.8983058913555 22.5626235210482 22.2422721694816 21.9082602255528 21.5892189209407 21.2561121578062 20.9376447711558 20.6047039587882 20.2861011907990 19.9526173608329 19.6332056598629 19.2985111826808 18.9776669623515 18.6411641691293 18.3183476154673 17.8861285362725 17.5564613191078 17.2105832213035 16.8777265471965 16.5284812431761 16.1923902644013 15.8399080092341 15.5009412042988 15.1458301277557 14.8049326755193 14.4485179901036 14.1074968297619 13.7521355713983 13.4140257550692 13.0635186863236 12.7330370986726 12.3931192752487 12.0771649460819 11.7559826564506 11.4640473719183 11.1724254522153 10.9166296563411 10.6677789725600 10.4621322972085 10.2703674030681 10.1288972033666 10.0071840018274 9.94102409128565 9.89785680511721 9.91224071183142 9.94914365432611 10.0417931220619 10.1528384612334 10.3146905524439 10.4883284707370 10.7061694647296 10.9282875695717 11.1878666366302 11.4446200359366 11.7329840573790 12.0125534264128 12.3192094366615 12.6124351095570 12.9295771154498 13.2298664004026 13.5520675531285 13.8549779789144 14.1787058346900 14.4814397503013 14.8045870856586 15.1055470974373 15.4270248585674 15.7254753955856 16.0449106061364 16.3407102710647 16.6582443061270 16.9516650232805 17.2678043395985 17.5594370050716 17.8749400998352 18.1655858955476 18.4814329607487 18.6085539673194 18.7577382800841 18.8793871634145 19.0223065464406 19.1388248727252;];
minkP.SIReva4 = [46.7999347251455 45.4464180441203 44.2652428968276 43.2143475813852 42.2651000055633 41.3971592306927 40.5867785016850 39.8140502177274 39.1053030687807 38.4188975859619 37.7839436920454 37.1616727628063 36.5825425563725 36.0096911113073 35.4741821870516 34.9405391559128 34.4400228767762 33.9382343177895 33.4663982388040 32.9909958558974 32.5430827381657 32.0898828074904 31.6622096434953 31.2279267700554 30.8175703036685 30.3995609093676 30.0041462553570 29.6002339799913 29.2177885237885 28.8261428860091 28.4549935153734 28.0740432197034 27.7127429024962 27.3411132207910 26.9883868370259 26.6248538857064 26.2795581946961 25.9230140815245 25.5841080142068 25.2335373411883 24.9000589033709 24.5545085759549 24.2255562099896 23.8841349001571 23.5588552869914 23.2207114715702 22.8982884399413 22.5626047178271 22.2422518590890 21.9082383948669 21.5891953949235 21.2560869268897 20.9376176384593 20.6046749189466 20.2860700225518 19.9525840639683 19.6331699855941 19.2984731367555 18.9776262651909 18.6411208330806 18.3183013263118 17.8860804010027 17.5564100299397 17.2105288187761 16.8776686666448 16.5284199392263 16.1923251325751 15.8398391206326 15.5008681101364 15.1457529180644 14.8048508532620 14.4484316666800 14.1074054552817 13.7520392820198 13.4139239422041 13.0634115144945 12.7329238951661 12.3930002359740 12.0770393281165 11.7558506915914 11.4639082391097 11.1722794240592 10.9164758262916 10.6676176579089 10.4619624904610 10.2701894743958 10.1287100421777 10.0069880359850 9.94081809360930 9.89764126624722 9.91201427632305 9.94890688332754 10.0415445158962 10.1525786605487 10.3144178978964 10.4880436888153 10.7058707196246 10.9279756835540 11.1875395739820 11.4442787266202 11.7326262424017 12.0121801513266 12.3188181938702 12.6120270725628 12.9291494921312 13.2294205080748 13.5516002779401 13.8544907912196 14.1781952582655 14.4809074236975 14.8040291121393 15.1049653041079 15.4264148650550 15.7248392274015 16.0442433288317 16.3400141255756 16.6575137024432 16.9509024428594 17.2670034195479 17.5586004740460 17.8740606888920 18.1646665952413 18.4804654021539 18.6075795355044 18.7567509943272 18.8783931795519 19.0212999636972 19.1378117150933;];

%% L = 20.00km, P0 = 4.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
medkP.pap1 = [-0.002306208967047 0.050353846609772 -0.450216910508403 2.110264359688225 -4.865938106141045 1.659309938484769 24.838526422236340];%[-0.002910383488937 0.063999504483121 -0.563807678033200 2.502497505234520 -5.218112364263532 1.062063142317227 24.997632058600864];
medkP.pap2 = [-0.003085970798703 0.065212090415579 -0.555549663903551 2.414261538541877 -4.852114711354080 0.927466408248591 25.006113088963860]; %[-0.003227388835859 0.069735539170034 -0.599589650421725 2.548487393137526 -4.781955120687831 0.132939549659921 25.195209984657666];
medkP.pteo = [0.004339246308254 -0.110658147064741 1.112634399457544 -5.683950832473555 16.472920675535075 -28.703475768069406 41.651067568587024]; %[0.004254208838970 -0.107427430856300 1.076328372730628 -5.535403887297697 16.262336791701415 -28.490410429371913 40.592791719080680];
medkP.SIReva3 = [34.8862239176036 33.5774724500161 32.4472652253879 31.4533149930517 30.5667558570160 29.7670071045519 29.0295329300774 28.3333101388861 27.7067475507742 27.1052890311010 26.5607979859324 26.0309392802949 25.5496308633605 25.0757794120687 24.6446313941054 24.2158106193610 23.8254854468704 23.4336968612643 23.0772885562628 22.7165400174190 22.3888162049400 22.0545178638073 21.7514333644155 21.4400095540619 21.1583860400487 20.8670087726162 20.6043209144731 20.3307269530935 20.0849450442990 19.8273117620715 19.5967907880654 19.3536367751315 19.1370419023862 18.9071561248616 18.7033956589039 18.4857921526015 18.2939701366533 18.0878396219748 17.9072286732921 17.7119108968312 17.5419151045717 17.3568618016599 17.1969912288742 17.0217669847617 16.8716317332658 16.7058742385310 16.5651562703009 16.4085804687136 16.2770186061034 16.1293905016445 16.0067841057672 15.8679081819037 15.7540914009337 15.6238182815207 15.5186492111901 15.3968496194548 15.3002215794548 15.1867767504910 15.0985914690702 14.9934322852884 14.9136179985227 14.7564363234618 14.6833902419162 14.5931962497853 14.5281653470762 14.4457727884499 14.3886328126127 14.3139436656855 14.2645954829758 14.1974617513111 14.1557688055716 14.0960478711390 14.0618456076046 14.0093670497117 13.9824968145542 13.9370592063916 13.9173331971201 13.8787423669794 13.8659414415264 13.8339732674904 13.8278896074189 13.8022884859840 13.8026858086217 13.7832117352532 13.7898243825745 13.7762101699794 13.7887945849333 13.7807451014984 13.7990335437160 13.7962815862933 13.8199815056516 13.8222375745198 13.8510919066742 13.8580432225051 13.8917757309126 13.9031510411125 13.9414650903378 13.9569751937661 13.9996232221092 14.0189590395509 14.0656778411295 14.0885847765691 14.1390931523803 14.1653008159418 14.2193791275919 14.2485981265586 14.3060120874657 14.3380191149886 14.3985161686663 14.4330715777110 14.4964719502746 14.5333152389705 14.5994229327135 14.6383701853044 14.7069681608725 14.7478161516554 14.8187706879065 14.8612911746964 14.9345020341268 14.9786092337079 15.0539054582259 15.0994415795750 15.1767470810460 15.1302522184117 15.1150653302012 15.0694788630466 15.0544478306238 15.0096139489422]; %[33.8701849006626 32.5639570987983 31.4366583195384 30.4460005443529 29.5631170902755 28.7674265314457 28.0343847383643 27.3429550527683 26.7215778655654 26.1256576507248 25.5870997997800 25.0635185183788 24.5888852563931 24.1220435228218 23.6983057965319 23.2772188234538 22.8950307694114 22.5116905343412 22.1641356414674 21.8125380871330 21.4943713687868 21.1699116116458 20.8770718980904 20.5761563998438 20.3054451777935 20.0252236868391 19.7740917194879 19.5122734684510 19.2786616141255 19.0333919005052 18.8156192945794 18.5853780446759 18.3820686339576 18.1655987044489 17.9756119532709 17.7718752775336 17.5942580098497 17.4023847921775 17.2363459847642 17.0556073132927 16.9004784882324 16.7302484404662 16.5854577088945 16.4252166770102 16.2902861865631 16.1395777481768 16.0140928153918 15.8725327749867 15.7561272274467 15.6233747620601 15.5157395325802 15.3914853417195 15.2923400213451 15.1763197859154 15.0854028964391 14.9773684604369 14.8944553771348 14.7941665760140 14.7190397287294 14.6263146681946 14.5587872169554 14.4149037516533 14.3534270040368 14.2740501073947 14.2196197258851 14.1470133612244 14.0994074253212 14.0333877851647 13.9924271253862 13.9327650739004 13.8982406302260 13.8447301214968 13.8164151734597 13.7688334742565 13.7465266926328 13.7046313153588 13.6881138972049 13.6516900884869 13.6407231051925 13.6095376010718 13.6039139758859 13.5777124244852 13.5772068856635 13.5557704497391 13.5601371060647 13.5432283230438 13.5522619814960 13.5396221263107 13.5530996322133 13.5445149447988 13.5621924919670 13.5574307272851 13.5791151488433 13.5779224542393 13.6034025617402 13.6055801019392 13.6346233928078 13.6399532342012 13.6723880769655 13.6806293205630 13.7162649641463 13.7272418402369 13.7658643437531 13.7793801157095 13.8208466495186 13.8366788863332 13.8808250909678 13.8988265926098 13.9454616766711 13.9654610510418 14.0144757019513 14.0362717487204 14.0875314490192 14.1110085340325 14.1643478301872 14.1893616730021 14.2447074416776 14.2710786079070 14.3283871415485 14.3560945510156 14.4152350627019 14.4441698330083 14.5051164657611 14.4468504376006 14.4202952305671 14.3630548219755 14.3368129898248 14.2804780941522;];
medkP.SIReva4 = [34.8862238877041 33.5774723934970 32.4472651270293 31.4533148324466 30.5667556075306 29.7670067325202 29.0295323946567 28.3333093934772 27.7067465328073 27.1052876762713 26.5607962065716 26.0309369918025 25.5496279473115 25.0757757613190 24.6446268531533 24.2158050567330 23.8254786629570 23.4336886990260 23.0772787641852 22.7165284123478 22.3888024747715 22.0545017995447 21.7514145837613 21.4399878232964 21.1583608960625 20.8669799591642 20.6042878758836 20.3306894138742 20.0849023431151 19.8272636088619 19.5967364018763 19.3535758569042 19.1369735356688 18.9070800092321 18.7033107251470 18.4856981076744 18.2938657397721 18.0877245978490 17.9071015879083 17.7117715053682 17.5417617585011 17.3566943022451 17.1968076884323 17.0215672648629 16.8714136787183 16.7056377913356 16.5648989784467 16.4083023749031 16.2767169298822 16.1290654100069 16.0064324541613 15.8675302882211 15.7536837177054 15.6233813063388 15.5181789532849 15.3963467867905 15.2996816898772 15.1862007566076 15.0979743456468 14.9927752642249 14.9129154598718 14.7557004529790 14.6826051601024 14.5923638849126 14.5272789594469 14.4448347375086 14.3876356258229 14.3128901796766 14.2634774194314 14.1962824868351 14.1545191869988 14.0947318800132 14.0604531471533 14.0079027756255 13.9809495996980 13.9354344646418 13.9156186780957 13.8769443218941 13.8640464143325 13.8319884276974 13.8258001831666 13.8001026806159 13.8003874172792 13.7808100863951 13.7873017098990 13.7735770458651 13.7860315809404 13.7778641663634 13.7960134242249 13.7931357287874 13.8166867135124 13.8188089143054 13.8475040586009 13.8543130695615 13.8878756386591 13.8990998456829 13.9372326996883 13.9525825606498 13.9950375658603 14.0142036706635 14.0607170424632 14.0834443992506 14.1337343707701 14.1597522056652 14.2135984534855 14.2426170229674 14.2997845876780 14.3315801165220 14.3918157619445 14.4261481723039 14.4892712997226 14.5258796787692 14.5916934544861 14.6303933071312 14.6986798482333 14.7392674055387 14.8098918977232 14.8521384002807 14.9249994270481 14.9688181885531 15.0437436318236 15.0889761171605 15.1658883965001 15.1193164879100 15.1039707183939 15.0583110165268 15.0431249168017 14.9982216797586;];

%% L = 20.00km, P0 = 5.00mW, mIM = 2.00%, Nit = 1000, kappa = 15.00
maxkP.pap1 = [-0.001859757356900 0.037581232573360 -0.279272384139595 0.830959919672612 0.121662244898997 -7.096355020448891 26.538525826268433];
maxkP.pap2 = [-0.001715259590717 0.033837863435167 -0.238947342865870 0.596790372180027 0.852390631559927 -7.808084880111682 26.643334037016295];
maxkP.pteo = [0.004963520949517 -0.122191646995523 1.210194426947580 -6.216860698164780 17.912096134782850 -29.316785789822160 36.369681397155990];

maxkP.SIReva3 = [29.4828632145873 28.1943321439404 27.0873067489024 26.1194407176456 25.2618024450163 24.4937402964799 23.7906210729025 23.1313044764545 22.5442024468027 21.9845615617945 21.4842696114488 21.0007559803718 20.5679894716300 20.1446013059366 19.7659202985138 19.3912510063632 19.0568840642936 18.7224953012598 18.4250899322102 18.1245403653322 17.8584164882898 17.5866609507924 17.3473223072113 17.1003358293533 16.8841515587635 16.6586577662879 16.4626616315019 16.2559505133822 16.0776754012604 15.8874935597937 15.7248602442848 15.5493004010198 15.4005591429182 15.2379882227842 15.1016376754780 14.9506698123363 14.8254080791456 14.6848393585012 14.5695577392464 14.4383442445321 14.3320707590736 14.2092858066804 14.1111569782454 13.9960136539600 13.9052967806300 13.7970774247506 13.7131168342589 13.6112153122997 13.5334159740360 13.4372833784662 13.3651492551455 13.2742801511263 13.2073572319296 13.1213359344317 13.0592004486390 12.9776405257755 12.9199527266638 12.8424864779578 12.7889257213380 12.7153192533422 12.6656323120095 12.5430951658589 12.4962170199730 12.4288744265353 12.3852799695066 12.3208952623747 12.2803408506235 12.2187670503491 12.1811231400214 12.1221445120298 12.0872423661439 12.0307219269679 11.9983758531152 11.9441618767840 11.9142674393155 11.8621857666169 11.8346190532602 11.7845795362540 11.7591896859574 11.7110780228103 11.6878020435799 11.6414720641240 11.6202186253891 11.5756159515082 11.5562578060319 11.5132954342497 11.4958020946822 11.4543524270184 11.4386568817587 11.3986939676567 11.3846847978233 11.3461420263927 11.3338154187844 11.2965771109725 11.2858847991712 11.2499486240042 11.2407895422863 11.2061045557315 11.1984978924618 11.1649555354791 11.1588680569180 11.1264865759379 11.1218236709902 11.0905645701464 11.0873663098289 11.0571246016927 11.0553703952199 11.0261831360009 11.0257820293199 10.9976210155500 10.9986330129356 10.9713941331107 10.9738098830205 10.9475481939383 10.9512783887117 10.9259746051209 10.9310991822705 10.9066479533765 10.9132668280884 10.8898431357986 10.8978798377229 10.8754839809516 10.8850528593414 10.7918403010225 10.7306837227778 10.6389940664102 10.5787352854414 10.4885204364166;];

fig = figure;
fig1 = plot(FF, polyval(maxkP.pteo, FF), '-k', FF, polyval(maxkP.pap1, FF), '-r', FF, polyval(maxkP.pap2,FF), '-m', FF, maxkP.SIReva3, '*b');
hold on
fig2 = plot(FF, polyval(medkP.pteo, FF), '-k', FF, polyval(medkP.pap1, FF), '-r', FF, polyval(medkP.pap2,FF), '-m', FF, medkP.SIReva3, '*b');
% fig3 = plot(FF, polyval(minkP.pteo, FF), '-k', FF, polyval(minkP.pap1, FF), '-r', FF, polyval(minkP.pap2,FF), '-m', FF, minkP.SIReva3, '*b');
leg = legend('Simulação Sem Aproximações', 'Simulação Log Linear', 'Simulação Log Quadrático', 'Modelo Analítico (3ª ordem)');
set(gca, 'FontSize', 12)
set(fig, 'Position', [100 100 640 500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
axis([0 7 10 35])
set(fig1(1:3), 'LineWidth', 2)
set(fig2(1:3), 'LineWidth', 2)
% set(fig3(1:3), 'LineWidth', 2)
set(gca, 'xtick', 0:7)
% set(fig3(1:3), 'LineWidth', 2)
grid on
set(leg,'Position',[0.466936879571577 0.657 0.428125 0.257333333333333]);
% Create ellipse
annotation(fig,'ellipse', [0.726000000000002 0.226 0.0396249999999993 0.232]);
% Create textbox
annotation(fig,'textbox', [0.621167515673976 0.424063195123087 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 40 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
% Create ellipse
annotation(fig,'ellipse',[0.399437500000006 0.202 0.0302499999999998 0.0960000000000002]);
% Create textbox
annotation(fig,'textbox', [0.282651645768026 0.1205490250826 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 75 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');

cd('../../DissertacaoPG/figuras/matlab')
saveas(fig, 'OFDM_Gen_20km.fig')
cd ..
saveas(fig, 'OFDM_Gen_20km', 'epsc');
cd('../../codigos/Graficos')

%%
%%%%%%%%%%%%%%%%%%%%%%% Interferência da Raiz Quadrada %%%%%%%%%%%%%%%%%%%%
%% L = 20.00km, P0 = 1.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
%% L = 20.00km, P0 = 4.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
medkP.pteo = [0.004339246308254 -0.110658147064741 1.112634399457544 -5.683950832473555 16.472920675535075 -28.703475768069406 41.651067568587024]; %[0.004254208838970 -0.107427430856300 1.076328372730628 -5.535403887297697 16.262336791701415 -28.490410429371913 40.592791719080680];
medkP.pap1 = [-0.002306208967047 0.050353846609772 -0.450216910508403 2.110264359688225 -4.865938106141045 1.659309938484769 24.838526422236340];%[-0.002910383488937 0.063999504483121 -0.563807678033200 2.502497505234520 -5.218112364263532 1.062063142317227 24.997632058600864];
medkP.SIReva3 = [34.8862239176036 33.5774724500161 32.4472652253879 31.4533149930517 30.5667558570160 29.7670071045519 29.0295329300774 28.3333101388861 27.7067475507742 27.1052890311010 26.5607979859324 26.0309392802949 25.5496308633605 25.0757794120687 24.6446313941054 24.2158106193610 23.8254854468704 23.4336968612643 23.0772885562628 22.7165400174190 22.3888162049400 22.0545178638073 21.7514333644155 21.4400095540619 21.1583860400487 20.8670087726162 20.6043209144731 20.3307269530935 20.0849450442990 19.8273117620715 19.5967907880654 19.3536367751315 19.1370419023862 18.9071561248616 18.7033956589039 18.4857921526015 18.2939701366533 18.0878396219748 17.9072286732921 17.7119108968312 17.5419151045717 17.3568618016599 17.1969912288742 17.0217669847617 16.8716317332658 16.7058742385310 16.5651562703009 16.4085804687136 16.2770186061034 16.1293905016445 16.0067841057672 15.8679081819037 15.7540914009337 15.6238182815207 15.5186492111901 15.3968496194548 15.3002215794548 15.1867767504910 15.0985914690702 14.9934322852884 14.9136179985227 14.7564363234618 14.6833902419162 14.5931962497853 14.5281653470762 14.4457727884499 14.3886328126127 14.3139436656855 14.2645954829758 14.1974617513111 14.1557688055716 14.0960478711390 14.0618456076046 14.0093670497117 13.9824968145542 13.9370592063916 13.9173331971201 13.8787423669794 13.8659414415264 13.8339732674904 13.8278896074189 13.8022884859840 13.8026858086217 13.7832117352532 13.7898243825745 13.7762101699794 13.7887945849333 13.7807451014984 13.7990335437160 13.7962815862933 13.8199815056516 13.8222375745198 13.8510919066742 13.8580432225051 13.8917757309126 13.9031510411125 13.9414650903378 13.9569751937661 13.9996232221092 14.0189590395509 14.0656778411295 14.0885847765691 14.1390931523803 14.1653008159418 14.2193791275919 14.2485981265586 14.3060120874657 14.3380191149886 14.3985161686663 14.4330715777110 14.4964719502746 14.5333152389705 14.5994229327135 14.6383701853044 14.7069681608725 14.7478161516554 14.8187706879065 14.8612911746964 14.9345020341268 14.9786092337079 15.0539054582259 15.0994415795750 15.1767470810460 15.1302522184117 15.1150653302012 15.0694788630466 15.0544478306238 15.0096139489422]; %[33.8701849006626 32.5639570987983 31.4366583195384 30.4460005443529 29.5631170902755 28.7674265314457 28.0343847383643 27.3429550527683 26.7215778655654 26.1256576507248 25.5870997997800 25.0635185183788 24.5888852563931 24.1220435228218 23.6983057965319 23.2772188234538 22.8950307694114 22.5116905343412 22.1641356414674 21.8125380871330 21.4943713687868 21.1699116116458 20.8770718980904 20.5761563998438 20.3054451777935 20.0252236868391 19.7740917194879 19.5122734684510 19.2786616141255 19.0333919005052 18.8156192945794 18.5853780446759 18.3820686339576 18.1655987044489 17.9756119532709 17.7718752775336 17.5942580098497 17.4023847921775 17.2363459847642 17.0556073132927 16.9004784882324 16.7302484404662 16.5854577088945 16.4252166770102 16.2902861865631 16.1395777481768 16.0140928153918 15.8725327749867 15.7561272274467 15.6233747620601 15.5157395325802 15.3914853417195 15.2923400213451 15.1763197859154 15.0854028964391 14.9773684604369 14.8944553771348 14.7941665760140 14.7190397287294 14.6263146681946 14.5587872169554 14.4149037516533 14.3534270040368 14.2740501073947 14.2196197258851 14.1470133612244 14.0994074253212 14.0333877851647 13.9924271253862 13.9327650739004 13.8982406302260 13.8447301214968 13.8164151734597 13.7688334742565 13.7465266926328 13.7046313153588 13.6881138972049 13.6516900884869 13.6407231051925 13.6095376010718 13.6039139758859 13.5777124244852 13.5772068856635 13.5557704497391 13.5601371060647 13.5432283230438 13.5522619814960 13.5396221263107 13.5530996322133 13.5445149447988 13.5621924919670 13.5574307272851 13.5791151488433 13.5779224542393 13.6034025617402 13.6055801019392 13.6346233928078 13.6399532342012 13.6723880769655 13.6806293205630 13.7162649641463 13.7272418402369 13.7658643437531 13.7793801157095 13.8208466495186 13.8366788863332 13.8808250909678 13.8988265926098 13.9454616766711 13.9654610510418 14.0144757019513 14.0362717487204 14.0875314490192 14.1110085340325 14.1643478301872 14.1893616730021 14.2447074416776 14.2710786079070 14.3283871415485 14.3560945510156 14.4152350627019 14.4441698330083 14.5051164657611 14.4468504376006 14.4202952305671 14.3630548219755 14.3368129898248 14.2804780941522;];
medkP.praiz2 = [0.005380088370569 -0.131658289092750 1.271651823837005 -6.218276880132248 17.051954180132500 -28.779091540975816 41.431624497879310];
medkP.praiz3 =

fig = figure;
fig1 = plot(FF, polyval(maxkP.pteo, FF), '-k', FF, polyval(medkP.pap1, FF), '-r', FF, polyval(medkP.praiz2, FF), '-g', FF, polyval(medkP.praiz3, FF), '-c', FF, maxkP.SIReva3, '*b');
leg = legend('Simulação Sem Aproximações', 'Simulação Aprox. Linear da Raiz', 'Simulação Aprox. Quadrática da Raiz', 'Simulação Aprox. Cúbica da Raiz', 'Modelo Analítico (3ª ordem)');
set(gca, 'FontSize', 12)
set(fig, 'Position', [100 100 640 500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
axis([0 7 10 35])
set(fig1(1:3), 'LineWidth', 2)
set(fig2(1:3), 'LineWidth', 2)
% set(fig3(1:3), 'LineWidth', 2)
set(gca, 'xtick', 0:7)
% set(fig3(1:3), 'LineWidth', 2)
grid on
set(leg,'Position',[0.466936879571577 0.657 0.428125 0.257333333333333]);
% % Create ellipse
% annotation(fig,'ellipse', [0.726000000000002 0.226 0.0396249999999993 0.232]);
% % Create textbox
% annotation(fig,'textbox', [0.621167515673976 0.424063195123087 0.236677115987461 0.0850202429149798],...
%     'String',{'\kappa P_0 = 40 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
% % Create ellipse
% annotation(fig,'ellipse',[0.399437500000006 0.202 0.0302499999999998 0.0960000000000002]);
% % Create textbox
% annotation(fig,'textbox', [0.282651645768026 0.1205490250826 0.236677115987461 0.0850202429149798],...
%     'String',{'\kappa P_0 = 75 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
% 
% cd('../../DissertacaoPG/figuras/matlab')
% saveas(fig, 'OFDM_Gen_20km.fig')
% cd ..
% saveas(fig, 'OFDM_Gen_20km', 'epsc');
% cd('../../codigos/Graficos')
