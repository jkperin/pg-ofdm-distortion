clear, clc, close all

%% OFDM GbE
addpath('PGresultados')
load resultados_GbE

% for k= 1:6
%     pteo = polyfit(FF, resultados(k).SIRteo, 4);
%     figure, plot(FF, polyval(pteo, FF), 'k', FF, resultados(k).SIRteo, '*r')
% end

% L = 100.00km, P0 = 5.00mW, mIM = 2.00%, Nit = 1000, kappa = 15.00
% L = 100.00km, P0 = 4.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
% L = 100.00km, P0 = 1.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
             
maxkP.pteo = [-22.020513051286960 2.172128836517899e+02 -8.729590019838440e+02 1.828919780932934e+03 -2.096506512129543e+03 1.225469222213965e+03 -2.538811859715446e+02];
medkP.pteo = [-19.103000546953886 1.846553193972903e+02 -7.280508889832284e+02 1.497601086263255e+03 -1.683388033743068e+03 9.586965214510102e+02 -1.760723731827312e+02];
% minkP.pteo = polyfit(FF, resultados(3).SIRteo, 4);
             
maxkP.pap1 = [-22.381245698626273 2.203750362775873e+02 -8.844343065484532e+02 1.850977420606697e+03 -2.120114784706729e+03 1.238545278983891e+03 -2.570655061576484e+02];
medkP.pap1 = [-19.838372204479704 1.913624837407072e+02 -7.532235975384897e+02 1.547381647218844e+03 -1.738141341945479e+03 9.899357288232305e+02 -1.839009146472096e+02];
% minkP.pap1 = polyfit(FF, resultados(3).SIRap1, 4);
             
maxkP.pap2 = [-21.648895040708037 2.139588666302809e+02 -8.612154734313934e+02 1.806571714938027e+03 -2.072818139059255e+03 1.212078934029297e+03 -2.505992164976079e+02];
medkP.pap2 = [-18.429862897848814 1.788528515228033e+02 -7.074608420122178e+02 1.459155892504977e+03 -1.643620814584971e+03 9.368634630634564e+02 -1.704821100471320e+02];
% minkP.pap2 = polyfit(FF, resultados(3).SIRap2, 4);

maxkP.SIReva3 = resultados(1).SIReva;
% maxkP.SIReva4 = [25.6426190268395 25.4483679176673 25.2578579997669 25.0709023040971 24.8874172554610 24.7072349418763 24.5302870893974 24.3564218554355 24.1855837233616 24.0176330313964 23.8525264754957 23.6901361396527 23.5304262770291 23.3732806448687 23.2186712020147 23.0664890746338 22.9167143218706 22.7692458806835 22.6240679510497 22.4810879153501 22.3402948611252 22.2016008127359 22.0650006307757 21.9304118974004 21.7978315946571 21.6671838968982 21.5384689938063 21.4116140681107 21.2866236944177 21.1634292717507 21.0420362189529 20.9223814444368 20.8044725179461 20.6882483416152 20.5737200127645 20.4608264169796 20.3495837339707 20.2399357286292 20.1318984043194 20.0254168259217 19.9205100445545 19.8171260057430 19.7152831934164 19.6149340812162 19.5160982030864 19.4187289317311 19.3228485294247 19.2284130042579 19.1354436017243 19.0439007704035 18.9538064927470 18.8651218938683 18.7778695307740 18.6920110359834 18.6065342739978 18.5214057987637 18.4376826166937 18.3553319983193 18.2743805576376 18.1947962036862 18.1166038945525 18.0397784162263 17.9643408690663 17.8902687786007 17.8175878561089 17.7462741524766 17.6763536158264 17.6078097313958 17.5406642104698 17.4749035964769 17.4105544852165 17.3476020010384 17.2860729571706 17.2259607145575 17.1672875085984 17.1100502849670 17.0542765964953 16.9999621942353 16.9471349410821 16.8957999457790 16.8459802135926 16.7976852488017 16.7509440266828 16.7057653293904 16.6621787061557 16.6202038674551 16.5798653445644 16.5411884773146 16.5042047539371 16.4689396617673 16.4354258176778 16.4037018876662 16.3737955566069 16.3457530299622 16.3196104894120 16.2954158381479 16.2732074729936 16.2530498266988 16.2349769686446 16.2190639395043 16.2053558328839 16.1939321813604 16.1848424183501 16.1781878755128 16.1740153875703 16.1724376703381 16.1735212377196 16.1773836486276];
maxkP.SIReva5 = [25.6378046096214 25.4433535952850 25.2526400493766 25.0654770562671 24.8817808387668 24.7013835469103 24.5242167068416 24.3501285453194 24.1790633466672 24.0108815269103 23.8455395807018 23.6829096753179 23.5229558639884 23.3655619896293 23.2106998094872 23.0582605420859 22.9082240401191 22.7604893363634 22.6150404244956 22.4717847826953 22.3307112890042 22.1917320690977 22.0548417672541 21.9199580686533 21.7870777386094 21.6561250520369 21.5270999775474 21.3999298028156 21.2746188727570 21.1510986910809 21.0293744462640 20.9093831460320 20.7911321243831 20.6745603857089 20.5596787810424 20.4464263067769 20.3348188790765 20.2248003757278 20.1163865352353 20.0095225296203 19.9042271288529 19.8004483803989 19.6982044851404 19.5974480056689 19.4981981839426 19.4004084806508 19.3041008493855 19.2092313764538 19.1158209961433 19.0238302157517 18.9332806953287 18.8441336134921 18.7564111938358 18.6700751171652 18.5841186298664 18.4985086928335 18.4142964042532 18.3314490919721 18.2499930358389 18.1698961959530 18.0911831990242 18.0138288387519 17.9378538996375 17.8632358921608 17.7900001763904 17.7181227881988 17.6476293142348 17.5785031656402 17.5107657097423 17.4444033809261 17.3794423863799 17.3158677331678 17.2537058253372 17.1929498072507 17.1336215214247 17.0757176658652 17.0192653416669 16.9642600300357 16.9107291184978 16.8586773328124 16.8081272182187 16.7590878147818 16.7115875575518 16.6656347184174 16.6212582672454 16.5784772430309 16.5373156038753 16.4977978920279 16.4599549075065 16.4238112523679 16.3893987867830 16.3567550546425 16.3259069666473 16.2968994050267 16.2697676018403 16.2445579740215 16.2213078427532 16.2000797917281 16.1809067416001 16.1638615499574 16.1489878740538 16.1363627569939 16.1260339514535 16.1180997113346 16.1126049883087 16.1096588968372 16.1093254967835 16.1117182237115;];
maxkP.SIRevaCAD3 = [25.5372053490125 25.3398675212988 25.1463136315500 24.9564369357616 24.7700648955568 24.5871084222976 24.4074133322000 24.2309051966545 24.0574452972251 23.8869714892674 23.7193581980879 23.5545536593588 23.3924435581105 23.2329849714390 23.0760733013726 22.9216732123169 22.7696885496502 22.6200905356233 22.4727903995987 22.3277650711440 22.1849322764925 22.0442739458304 21.9057135548434 21.7692374442532 21.6347742060224 21.5023140966644 21.3717902854231 21.2431965284360 21.1164701114758 20.9916079394147 20.8685510192982 20.7472991085076 20.6277965953451 20.5100458396237 20.3939943178294 20.2796467814165 20.1669535421865 20.0559215661880 19.9465037823817 19.8387092236244 19.7324932481100 19.6278668333532 19.5247876054279 19.4232683870760 19.3232689344952 19.2248038366124 19.1278348631853 19.0323783088388 18.9383978595985 18.8459114724469 18.7548846701562 18.6653370448391 18.5772358931322 18.4906024304668 18.4043669758758 18.3185506292228 18.2341609998598 18.1512210442038 18.0697016820860 17.9896274978078 17.9109710820012 17.8337586806098 17.7579645544713 17.6836166604662 17.6106909446490 17.5392171404874 17.4691729106069 17.4005898482323 17.3334473813441 17.2677790651573 17.2035661607048 17.1408443084705 17.0795966910854 17.0198611811205 16.9616229946680 16.9049224098428 16.8497468144827 16.7961390961718 16.7440889830725 16.6936422113519 16.6447910531861 16.5975843734422 16.5520172330941 16.5081419540062 16.4659566792746 16.4255175731269 16.3868262119370 16.3499430557860 16.3148735349549 16.2816829408141 16.2503810623235 16.2210386569165 16.1936704797385 16.1683535104306 16.1451082043021 16.1240186688516 16.1051119505429 16.0884803761165 16.0741586708314 16.0622487048810 16.0527942185500 16.0459082443537 16.0416451911924 16.0401312495231 16.0414335599073 16.0456939534236 16.0529948996783 16.0634969903046];
maxkP.SIRevaCAD5 =[25.4688361156670 25.2732803696413 25.0814642678311 24.8932128614580 24.7084305943462 24.5269610772733 24.3487245647874 24.1735802801966 24.0014616968911 23.8322398129021 23.6658607197455 23.5022067727094 23.3412320193555 23.1828301137734 23.0269631615535 22.8735318669516 22.7225067452961 22.5737960009846 22.4273746052673 22.2831589029464 22.1411290304029 22.0012057193824 21.8633751214177 21.7275632723742 21.5937587012720 21.4618937820001 21.3319604749288 21.2038939548774 21.0776907596928 20.9532900692987 20.8306894784308 20.7098334599622 20.5907219428210 20.4733012223245 20.3575749094836 20.2434891362895 20.1310527274600 20.0202165168337 19.9109893209537 19.8033231231172 19.6972299086757 19.5926643870662 19.4896381297118 19.3881102069182 19.2880933658586 19.1895474541903 19.0924880454224 18.9968774859501 18.9027304644284 18.8100136148328 18.7187424666750 18.6288842245405 18.5404550906322 18.4534226767558 18.3667744050556 18.2804828477313 18.1955931358112 18.1120783140698 18.0299589172707 17.9492085436546 17.8698461825000 17.7918521396051 17.7152416900178 17.6399977625016 17.5661402597749 17.4936505907128 17.4225489602642 17.3528240402268 17.2844919315217 17.2175442490715 17.1520019736931 17.0878552602995 17.0251253512001 16.9638104387578 16.9039273076830 16.8454776362368 16.7884834968190 16.7329453298343 16.6788855486944 16.6263137498880 16.5752475979586 16.5257009483052 16.4776973742035 16.4312499530968 16.3863828383639 16.3431197975243 16.3014800555769 16.2614928402513 16.2231842275812 16.1865835069630 16.1517178509737 16.1186294259514 16.0873405284973 16.0579006337685 16.0303403591513 16.0047107293891 15.9810444786710 15.9594087476808 15.9398319335946 15.9223914376703 15.9071263834155 15.8941183886186 15.8834106913985 15.8751060877145 15.8692450682217 15.8659413260229 15.8652544131475 15.8673024278029;];

medkP.SIReva3 = [33.3447380972556 33.1481647777781 32.9557143202223 32.7673042974395 32.5827205775349 32.4018981500797 32.2246421516806 32.0509020696700 31.8804993177926 31.7133955731307 31.5494261141199 31.3885629648055 31.2306533025549 31.0756780141659 30.9234945588941 30.7740914815762 30.6273351815008 30.4832208769803 30.3416227848303 30.2025419873999 30.0658595730067 29.9315818192144 29.7995958830546 29.6699126824116 29.5424247574621 29.4171472046310 29.2939773583490 29.1729341085628 29.0539190754027 28.9369546211428 28.8219462102990 28.7089194098147 28.5977831439551 28.4885659619887 28.3811799114016 28.2756563401645 28.1719101235792 28.0699752581199 27.9697691869055 27.8713284338860 27.7745727807121 27.6795411835472 27.5861555601464 27.4944572266796 27.4043700582701 27.3159376798161 27.2290857661733 27.1438602189837 27.0601883741945 26.9781183962951 26.8975791609916 26.8186210989817 26.7411745203862 26.6652921422429 26.5898628664900 26.5149385464025 26.4414925272531 26.3695805914659 26.2991353681096 26.2302149928327 26.1627532735439 26.0968107700558 26.0323224205946 25.9693512978296 25.9078334355216 25.8478345267426 25.7892916801999 25.7322733372372 25.6767176758959 25.6226960358678 25.5701476750329 25.5191470060784 25.4696343949040 25.4216875293297 25.3752479311806 25.3303967966188 25.2870768736589 25.2453731354640 25.2052296522030 25.1667354834951 25.1298361475437 25.0946251472123 25.0610496098352 25.0292078936530 24.9990489381077 24.9706764341557 24.9440413865969 24.9192533738413 24.8962657801793 24.8751947187763 24.8559963418965 24.8387940563101 24.8235472622897 24.8103875545447 24.7992781750469 24.7903599666919 24.7836007491278 24.7791518786074 24.7769866681042 24.7772685078262 24.7799773486694 24.7852904568716 24.7931958604066 24.8038869524597 24.8173616601335 24.8338322803067 24.8533089645600 24.8760263747920];
% medkP.SIReva4 = [33.3228835029798 33.1269654133771 32.9351580154238 32.7473550316492 32.5633691036060 32.3831116549012 32.2064137640692 32.0332016528220 31.8633219451991 31.6967128550024 31.5332347232677 31.3728364186073 31.2153890858102 31.0608512697112 30.9091038612412 30.7601128544107 30.6137680990806 30.4700425610083 30.3288329327421 30.1901188553182 30.0538034641455 29.9198713604574 29.7882318681353 29.6588745140116 29.5317130869873 29.4067421072523 29.2838797881358 29.1631241802541 29.0443979677540 28.9277029507038 28.8129647568698 28.7001892202167 28.5893050874955 28.4803208857462 28.3731687141780 28.2678589409588 28.1643274138831 28.0625879983627 27.9625781972420 27.8643140652891 27.7677357292400 27.6728619319083 27.5796340195685 27.4880739616171 27.3981247502212 27.3098103000349 27.2230757123281 27.1379474439255 27.0543712919884 26.9723768900336 26.8919112454665 26.8130058706225 26.7356088133190 26.6597534023024 26.5843472337361 26.5094244477985 26.4359740791124 26.3640338174376 26.2935543304589 26.2245752846575 26.1570474003736 26.0910145466975 26.0264266976083 25.9633305430004 25.9016782071686 25.8415178448205 25.7828021543910 25.7255839574049 25.6698149630076 25.6155512301731 25.5627466458005 25.5114590961035 25.4616429890825 25.4133615689993 25.3665681111471 25.3213297424368 25.2776020956103 25.2354547193314 25.1948438599787 25.1558454256517 25.1184145266934 25.0826319237200 25.0484554812915 25.0159693198904 24.9851322321499 24.9560361587307 24.9286389834620 24.9030389681189 24.8791974954475 24.8572176735879 24.8370625056188 24.8188451102543 24.8025282275305 24.7882335865806 24.7759287810523 24.7657428090994 24.7576462749595 24.7517816194513 24.7481206446453 24.7468181387861 24.7478532689116 24.7513922288140 24.7574199736334 24.7661218513000 24.7774871730316 24.7917184954570 24.8088189391748 24.8290081917486];
medkP.SIReva5 = [33.3223624513135 33.1264217162377 32.9345911843691 32.7467645694984 32.5627545025372 32.3824723985854 32.2057493263960 32.0325114992777 31.8626055322744 31.6959696307955 31.5324641275431 31.3720378825791 31.2145620330868 31.0599951150273 30.9082180123536 30.7591967099163 30.6128210511293 30.4690639921339 30.3278222196994 30.1890753646123 30.0527265570750 29.9187603875139 29.7870861750770 29.6576934350331 29.5304959522189 29.4054882342891 29.2825884910682 29.1617947597727 29.0430297214856 28.9262951617623 28.8115167059997 28.6987001722649 28.5877743054966 28.4787476155876 28.3715522003399 28.2661984096774 28.1626220900289 28.0608370879060 27.9607809056002 27.8624695764254 27.7658432265668 27.6709205752795 27.5776429689733 27.4860323509324 27.3960317139038 27.3076649440639 27.2208771434367 27.1356947374704 27.0520635247157 26.9700131038243 26.8894904839017 26.8105271391315 26.7330711193954 26.6571557117764 26.5816891992980 26.5067057267143 26.4331936691645 26.3611906724896 26.2906474136063 26.2216035112274 26.1540096962201 26.0879097842432 26.0232537616788 25.9600882596551 25.8983654146876 25.8381333179541 25.7793446807941 25.7220522535555 25.6662077601440 25.6118671810132 25.5589844170658 25.5076172692205 25.4577201589817 25.4093562325551 25.3624787800118 25.3171548226661 25.2733400061427 25.2311037636954 25.1904023537265 25.1513115542439 25.1137864881688 25.0779077712548 25.0436332767380 25.0110469656356 24.9801076363188 24.9509070488070 24.9234030910699 24.8976938223333 24.8737406217831 24.8516463725226 24.8313740669204 24.8130365669147 24.7965965955119 24.7821755911699 24.7697411153657 24.7594218393548 24.7511883193453 24.7451826192140 24.7413764763325 24.7399242465673 24.7408050017959 24.7441844415515 24.7500473911523 24.7585786199149 24.7697672690931 24.7838152222069 24.8007253629613 24.8207165952422;];
medkP.SIRevaCAD3 = [32.9734209475161 32.7746451107884 32.5799644904461 32.3893534079642 32.2025415831546 32.0195188365720 31.8400361202226 31.6640960095250 31.4914675039257 31.3221637801778 31.1559693049385 30.9929061506941 30.8327721388313 30.6755968757358 30.5211897912461 30.3695869305886 30.2206078756086 30.0742942244998 29.9304744863764 29.7891950921680 29.6502924404959 29.5138172071862 29.3796127948110 29.2477336430264 29.1180293977189 28.9905578681813 28.8651742863005 28.7419395081182 28.6207137802974 28.5015607417887 28.3843451550441 28.2691332274306 28.1557937992321 28.0443954733767 27.9348107819266 27.8271105860114 27.7211707678557 27.6170643400253 27.5146702315907 27.4140635264830 27.3151259305396 27.2179345425883 27.1223736042076 27.0285221938298 26.9362668733436 26.8456886847995 26.7566763177046 26.6693127796482 26.5834887154589 26.4992891171024 26.4166064309202 26.3355276683812 26.2559469404957 26.1779533293574 26.1004006913605 26.0233757945909 25.9478148025805 25.8738094890674 25.8012568439931 25.7302508303836 25.6606897582448 25.5926698801500 25.5260907485797 25.4610510235189 25.3974514361315 25.3353931905519 25.2747781469209 25.2157102107751 25.1580923362182 25.1020313100170 25.0474311608818 24.9944017617591 24.9428482136371 24.8928837088276 24.8444144371445 24.7975571754778 24.7522192403066 24.7085212949438 24.6663718447721 24.6258957835993 24.5870028963012 24.5498227002945 24.5142663838972 24.4804685386134 24.4483419198458 24.4180267112434 24.3894374466475 24.3627205000842 24.3377924530762 24.3148065640640 24.2936818023532 24.2745791201656 24.2574203021668 24.2423749436273 24.2293681810470 24.2185793730889 24.2099376812744 24.2036335589853 24.1996010390796 24.1980432635383 24.1989002041048 24.2023896151441 24.2084587602527 24.2173423488224 24.2289966612811 24.2436762424906 24.2613486049389 24.2822917083953];
medkP.SIRevaCAD5 =[32.9513397594555 32.7531938156677 32.5591303843028 32.3690999902263 32.1828590408066 32.0003738738124 31.8214212703603 31.6459806498792 31.4738460851243 31.3050074337039 31.1392740555942 30.9766450336386 30.8169419782860 30.6601723288565 30.5061687504472 30.3549449412067 30.2063437098993 30.0603846223048 29.9169184355955 29.7759703635874 29.6373986104857 29.5012324249445 29.3673371110853 29.2357459791365 29.1063296583247 28.9791256433147 28.8540097689215 28.7310223354716 28.6100443564506 28.4911192014245 28.3741315022179 28.2591280223736 28.1459971229485 28.0347876933252 27.9253919964488 27.8178602436896 27.7120889521869 27.6081313272588 27.5058860235632 27.4054079953345 27.3065989425560 27.2095160926743 27.1140627753304 27.0202990524251 26.9281302604419 26.8376180754864 26.7486702563906 26.6613507094199 26.5755681974538 26.4913895090520 26.4087248798062 26.3276427417202 26.2480546009807 26.1700304988348 26.0924432787257 26.0153623609618 25.9397386581835 25.8656461801962 25.7929995942142 25.7218747399053 25.6521865015271 25.5840147356180 25.5172737522208 25.4520461026813 25.3882482983007 25.3259643178429 25.2651113033605 25.2057777952767 25.1478800368455 25.0915097629558 25.0365853599323 24.9832004372321 24.9312738739208 24.8809046123774 24.8320104043963 24.7846941212078 24.7388757465282 24.6946607104698 24.6519694919011 24.6109139459921 24.5714133281040 24.5335844844027 24.4973491973348 24.4628279102254 24.4299431117554 24.3988232314925 24.3693896536469 24.3417773770943 24.3159109377000 24.2919305355091 24.2697619803560 24.2495557689380 24.2312371192614 24.2149655199017 24.2006705450076 24.1885194517923 24.1784443196714 24.1706262853287 24.1649981235367 24.1617538697485 24.1608329670501 24.1624415432513 24.1665241084490 24.1733065799896 24.1827370801172 24.1950595642051 24.2102349370795 24.2285252825386;];

% minkP.SIReva3 = resultados(3).SIReva;

fig = figure;
fig1 = plot(FF, polyval(maxkP.pteo, FF), '-k', FF, maxkP.SIReva3, '*b', FF, maxkP.SIReva5, 'hc', FF, maxkP.SIRevaCAD3, '.g');
hold on
fig2 = plot(FF, polyval(medkP.pteo, FF), '-k', FF, medkP.SIReva3, '*b', FF, medkP.SIReva5, 'hc', FF, medkP.SIRevaCAD3, '.g');
% fig3 = plot(FF, polyval(minkP.pteo, FF), '-k', FF, polyval(minkP.pap1, FF), '-r', FF, polyval(minkP.pap2,FF), '-m', FF, minkP.SIReva3, '*b');
leg = legend('Simulação Sem Aproximações', 'Modelo Analítico (3ª ordem)', 'Modelo Analítico (5ª ordem)', 'Modelo Analítico CAD (3ª Ordem)');
set(gca, 'FontSize', 12)
set(fig, 'Position', [100 100 640 500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
axis([1 2 15 35])
set(fig1(1), 'LineWidth', 2)
set(fig2(1), 'LineWidth', 2)
set(fig1(end), 'MarkerSize', 12);
set(fig2(end), 'MarkerSize', 12);
grid on
set(leg,'Position',[0.429513888888889 0.693666666666667 0.462326388888889 0.216]);
% Create textbox
annotation(fig,'textbox', [0.676401645768027 0.2005490250826 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 75 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
annotation(fig,'textbox',[0.668560736677121 0.402071292289081 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 40 GHz'},'FontSize',14,'FitBoxToText','off','LineStyle','none');
annotation(fig,'ellipse',[0.6588125 0.486 0.0365 0.112]);
% 
cd('../../DissertacaoPG/figuras/matlab')
saveas(fig, 'OFDM_GbE_100km.fig')
cd ..
saveas(fig, 'OFDM_GbE_100km', 'epsc');
cd('../../codigos/Graficos')
% 
%%
% L = 20.00km, P0 = 5.00mW, mIM = 2.00%, Nit = 1000, kappa = 15.00
% L = 20.00km, P0 = 4.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00
% L = 20.00km, P0 = 1.00mW, mIM = 2.00%, Nit = 1000, kappa = 10.00

maxkP.pteo = polyfit(FF, resultados(4).SIRteo, 4);
medkP.pteo = [83.077891784441960 -7.793619584521703e+02 3.024267269486824e+03 -6.210870780084659e+03 7.127536554341729e+03 -4.356352906793040e+03 1.170985767370937e+03];
% minkP.pteo = polyfit(FF, resultados(6).SIRteo, 4);

maxkP.pap1 = [-17.511342520464847 1.457592671157565e+02 -4.884682412819632e+02 8.348110423357023e+02 -7.425868214122299e+02 2.850531193718631e+02 31.245587719441463]; %polyfit(FF, resultados(4).SIRap1, 4);
medkP.pap1 = [-1.038005226182108e+02 9.459035560646478e+02 -3.553126139456570e+03 7.037734498807211e+03 -7.736883932247023e+03 4.447857552426609e+03 -9.795473611327394e+02]; %[82.528659074489040 -7.743389326434833e+02 3.004802285110274e+03 -6.169016684648910e+03 7.071882765704221e+03 -4.307139119474965e+03 1.144356479679341e+03];
% minkP.pap1 = polyfit(FF, resultados(6).SIRap1, 4);

maxkP.pap2 = [-17.566526224752824 1.461609808574889e+02 -4.896256959237618e+02 8.364794479139097e+02 -7.437872010011654e+02 2.855195483064640e+02 32.310642089136046]; %polyfit(FF, resultados(4).SIRap2, 4);
medkP.pap2 = [-1.037209260341250e+02 9.446500230183084e+02 -3.546458747046568e+03 7.020740433073005e+03 -7.714083844658817e+03 4.432458851245462e+03 -9.706063981500176e+02]; %[82.611887634387240 -7.748808909815007e+02 3.006029995590004e+03 -6.169941562736692e+03 7.071658391627291e+03 -4.305697421726653e+03 1.143768024833290e+03];
% minkP.pap2 = polyfit(FF, resultados(6).SIRap2, 4);
medkP.pap3 = [-63.815004023175810 5.720236211719188e+02 -2.107869609252707e+03 4.083556754685788e+03 -4.371151158914831e+03 2.422310272863263e+03 -4.762538047497896e+02];

maxkP.SIReva3 = resultados(4).SIReva;
maxkP.SIRevaCAD3 = [47.7889849888088 47.5655284579712 47.3463774191582 47.1314174461996 46.9204699236878 46.7134382716070 46.5101622663655 46.3105601849351 46.1144873142462 45.9218744173713 45.7325899762616 45.5465753407542 45.3637103083017 45.1839452801780 45.0071698297108 44.8333421584234 44.6623603437443 44.4941893603661 44.3287347312496 44.1659673556589 44.0057993148231 43.8482067274354 43.6931074845862 43.5404823355690 43.3902543464274 43.2424084033309 43.0968722058843 42.9536343618109 42.8126267405336 42.6738413211661 42.5372137441675 42.4027390644747 42.2703563495556 42.1400634807300 42.0118026549462 41.8855743697782 41.7613236939199 41.6390535648794 41.5187116996923 41.4003033288450 41.2837786241801 41.1691449879862 41.0563548796055 40.9454177748505 40.8362882765199 40.7289778562754 40.6234431371936 40.5196975279156 40.4176995675635 40.3174645603222 40.2189528745676 40.1221816850291 40.0271131188478 39.9337662120756 39.8410659858784 39.7490315237421 39.6586652814141 39.5699885070375 39.4829668458722 39.3976234189560 39.3139254938584 39.2318981022484 39.1515101239975 39.0727885552177 38.9957038932076 38.9202851692807 38.8465045191162 38.7743930981531 38.7039247182711 38.6351327677335 38.5679927907318 38.5025405388799 38.4387533649554 38.3766695388510 38.3162683207607 38.2575906813768 38.2006179127146 38.1453939003128 38.0919021217621 38.0401896278607 37.9902422695798 37.9421105557077 37.8957829383072 37.8513137265430 37.8086942484798 37.7679830147749 37.7291745607221 37.6923320695906 37.6574536828860 37.6246078116924 37.5937966848985 37.5650945983857 37.5385084501024 37.5141192018880 37.4919391263448 37.4720567851831 37.4544906853279 37.4393381117877 37.4266248587411 37.4164582951781 37.4088728001242 37.4039874871292 37.4018469304492 37.4025840317599 37.4062555750510 37.4130107882550 37.4229212076750 37.4361555720058];

medkP.SIReva3 = [57.9793216594455 57.7453880072179 57.5156882033446 57.2901337267552 57.0685213107223 56.8507795301176 56.6367243117884 56.4262984106324 56.2193339790020 56.0157856462644 55.8154993994410 55.6184399015318 55.4244650287218 55.2335479949215 55.0455569675817 54.8604725078520 54.6781717508250 54.4986416209255 54.3217671158545 54.1475407140214 53.9758543465514 53.8067053767017 53.6399918825507 53.4757155565145 53.3137799539410 53.1541906333320 52.9968560539498 52.8417852535504 52.6888911020156 52.5381857928089 52.3895861801695 52.2431073426935 52.0986697492495 51.9562911377165 51.8158952698914 51.6775023551917 51.5410391677425 51.4065282335362 51.2738990938696 51.1431764648415 51.0142924405747 50.8872738258608 50.7620550803172 50.6386650183235 50.5170403015697 50.3972116950565 50.2791179205074 50.1627916530345 50.0481735516996 49.9352981784143 49.8241080246101 49.7146395319963 49.6068369358863 49.5007385665414 49.3952498776626 49.2904085525161 49.1872004665327 49.0856662366523 48.9857534732227 48.8875047267349 48.7908691578445 48.6958913066992 48.6025218557842 48.5108074074513 48.4207001522941 48.3322488448447 48.2454071854237 48.1602261894885 48.0766610849664 47.9947652774926 47.9144955580411 47.8359078743792 47.7589606352636 47.6837125079781 47.6101235953386 47.5382554903231 47.4680700904784 47.3996321535722 47.3329055005445 47.2679583310200 47.2047565504842 47.1433721216570 47.0837732338371 47.0260359858677 46.9701310952810 46.9161392312599 46.8640339379656 46.8139009619770 46.7657170375585 46.7195735831048 46.6754509655799 46.6334469751980 46.5935461512090 46.5558534842593 46.5203583453485 46.4871739120998 46.4562951961514 46.4278447442537 46.4018242054644 46.3783669222729 46.3574824163860 46.3393165611210 46.3238882916377 46.3113581404658 46.3017563927398 46.2952608756392 46.2919156790661 46.2919192219500];
medkP.SIRevaCAD3 = [57.7215808743172 57.4868182250174 57.2562592594473 57.0298773647376 56.8074073297851 56.5888378845032 56.3739248408040 56.1626695330956 55.9548456266075 55.7504649127848 55.5493163439196 55.3514204690332 55.1565794280136 54.9648211717728 54.7759592936678 54.5900280575488 54.4068510651642 54.2264680134525 54.0487112984647 53.8736253359063 53.7010502883558 53.5310347082182 53.3634256484163 53.1982753226021 53.0354369222076 52.8749659333825 52.7167210370201 52.5607606741442 52.4069484516488 52.2553455066698 52.1058198804078 51.9584351965069 51.8130634993647 51.6697707309768 51.5284325593134 51.3891171118706 51.2517033446077 51.1162614680787 50.9826734285739 50.8510114437727 50.7211601855209 50.5931938261157 50.4669995269006 50.3426533832858 50.2200448353310 50.0992518891949 49.9801660753083 49.8628673159614 49.7472490637192 49.6333931791508 49.5211948869343 49.4107380242103 49.3019194544533 49.1948250455270 49.0883114067893 48.9824621607452 48.8782161924319 48.7756619940189 48.6746992456422 48.5754186000462 48.4777210402368 48.3816994823913 48.2872561371050 48.1944863043660 48.1032933606664 48.0137751289800 47.9258361038855 47.8395767909650 47.7549027695692 47.6719174100306 47.5905273586220 47.5108390576440 47.4327602192815 47.3564005932230 47.2816689752467 47.2086786898537 47.1373396552053 47.0677690746623 46.9998780517767 46.9337880150484 46.8694113445961 46.8068740894019 46.7460900305028 46.6871902901098 46.6300902140372 46.5749265181089 46.5216163242971 46.4703025426788 46.4209043404576 46.3735715185182 46.3282256290244 46.2850241756916 46.2438915226373 46.2049938285083 46.1682588050433 46.1338623892201 46.1017363125443 46.0720676249826 46.0447929228337 46.0201119666107 45.9979672834012 45.9785732721572 45.9618797418927 45.9481180772893 45.9372470921437 45.9295180426418 45.9249009601704 45.9236705580597];

% minkP.SIReva3 = resultados(6).SIReva;

fig = figure;
fig1 = plot(FF, polyval(maxkP.pteo, FF), '-k', FF, maxkP.SIReva3, '*b', FF, maxkP.SIRevaCAD3, '.g');
hold on
fig2 = plot(FF, polyval(medkP.pteo, FF), '-k', FF, medkP.SIReva3, '*b', FF, medkP.SIRevaCAD3, '.g');
leg = legend('Simulação Sem Aproximações','Modelo Analítico (3ª ordem)', 'Modelo Analítico CAD (3ª Ordem)');
set(gca, 'FontSize', 12)
set(fig, 'Position', [100 100 640 500])
xlabel('Frequência (GHz)', 'FontSize', 14)
ylabel('SIR (dB)', 'FontSize', 14)
set(fig1(1), 'LineWidth', 2)
set(fig2(1), 'LineWidth', 2)
set(fig1(end), 'MarkerSize', 12);
set(fig2(end), 'MarkerSize', 12);
grid on
set(leg, 'Position',[0.428789239376524 0.692354925775979 0.463775687913619 0.218623481781377]);
% Create textbox
annotation(fig,'textbox', [0.607623236677122 0.526071292289081 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 40 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
% Create textbox
annotation(fig,'textbox', [0.654526645768028 0.2045490250826 0.236677115987461 0.0850202429149798],...
    'String',{'\kappa P_0 = 75 GHz'}, 'FontSize',14, 'FitBoxToText','off', 'LineStyle','none');
% 
cd('../../DissertacaoPG/figuras/matlab')
saveas(fig, 'OFDM_GbE_20km.fig')
cd ..
saveas(fig, 'OFDM_GbE_20km', 'epsc');
cd('../../codigos/Graficos')
